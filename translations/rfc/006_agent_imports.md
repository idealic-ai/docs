# 006: Агент/Импорты

> **Import:** Ключ, который идентифицирует часть контекста из родительской среды для предоставления (`imported`) в распоряжение исполнению. Он может использоваться для фокусировки внимания LLM при **Скрытом Встроенном** исполнении или для создания всего контекста при исполнении в **Области Видимости Модуля**. Контролируется свойством `_imports`.
>
> — [Глоссарий](./000_glossary.md)

[Протокол Вызова](./003_agent_call.md) определяет высокоуровневые элементы управления для исполнения `Call`: **Область видимости** (встроенная или модульная) и **Метод** (явный или скрытый). **Протокол Импортов** объясняет, как комбинировать эти элементы управления и управлять контекстом для каждого результирующего шаблона исполнения.

## Сочетание Области Видимости и Метода

1.  **Встроенный Явный (`_activity`)**: Это классический шаблон использования инструмента. LLM генерирует `params`, и хост немедленно выполняет локальную функцию. `_imports` здесь обычно не используется, так как Метод не является Скрытым.

2.  **Встроенный Скрытый (без `_activity`)**: LLM генерирует `params` и `_output` за один проход. Свойство `_imports` может использоваться здесь для фокусировки внимания LLM на конкретных частях контекста, предотвращая влияние нерелевантной информации.

3.  **Модульный Явный (`_module` + `_activity`)**: LLM генерирует `params`. Затем система вызывает указанную Активность (`_activity`) из разрешенного `_module` в новом, изолированном контексте. Если указаны `_imports`, этот отфильтрованный контекст передается в качестве дополнительного аргумента коду Активности.

4.  **Модульный Скрытый (`_module`, без `_activity`)**: LLM генерирует `params`. Затем система инициирует новый, изолированный вызов LLM, используя `Idea`, указанную в `_module`, в качестве руководства. Контекст для этого нового вызова создается путем объединения собственного контекста модуля с данными, указанными в `_imports`.

## Фокусировка Поля Зрения

Свойство `_imports` — это основной механизм для контроля контекста, доступного для `Call`. Оно действует как разрешающий список, фильтруя родительскую среду для предоставления сфокусированного, ограниченного поля зрения для исполнения.

- **Во Встроенной Области Видимости**: `_imports` фокусируют внимание LLM.
- **В Модульной Области Видимости**: `_imports` определяют _весь контекст_ для изолированного исполнения.

## Предоставление и Запрос Контекста: Статические и Динамические Импорты

Свойство `_imports` в схеме `Tool` определяет, является ли контекст предварительно одобренным и **предоставленным** инструменту, или же он динамически **запрашивается** LLM во время выполнения.

- **Статические Импорты (Предоставление Контекста)**: Если свойство `_imports` является значением `const` (например, `_imports: { "const": ["user_request"] }`), контекст **предоставляется**. Разработчик `Tool` жестко закодировал точный контекст, который разрешено видеть инструменту.

- **Динамические Импорты (Запрос Контекста)**: Если свойство `_imports` является гибкой схемой (например, массив перечислений `_imports: { "type": "array", "items": { "enum": ["session_memory"] } }`), контекст **запрашивается**. LLM решает, какие из доступных импортов ей необходимы для генерации `Call`.

Этот динамический шаблон особенно эффективен в сочетании с системой подтверждения человеком (human-in-the-loop), что обеспечивает критически важный уровень прозрачности и контроля.

## Сила Ограниченного Контекста

- **Улучшенная Безопасность и Фокусировка**: Ограничивая поле зрения, Импорты предотвращают случайную утечку данных и фокусируют LLM, что приводит к более предсказуемым, точным и экономически эффективным исполнениям.
- **Улучшенная Модульность**: Импорты позволяют модулям (`Ideas` и `Activities`) быть по-настоящему самодостаточными и повторно используемыми.