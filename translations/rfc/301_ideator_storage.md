# 301: Ideator/Хранилище

## 1. Введение

Этот документ описывает **System: Storage**, основной служебный сервис в экосистеме Idea. Сервис Хранилище работает как специализированный **Idea Transformer**, основная задача которого — предоставлять постоянное, контентно-адресуемое хранилище для `Ideas`. Это фундаментальный уровень для памяти и воспроизведения, позволяющий сохранять `Ideas` и управлять их версиями для последующего использования другими сервисами, такими как [System: Resolver](./202_ideator_resolver.md).

## 2. Основная концепция: Хранилище как Idea Transformer

Сервис Хранилище следует шаблону `Idea Transformer`, принимая `Idea` на вход и возвращая `Idea` на выход.

- **Входные данные**: Валидный триплет `Idea` (`schema`, `solution`, `context`).
- **Процесс**: Сервис получает `Idea`, присваивает ему уникальный адресуемый идентификатор (который включает версионирование) и сохраняет его в надёжном бэкенде (например, в базе данных PostgreSQL).
- **Выходные данные**: Сервис возвращает исходный `Idea` в качестве подтверждения успешного сохранения. Эти данные могут быть дополнены метаданными, такими как присвоенный идентификатор и версия, подтверждая его сохранность.

## 3. Ключевые характеристики

### 3.1. Постоянство «чёрного ящика»

Сервис Хранилище спроектирован как управляемый «чёрный ящик». Пользователи отправляют `Ideas` для сохранения, не имея контроля над базовым механизмом хранения (например, типом базы данных, шардированием) или политиками хранения данных. Сервис гарантирует, что `Idea`, однажды принятый, будет сохранён и доступен для разрешения. Конкретные детали реализации остаются на усмотрение поставщика сервиса.

### 3.2. Версионирование и неизменность

Система построена на принципе неизменяемости (иммутабельности). Когда существующий `Idea` «обновляется», сервис Хранилище не изменяет исходную запись. Вместо этого он создаёт и сохраняет новую версию `Idea`, поддерживая полную и непрерывную цепочку её истории. Это гарантирует, что любая ссылка на конкретную версию `Idea` всегда будет вести к абсолютно тому же содержимому. Ссылки могут указывать на конкретную версию или на динамическую ветку (например, `latest`).

### 3.3. Контентная адресация

Хотя точная схема адресации является деталью реализации, основной принцип заключается в том, что каждый сохранённый `Idea` однозначно идентифицируется и может быть извлечён по своему идентификатору и версии. Это позволяет создать надёжную и децентрализованную систему, в которой на `Ideas` можно ссылаться с высокой точностью.

## 4. Публичный интерфейс

Публичный интерфейс системы Хранилище прост и ориентирован на запись, что соответствует его основной задаче.

- **Основное взаимодействие**: Единственное публичное взаимодействие — это отправка `Idea`.

- **Отделение от извлечения данных**: Для чёткого разделения ответственности сервис Хранилище не предоставляет публичного API для общего извлечения или запроса данных. Обязанность по получению и разрешению `Ideas` явно передана сервису **Resolver**. Это позволяет каждому сервису сосредоточиться на одной задаче: Хранилище отвечает за сохранение, а Resolver — за извлечение и компоновку.