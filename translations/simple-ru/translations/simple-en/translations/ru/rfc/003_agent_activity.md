# Акт 003: Агент/Действие

> **Действие:** Представь, что Действие (Activity) — это настоящий кусочек кода, который выполняет определённую работу. Это как мотор, который заставляет «Инструмент» (`Tool`) работать. Ты используешь Действие для задач, которые ИИ не может просто «придумать», например, поговорить с другим сайтом, найти что-то в базе данных или сделать что-то ещё в реальном мире. — [Глоссарий](./000_glossary.md)

> Sidenote: Для начала прочтите: [Акт 002: Агент/Инструмент](./002_agent_tool.md)
>

Этот документ объясняет **Протокол Действий**. Это набор правил, по которым «Инструменты» (`Tools`) соединяются с настоящим, работающим кодом. Если Инструмент — это *идея* того, что можно сделать (например, кнопка с надписью «Проверить погоду»), то Действие — это *настоящий код*, который идёт и получает прогноз погоды.

## Система двух книжных шкафов

Система агентов использует два разных «книжных шкафа», чтобы хранить *идею* о задаче отдельно от *инструкций* по её выполнению.

- **Шкаф с Инструментами**: Здесь хранятся чертежи всех «Инструментов». Он описывает, *что* каждый инструмент может делать.
- **Шкаф с Действиями**: Здесь хранится настоящий код («Действия»), который выполняет инструкции. Он знает, *как* делать работу.

Это разделение очень важно. Оно позволяет ИИ иногда просто *притворяться*, что он использует инструмент, придумывая реалистичный ответ. Это также значит, что ты можешь поменять *«как»* (инструкцию), не меняя *«что»* (идею). Например, можно переключиться с одного погодного сервиса на другой, не меняя сам Инструмент «Проверить погоду».

## Как добавить Действие в шкаф

Чтобы сделать «Действие» доступным, ты даёшь ему уникальное имя и добавляешь в систему. По этому имени Инструмент находит подходящий ему код.

```typescript
// Добавляем новое Действие в наш «шкаф».
// Имя 'weatherCheck' должно совпадать с Инструментом, для которого оно создано.
Activity.register('weatherCheck', async call => {
  const data = await weatherAPI.get(call.location);
  return { temperature: data.temp, conditions: data.desc };
});
```

## Как выполняются задачи: «Думать» или «Делать»

Когда используется Инструмент, система может выполнить задачу двумя очень разными способами:

- **Думать (Скрытое исполнение)**: ИИ использует свой гигантский мозг, чтобы «подумать» над задачей и тут же придумать ответ. Это происходит по умолчанию, если к Инструменту не привязан реальный код (Действие).
  > Sidenote: [104: Концепция / Скрытое](./104_concept_latent.md)
- **Делать (Явное исполнение)**: Система находит соответствующее «Действие» (реальный код) и запускает его. Это всё равно что сказать компьютеру по-настоящему *сделать* что-то — например, зайти на сайт или посчитать число. Это необходимо для задач, которые требуют точной информации из реального мира.

## Как система связывает Инструмент с его кодом

Система сама решает, «думать» или «делать» для каждого Инструмента. Она следует простым правилам, чтобы найти нужный код (Действие):

1.  **Искать прямую записку**: Сначала она проверяет чертёж Инструмента. Если там есть специальная пометка (называется `_activity`), которая говорит: «Используй этот код», — она так и делает. Всё просто.
2.  **Сравнить имена (простой способ)**: Если записки нет, система ищет «Действие» с **точно таким же именем**, как у Инструмента. Если находит — соединяет их автоматически.
3.  **По умолчанию — «думать»**: Если не удаётся найти совпадение по первым двум правилам, она прекращает поиски кода. Вместо этого она говорит ИИ просто «придумать» ответ.

Это упрощает жизнь разработчикам:

- **Просто назови свой `Tool` и `Activity` одинаково**, и они подключатся автоматически. Никакой дополнительной настройки.
- `Инструменты`, у которых нет подходящего кода, будут безопасно использовать мозг ИИ.
- Ты всегда можешь указать в `Инструменте` специальную пометку, чтобы он ссылался на другое `Действие`, что даёт больше контроля.

## Почему это разделение так важно

Представь, что кнопки на пульте от телевизора навсегда привязаны только к твоему текущему телевизору. Если ты купишь новый телевизор, тебе придётся покупать и новый пульт и заново учиться им пользоваться. Вот что было бы, если бы `Инструменты` и `Действия` были склеены вместе.

Разделяя их (в наших двух книжных шкафах), мы получаем огромные преимущества. Агенту нужно знать только о кнопке (`Инструмент`), а не об электронике внутри. Это значит:

- **Обновления — это просто**: Ты можешь переключиться с «придумывания» ответа ИИ на использование реального кода (`Действие`), вообще не меняя агента. Это как поменять батарейки в пульте — все кнопки делают то же самое.
- **Можно пробовать разные подходы**: У тебя могут быть два разных `Действия` для одного и того же `Инструмента`, и ты можешь посмотреть, какое работает лучше. Догадка ИИ лучше, чем реальные данные с сайта? Теперь это можно проверить.
- **Безопасно внедрять изменения**: Ты можешь дать новое, экспериментальное `Действие` всего нескольким агентам для проверки, пока все остальные продолжают использовать старое, надёжное.

## От чертежа к действию

Разделив *«что»* (`Инструмент`) и *«как»* (`Действие`), мы сделали систему невероятно гибкой. Но это лишь первый шаг. Теперь, когда у нас есть чертежи и инструкции, нам нужен менеджер, который будет всем этим управлять. Нужно что-то, что будет решать, какие инструменты использовать, когда и в каком порядке.

Следующий документ, [Акт 004: Агент/Вызов](./004_agent_call.md), рассказывает о том, как система с этим справляется, превращая наши простые идеи в цепочку настоящих действий, которые могут строиться друг на друге.