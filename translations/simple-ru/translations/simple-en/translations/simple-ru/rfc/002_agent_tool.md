# 002: Агент/Инструмент

> **Инструмент**: Представь, что инструмент — это рецепт особой суперсилы, которую может использовать ИИ-агент. Этот рецепт показывают умному ИИ как часть инструкций, объясняя, что он может сделать. ИИ «активирует» инструмент, создавая `Вызов` (Call) с нужными деталями. Этот вызов затем выполняется либо в «уме» самого ИИ, либо специальной компьютерной программой (`Действием`). — [Глоссарий](./000_glossary.md)

> Sidenote: - Обязательно к прочтению: [001: Агент/Запрос](./001_agent_request.md)
> - Дополняется документом: [003: Агент/Действие](./003_agent_activity.md)

Этот документ объясняет, что такое Инструмент. Считай, что это базовый «кирпичик», который позволяет ИИ-агентам понимать и использовать различные способности.

## Что такое Инструменты?

**Инструменты — это как набор суперсил у героя**. Они дают агенту новую крутую способность: **выбирать, что делать, в зависимости от ситуации**. Это позволяет агентам подбирать правильный ход для любой задачи.

Представь, что агент — это повар на кухне. Инструменты — это его книга рецептов.

Каждый рецепт (Инструмент) даёт:

- **Чёткие инструкции**: Описание способности, чтобы агент знал, что она делает.
- **Список ингредиентов**: Что именно нужно для работы (входные данные) и что получится в итоге (выходные данные).
- **Возможность комбинировать**: Рецепты можно смешивать и сочетать, чтобы приготовить изысканное блюдо. Точно так же агент может комбинировать инструменты для решения больших проблем.
- **Язык, понятный ИИ**: Рецепты написаны так, чтобы умный ИИ мог их прочитать, понять и выбрать нужный.

Когда агент выбирает рецепт (Инструмент) и добавляет конкретные ингредиенты (заполняет детали), он создаёт **Вызов** (Call). Вызов — это как приказ приготовить определённое блюдо. Больше о том, как этот приказ выполняется, можно прочитать в документе [004: Агент/Вызов](./004_agent_call.md).

> **Примечание**: Любой простой запрос к ИИ можно считать Идеей. Но Инструменты нужны для более сложных ситуаций, где агенту нужно самому решать, что делать. Чтобы узнать, как Идеи могут становиться Инструментами, загляни в [007: Агент/Ввод](./007_agent_input.md).

## Когда стоит использовать систему Инструментов

Используй Инструменты, когда хочешь, чтобы твой агент мог:

- **Самостоятельно выбирать действия** в зависимости от того, что происходит.
- **Выбирать из нескольких разных способностей**, чтобы достичь цели (например, искать в Google или в Википедии).
- **Использовать разные методы** для одного и того же дела (например, разные поисковые системы).
- **Совмещать мышление ИИ с жёстко заданными правилами** при принятии решений.

## Как устроена система Инструментов

### Главная идея: Инструмент — это просто описание

Система Инструментов построена на одной большой идее: **Инструменты — это просто чертежи**. Они говорят, *что* можно сделать, но не *как* это сделать. Настоящую работу делает либо сам умный ИИ (в своём «уме»), либо отдельная программа под названием **[003: Агент/Действие](./003_agent_activity.md)**.

Чертёж Инструмента описывает:

- **Что делает инструмент** (описание)
- **Что ему нужно для работы** (входные параметры)
  > Sidenote on Extensions:
  >
  > - `_instance`: Смотри [011: Агент/Инстансинг](./011_agent_instancing.md)
  > - `_module`: Смотри [009: Агент/Модуль](./009_agent_module.md)
- **Что ты получишь в итоге** (структура `_output`)
- **Как он называется** (имя `_tool`)
- **Кто выполняет работу** (поле `_activity`, подробнее в [003: Агент/Действие](./003_agent_activity.md))

### Специальные системные поля в чертеже Инструмента

В чертеже Инструмента некоторые поля начинаются с подчёркивания (`_`). Это специальные инструкции для системы:

- **_tool**: Уникальное имя инструмента (его нужно указывать обязательно).
- **_activity**: Указывает на `Действие` (программу), которое должно запустить этот инструмент, если оно нужно. Как система его находит, описано в [003: Агент/Действие](./003_agent_activity.md).
- **_output**: Описание того, как должен выглядеть результат.
- **_reasoningForCall**: Объяснение от агента, почему он решил использовать именно этот инструмент (это поле добавляется системой).

Любое поле без подчёркивания — это обычный ингредиент, который нужен инструменту для работы. Системные поля всегда идут первыми, чтобы ИИ было проще их понять.

### Границы системы

Система Инструментов отвечает за:

- Хранение списка всех доступных Инструментов (их чертежей).
- Заполнение деталей для инструмента (когда ИИ извлекает информацию из запроса пользователя).
- Решение, кто будет выполнять работу (справится ли ИИ сам «в уме» или передаст задачу специальной программе-`Действию`).

Более сложные вещи, такие как управление задачами и запоминание сделанного, строятся поверх этой системы (например, протокол [004: Агент/Вызов](./004_agent_call.md)).

## Как описывается Инструмент

Инструменты описываются с помощью формата под названием JSON Schema. Пример ниже показывает `Инструмент` для определения настроения предложения (например, позитивное или негативное). Этот `Инструмент` рассчитан на «неявное исполнение», то есть он полагается на собственный интеллект ИИ и не требует отдельной программы.


```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Analyzes the sentiment of a piece of text',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'The text to analyze' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Объединение чертежей для создания Вызова

Хотя каждый чертёж Инструмента описывает одну способность, их настоящая сила проявляется, когда они используются вместе. Система показывает ИИ все доступные `Инструменты` сразу, словно выкладывая перед ним ящик с инструментами. Это позволяет ИИ выбрать лучший инструмент для конкретной задачи. Когда ИИ выбирает `Инструмент` и предоставляет всю нужную информацию, он создаёт **Вызов** — команду, готовую к исполнению. Именно этот `Вызов` передаётся дальше для выполнения.

> Sidenote: - [004: Агент/Вызов](./004_agent_call.md).
>

## Неявное и Явное исполнение

Сам по себе `Инструмент` — это просто набор инструкций. А `Вызов` может быть исполнен двумя способами. По умолчанию используется **неявное исполнение**: умный ИИ использует свои собственные знания, чтобы получить результат. Это отлично подходит для задач, связанных с языком или общими знаниями.

Но для действий, которые требуют взаимодействия с реальным миром — например, поиска в интернете или проверки базы данных — `Инструмент` нужно связать с реальной программой. Это называется **явное исполнение**, а программа, которая выполняет работу, называется **Действием**.

Это разделение между инструкцией (`Инструмент`) и исполнителем (`Действие`) — ключевая идея. Она позволяет агенту сначала обдумать варианты в общих чертах, а затем решить, как именно их реализовать. Это также означает, что можно легко заменять или обновлять программу, которая делает работу, не меняя описание самой способности. Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, объяснит, как `Действия` выполняют задачи для `Инструментов`.