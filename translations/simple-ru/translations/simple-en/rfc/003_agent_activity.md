# 003: Агент/Действие

> **Действие (Activity):** Представь, что это *настоящий код*, который заставляет «Инструмент» (`Tool`) работать. «Инструмент» — это как кнопка, а «Действие» — это набор инструкций, которые выполняются, когда ты на неё нажимаешь. Это особенно важно для задач, которые ИИ не может просто «придумать», например, проверить реальный сайт или сохранить файл. — [Глоссарий](./000_glossary.md)



Этот документ объясняет **Протокол Действий** — свод правил о том, как «Инструменты» получают свою силу от настоящего, работающего кода. Если «Инструмент» описывает, *что* ты можешь сделать, то «Действие» — это код, который *на самом деле это делает*.

## Архитектура двух списков

Чтобы всё было в порядке, система ИИ использует два разных списка. Это позволяет отделить описание навыка от кода, который этот навык выполняет.

- **Список Инструментов (Реестр):** Это как меню в ресторане. В нём перечислены все вещи, которые ИИ может делать (например, «Проверить погоду»).
- **Список Действий (Реестр):** Это как книга рецептов на кухне. В ней хранится настоящий код («Действия»), который пошагово объясняет, как приготовить каждый пункт из меню.

Разделять их очень важно. Это означает, что в меню может быть «Инструмент», для которого ИИ просто «воображает» ответ. Это также значит, что ты можешь заменить рецепт на кухне (например, начать использовать другой сайт погоды), совсем не меняя меню.

## Регистрация Действия

Ты сообщаешь системе о своём коде, «регистрируя» его под специальным именем. Это имя связывает код с соответствующим «Инструментом» в меню.

```typescript
// Так ты регистрируешь код для Действия.
// Имя 'weatherCheck' должно совпадать с Инструментом, для которого оно предназначено.
Activity.register('weatherCheck', async call => {
  const data = await weatherAPI.get(call.location);
  return { temperature: data.temp, conditions: data.desc };
});
```

## Два способа работы: воображение и выполнение

Когда системе нужно использовать «Инструмент», у неё есть два способа выполнить задачу:

- **Воображаемое исполнение (скрытое):** ИИ использует свой огромный мозг, чтобы обдумать проблему и придумать ответ самостоятельно. Этот способ используется по умолчанию, если к «Инструменту» не подключен реальный код. Это как попросить умного друга угадать погоду, основываясь на времени года.

- **Явное исполнение (реальное):** ИИ запускает настоящий, пошаговый код. Этот код «Действия» выполняет работу и сообщает результат. Это необходимо для задач, которым нужно взаимодействовать с внешним миром (например, посмотреть настоящую погоду на сайте) или которые должны быть абсолютно точными каждый раз.

## Как система решает, какой способ выбрать

У системы есть простое автоматическое правило, чтобы решить, воображать ответ или запускать реальный код. Она смотрит на специальную пометку в описании «Инструмента» под названием `_activity`.

1.  **Прямые инструкции:** Если в описании «Инструмента» указано конкретное имя в `_activity`, система использует это имя, чтобы найти нужный код в Списке Действий.
2.  **Совпадение имён (простой способ):** Если прямых инструкций нет, система ищет «Действие» с **точно таким же именем**, как у «Инструмента». Если находит, то соединяет их автоматически. Это как если бы у тебя был ключ с надписью 