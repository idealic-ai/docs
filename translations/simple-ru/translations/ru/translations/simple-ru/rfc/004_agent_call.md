# 004: Агент/Вызов

> **Вызов:** Это как взять «Инструмент» и дать ему конкретное задание с точными деталями для его `параметров`. Это команда, которая говорит, *что именно нужно сделать* прямо сейчас.
>
> — [Глоссарий](./000_glossary.md)

> Sidenote:
>
> - Требуется:
>   - [103: Концепция/Идеатор](./103_concept_ideator.md)
> - Открывает возможности для:
>   - [008: Агент/Импорты](./008_agent_imports.md)
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)
>   - [202: Идея/Контейнер](./202_idea_vessel.md)
>   - [203: Идея/Процесс](./203_idea_process.md)

Мы уже знаем, что «Идея» — это просто знание, а «Инструмент» — это как инструкция, которую может понять компьютер. Этот документ рассказывает о **Вызове** — это тот самый момент, когда мы берём инструкцию и говорим: «Делай!».

Если «Инструмент» — это рецепт, то **Вызов** — это когда мы берём этот рецепт, добавляем настоящие ингредиенты и начинаем готовить.

## Путь от Идеи к Вызову

Представь, что ты хочешь сделать бутерброд. Вот как это работает в нашем мире:

1.  **Идея**: Сначала у тебя просто появляется мысль: «Хочу бутерброд». Это просто знание, мечта.
2.  **Инструмент**: Чтобы компьютер тебя понял, эта мысль превращается в «рецепт». В нём написано: для бутерброда нужны `хлеб`, `начинка` и `сыр`. Это как пустая форма, которую нужно заполнить.
3.  **Вызов**: А вот теперь начинается самое интересное! Искусственный интеллект (ИИ) берёт этот рецепт-инструкцию и решает, что именно использовать. Он говорит: «Окей, берём `два кусочка белого хлеба`, `три ломтика ветчины` и `один ломтик сыра Чеддер`». И командует: «Сделать!». Этот приказ с конкретными «ингредиентами» и есть **Вызов**.

Главное правило простое: **Любая Идея может стать Инструментом, а любой Инструмент можно использовать с помощью Вызова.**

## Как управлять выполнением: Где и Как?

Когда ты даёшь команду (делаешь `Вызов`), ты можешь уточнить две важные вещи: *где* её выполнять и *как*.

### 1. Где? (Область выполнения)

Это вопрос о том, кто будет выполнять задачу.

-   **Здесь (Прямо сейчас)**: Это обычный способ. Задачу выполняет тот же агент, который её получил. Как будто ты сам идёшь и делаешь бутерброд.
-   **Где-то ещё (В другом модуле)**: Агент может передать твою команду другому, более умелому агенту или специальной программе. Это как если бы ты попросил шеф-повара сделать тебе бутерброд, потому что он умеет это лучше. Для этого используется специальная метка `_module`.

### 2. Как? (Метод выполнения)

Это вопрос о том, как именно будет получен результат.

-   **По инструкции (Чёткий метод)**: Агент следует заранее написанному, очень точному коду. Тут нет места для фантазии. Это как собирать мебель по инструкции из IKEA — шаг за шагом. Для этого используется метка `_activity`.
-   **Творчески (Скрытый метод)**: Это режим по умолчанию. Агент не имеет точных шагов. Ты ему говоришь: «Сделай красивый рисунок заката», и он сам придумывает, как это сделать, используя свои «знания». Для этого ему нужно знать, какой результат ты ждёшь (метка `_output`).

Эти два переключателя («Где?» и «Как?») можно комбинировать, чтобы агент выполнял задачи самыми разными способами.

## Строим сложные вещи из простых блоков

`Вызов` — это как один кирпичик LEGO. Сам по себе он прост, но из множества таких кирпичиков можно построить огромный замок. Точно так же из `Вызовов` можно создавать сложные цепочки действий, которые мы называем **Процессами**.

А чтобы всё было организованно, `Вызовы` упаковываются в специальную «коробку» — **Контейнер**. В этой «коробке» лежит всё, что нужно агенту для принятия решения: твой первоначальный запрос, все доступные ему «рецепты»-`Инструменты` и, наконец, его ответ — план действий, состоящий из одного или нескольких `Вызовов`, готовых к исполнению.

> Sidenote:
>
> - [202: Идея/Контейнер](./202_idea_vessel.md)
> - [203: Идея/Процесс](./203_idea_process.md)

## Как выполнять много Вызовов сразу

Когда у агента есть целый список дел (`Вызовов`), он может выполнять их по-разному.

```typescript
// 1. Сделать одно дело
const result = await Tool(call);

// 2. Сделать все дела из списка и дождаться, пока каждое будет готово
const results = await Tool.all(calls);

// 3. Пробовать делать всё по очереди, но остановиться, как только одно дело будет успешно выполнено
const result = await Tool.any(calls);

// 4. Начать делать все дела одновременно и посмотреть, какое закончится первым (неважно, успешно или нет)
const result = await Tool.race(calls);
```

Давай представим, что это список домашних дел:

1.  **По одному**: «Сначала вынеси мусор». Просто и понятно.
2.  **Все вместе (`.all`)**: «Ты выносишь мусор, а твой друг пылесосит. Я буду ждать, пока вы оба не закончите». Это гарантирует, что все дела будут сделаны.
3.  **Кто-нибудь один (`.any`)**: «Родители просят принести из магазина хлеб или молоко. Кто первый принесёт что-то одно, тот молодец, миссия выполнена!». Важно, чтобы хотя бы одна задача была решена.
4.  **Наперегонки (`.race`)**: «Кто быстрее уберётся в своей комнате? На старт, внимание, марш!». Неважно, кто победит, важен тот, кто финиширует первым.