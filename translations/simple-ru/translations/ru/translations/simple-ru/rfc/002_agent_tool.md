# 002: Агент/Инструмент

> **Инструмент**: Представь, что у твоего компьютерного помощника (агента) есть набор суперспособностей. Инструмент — это инструкция или «чертёж» для одной такой способности. Эту инструкцию показывают умной программе (модели), чтобы она поняла, что можно сделать. Когда программа решает использовать способность, она создаёт «Вызов» с нужными деталями. А потом этот «Вызов» выполняется либо «в уме» самой программы, либо другой, специальной программой, которая называется «Действие». — [Глоссарий](./000_glossary.md)

> Sidenote: > Sidenote: Требуется: [001: Агент/Запрос](./001_agent_request.md). Дополняется: [003: Агент/Действие](./003_agent_activity.md).
>

Этот документ объясняет, что такое Инструмент. Это основа, которая помогает агентам понимать и использовать разные суперсилы.

## Что такое Инструменты?

**Инструменты — это как рецепты для повара**. Они дают агенту-повару новую крутую возможность: **выбирать, что приготовить, в зависимости от заказа**.

Каждый рецепт (Инструмент) даёт:

- **Чёткие инструкции**: Описание блюда, чтобы повар понял, что это такое.
- **Список ингредиентов**: Что нужно взять для готовки (входные данные) и что получится в конце (выходные данные).
- **Возможность смешивать**: Рецепты можно сочетать, чтобы приготовить сложное меню. Так и агент может смешивать инструменты для решения больших задач.
- **Понятность**: Рецепты написаны так, что умная программа-повар может их прочитать, понять и выбрать нужный.

Когда агент берёт рецепт (Инструмент) и добавляет в него конкретные продукты (заполняет детали), он создаёт **Вызов** — это как команда «Приготовить это блюдо!». О том, как эта команда выполняется, мы поговорим в документе [004: Агент/Вызов](./004_agent_call.md).

> **Примечание**: Любой простой вопрос к модели — это уже маленькая задача. Но Инструменты нужны для сложных дел, когда агенту нужно самому выбирать, что делать.

## Когда стоит использовать Инструменты

Используй Инструменты, если хочешь, чтобы твой агент мог:

- **Сам решать**, что делать в разных ситуациях.
- **Выбирать из нескольких суперсил**, чтобы выполнить задачу (например, поискать в Google или в Википедии).
- **Применять разные способы** для одного и того же дела (например, разные поисковики).
- **Совмещать своё «мышление» с чёткими правилами**, когда принимает решения.

## Как это работает

### Главная идея: Инструмент — это просто инструкция

Вся система построена на одной важной мысли: **Инструменты — это просто описание, как инструкция к LEGO**. Она говорит, *что* можно собрать, но не собирает модель сама. Собирает её либо сама умная программа («в уме»), либо специальный робот-помощник, который называется **[003: Агент/Действие](./003_agent_activity.md)**.

Инструкция (Инструмент) описывает:

- **Что он делает** (description)
- **Что ему для этого нужно** (какие «ингредиенты»)
> Sidenote: > Sidenote: о расширениях:
>
> - `_instance`: Смотри [011: Агент/Инстансинг](./011_agent_instancing.md)
> - `_module`: Смотри [009: Агент/Модуль](./009_agent_module.md)
- **Что получится в итоге** (структура `_output`)
- **Как он называется** (имя `_tool`)
- **Кто его выполняет** (поле `_activity`, которое указывает на робота-помощника)

### Системные поля в инструкции

В описании Инструментов есть специальные поля, которые начинаются с палочки (`_`). Они нужны для самой системы:

- **_tool**: Уникальное имя инструмента, чтобы не перепутать его с другими.
- **_activity**: Указывает, какой робот-помощник (`Действие`) должен выполнить эту инструкцию.
- **_output**: Описание того, что мы ждём на выходе.
- **_reasoningForCall**: Записка от агента, почему он решил использовать именно этот инструмент (добавляется автоматически).

Любое поле без палочки — это обычный «ингредиент», который нужен инструменту для работы.

### За что отвечает система

Система Инструментов занимается тем, что:

- Запоминает все доступные Инструменты (хранит их инструкции).
- Помогает заполнять «ингредиенты» (данные) для выбранного Инструмента.
- Решает, кто будет выполнять команду: сама умная программа «в уме» или специальный робот-помощник (`Действие`).

Более сложные вещи, вроде управления цепочками задач, строятся уже поверх этой системы.

## Как выглядит описание Инструмента

Инструменты описываются в специальном текстовом формате. Вот пример Инструмента, который определяет настроение текста (хорошее или плохое). Он создан так, чтобы умная программа справилась с этим сама, «в уме», без помощи роботов.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует настроение текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Ящик с инструментами и Вызов

Каждый Инструмент — это одна суперсила. Но настоящая магия начинается, когда их много. Система показывает умной программе все доступные `Инструменты` сразу, как будто выкладывает перед ней целый ящик с инструментами. Она смотрит на задачу и выбирает самый подходящий.

Когда программа выбрала `Инструмент` и добавила в него всё необходимое (например, текст для анализа), получается готовая к исполнению команда — **Вызов**. Именно этот `Вызов` и передаётся дальше на выполнение.

> Sidenote: > Sidenote: [004: Агент/Вызов](./004_agent_call.md).

## Выполнение «в уме» и с помощью «робота»

Сам `Инструмент` — это лишь инструкция. А выполнение `Вызова` бывает двух видов.

1.  **Выполнение «в уме» (Скрытое)**: Программа сама придумывает результат, используя свои знания. Это как решать задачку в голове. Отлично подходит для задач, связанных с текстом, языком или творчеством.
2.  **Выполнение с помощью «робота» (Явное)**: Для действий, которые требуют связи с реальным миром — например, зайти на сайт в интернете или проверить почту — `Инструмент` нужно связать с настоящей программой-помощником. Этот помощник называется **Действие**.

Разделение инструкции (`Инструмент`) и её исполнителя (`Действие`) — это главная идея. Это позволяет агенту сначала подумать, что он может сделать, а уже потом решать, как именно. При этом программу-исполнителя можно легко поменять на новую, не переписывая саму инструкцию.

Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, расскажет, как `Действия` выполняют работу для `Инструментов`.