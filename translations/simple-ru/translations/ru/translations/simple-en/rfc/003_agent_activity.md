# Акт 003: Агент/Действие

> **Действие:** Представь, что `Действие` — это моторчик внутри игрушки. «Инструмент» (`Tool`) — это кнопка «Вперёд!» на пульте управления, а `Действие` — это сам моторчик, который заставляет колёса крутиться. ИИ использует `Действия` для задач, которые он не может просто «вспомнить», например, чтобы узнать погоду прямо сейчас или найти что-то на сайте в интернете. — [Глоссарий](./000_glossary.md)

> Sidenote: Этот документ основан на том, что мы узнали в [Акте 002: Агент/Tool](./002_agent_tool.md).
>

В этом документе мы разберёмся, как «Инструменты» (`Tools`) оживают с помощью настоящего кода. Проще говоря: `Tool` — это описание способности (например, «умею узнавать погоду»), а **`Действие`** — это сам код, который эту работу делает.

## Две книги рецептов

Представь, что наш ИИ — это шеф-повар в очень крутом ресторане. Чтобы ничего не перепутать, у него есть две разные книги:

- **Книга Инструментов (Меню)**: В ней перечислены все блюда, которые может «приготовить» ИИ. Каждое блюдо — это `Tool` с описанием (например, «Проверить погоду»).
- **Книга Действий (Рецепты)**: Это секретная поваренная книга. В ней находятся настоящие пошаговые рецепты (`Действия`) для каждого блюда из меню. В нашем случае, рецепты — это программный код.

Зачем так сложно? На самом деле, это гениально просто! ИИ может думать о том, что есть в меню, не вникая в рецепт. А мы, программисты, можем поменять рецепт (например, улучшить его), и для ИИ ничего не изменится — он просто получит блюдо вкуснее.

## Добавление рецепта в книгу

Чтобы добавить новый рецепт в поварскую книгу, нужно просто дать ему имя, которое совпадает с названием блюда в меню.

```typescript
// Вот как мы добавляем рецепт (Действие) в книгу.
// Имя 'weatherCheck' должно совпадать с Tool в меню.
Activity.register('weatherCheck', async call => {
  const data = await weatherAPI.get(call.location);
  return { temperature: data.temp, conditions: data.desc };
});
```

## Два способа получить ответ: воображение против действия

Когда ИИ нужно использовать `Tool`, он может получить ответ двумя путями:

- **Воображаемый результат (Скрытое исполнение)**: Это когда ИИ, как суперумный ученик, просто «знает» ответ, не подглядывая в книгу. Если спросить его, в каком году была Куликовская битва, он не полезет в интернет — он просто ответит. Это его режим по умолчанию, если нет специального кода.
> Sidenote: Подробнее о том, что означает «Скрытое», читайте здесь: [104: Концепция/Скрытое](./104_concept_latent.md)
>
- **Реальное выполнение (Явное исполнение)**: А это тот случай, когда ИИ нужно *сделать* что-то по-настоящему. Он запускает код, чтобы проверить погоду прямо сейчас или найти что-то в базе данных. Такое не придумаешь — это нужно сделать.

## Как система решает, что делать

ИИ не гадает. У него есть простой и понятный план из трёх шагов, по которому он решает, вообразить ответ или запустить код.

1.  **Прямой приказ**: Если у `Tool` есть специальная записка вроде «Используй вот этот рецепт!», система всегда будет слушаться.
2.  **Ищем по названию (Простой способ)**: Если `Tool` называется «weatherCheck», система ищет в книге рецептов `Действие` с таким же названием. Если находит — использует его. Это самый частый способ.
3.  **Если ничего не нашли — фантазируем!**: Если нет ни приказа, ни рецепта с таким же названием, ИИ просто использует своё воображение, чтобы дать ответ. Так он никогда не попадёт в тупик.

Почему это так удобно для программистов?

- Чтобы заставить `Tool` работать по-настоящему, нужно просто дать коду **такое же имя**.
- Если создать `Tool` без кода, он не сломается, а просто будет обрабатываться интеллектом ИИ.
- Если один и тот же код подходит для разных `Tools`, можно просто дать им «прямой приказ» (Правило №1) использовать один и тот же рецепт.

## Почему это разделение так важно

Представь, что было бы, если бы рецепт был напечатан прямо в меню. Чтобы поменять один ингредиент в супе, пришлось бы перепечатывать все меню в ресторане! Ужас!

Разделение «меню» и «рецептов» даёт нам суперсилу — гибкость:

- **Можно улучшать рецепты тайно**: Программист может поменять код, который проверяет погоду (например, взять данные с другого, более точного сайта), а ИИ, использующий `Tool` «weatherCheck», этого даже не заметит. Он просто продолжит работать, но станет лучше.
- **Можно сравнивать**: Можно попросить ИИ сначала представить ответ, а потом получить его с помощью кода, и сравнить, что получилось лучше.
- **Можно безопасно пробовать новое**: Можно дать новый, эксперементальный рецепт только одному ИИ-агенту, пока все остальные пользуются старым и проверенным. Это как дать новому повару-стажёру приготовить блюдо для одного столика, а не для всего ресторана сразу.

## От знания к действию

Итак, теперь мы знаем, *что* умеет делать наш ИИ (меню с `Tools`) и *как* он это делает (книга рецептов с `Действиями`). Но это только полдела. Как же ИИ принимает заказы, отправляет их на кухню и следит, чтобы всё было готово вовремя?

Следующий документ, [Акт 004: Агент/Вызов](./004_agent_call.md), объясняет, как это всё работает вместе.