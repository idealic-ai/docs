# Акт 003: Агент/Действие

> **Действие (Activity):** Представь, что `Инструмент` — это кнопка в приложении, например, «Показать погоду». А `Действие` — это тот самый настоящий код, который запускается при нажатии на эту кнопку. Он связывается с интернетом, получает данные с погодного сайта и показывает их тебе. Это «мускулы», которые выполняют реальную работу, которую сам по себе искусственный интеллект (ИИ) придумать не может, например, заглянуть в базу данных или узнать точное время. — [Глоссарий](./000_glossary.md)

> Sidenote: Требуется: [002: Агент/Инструмент](./002_agent_tool.md)
>

Этот документ объясняет, как `Инструменты` (что агент *может* делать) получают настоящий, работающий код, который называется `Действие` (как он это *делает*).

## Два Разных Списка

Чтобы не путать «что можно сделать» и «как это сделать», система использует два отдельных списка:

- **Список Инструментов**: Это как меню в ресторане. В нём перечислены все «блюда» (`Инструменты`), которые можно заказать.
- **Список Действий**: Это кухня ресторана. Здесь находятся «повара» (`Действия`), которые по-настоящему умеют готовить эти блюда.

Такое разделение очень удобно. Можно, например, попросить ИИ просто *представить*, какой будет результат (он пофантазирует, глядя в меню). А можно заменить одного повара на другого (например, нанять более быстрого), и при этом меню для посетителей останется прежним.

## Как «записать» Действие в список

Чтобы система знала, какой код за какую «кнопку» отвечает, мы его «регистрируем». Мы даём коду имя, которое должно совпадать с именем `Инструмента`.

```typescript
// Говорим системе: вот код, который умеет проверять погоду.
// Имя 'weatherCheck' — это та самая кнопка (Инструмент), которую он будет обслуживать.
Activity.register('weatherCheck', async call => {
  // Эта часть кода идёт на настоящий погодный сайт...
  const data = await weatherAPI.get(call.location);
  // ...и возвращает температуру и описание погоды.
  return { temperature: data.temp, conditions: data.desc };
});
```

Так система связывает `Инструмент` `weatherCheck` с реальным кодом, который выполнит эту работу.

## Два способа выполнить задачу: Придумать или Сделать

Когда агент использует `Инструмент`, система может пойти двумя путями:

- **Придумать (Скрытое исполнение)**: ИИ использует свою «фантазию». Он не выполняет реальный код, а просто придумывает очень правдоподобный ответ. Это как спросить умного друга: «Какая погода в Париже?». Он не видит Париж, но может догадаться: «Наверное, сейчас весна, так что там прохладно и может быть дождик». Этот способ используется по умолчанию, если для `Инструмента` нет настоящего кода.
  > Sidenote: [104: Концепция / Скрытое](./104_concept_latent.md)
- **Сделать (Явное исполнение)**: Система находит и запускает настоящий код (`Действие`). Это как открыть на телефоне приложение погоды. Оно не гадает, а лезет в интернет и показывает точные данные. Этот способ нужен, когда требуется точный результат или нужно что-то сделать во внешнем мире (например, отправить сообщение).

## Как система решает, придумать или сделать?

Системе не нужны сложные настройки, чтобы выбрать способ. Она действует по простым правилам:

1.  **Сначала ищет точное указание**: Вдруг в описании `Инструмента` прямо написано, какой код использовать.
2.  **Потом ищет по имени (самый частый способ)**: Если точного указания нет, система смотрит, есть ли `Действие` с таким же именем, как у `Инструмента`. Нашла `Инструмент` «показать_погоду»? Ищет `Действие` с именем «показать_погоду». Если находит — запускает его.
3.  **Если ничего не нашла — придумывает**: Если код с подходящим именем не найден, система переключается в режим «фантазии», чтобы ИИ придумал ответ сам.

Благодаря этому всё работает очень просто:

- **Хочешь, чтобы код заработал? Просто назови `Действие` так же, как и `Инструмент`.**
- `Инструменты`, для которых ты ещё не написал код, будут работать в режиме «фантазии» автоматически и не сломаются.
- Если нужно, можно напрямую указать в `Инструменте` имя другого `Действия`, и оно будет главным.

## Зачем вообще разделять «кнопки» и «код»?

Если бы мы этого не делали, описание `Инструмента` было бы намертво привязано к его коду. Представь, что для проверки погоды ты сначала использовал один сайт, а потом нашёл другой, получше. Тебе пришлось бы найти всех агентов, которые пользуются этим `Инструментом`, и переписать их. Это очень неудобно.

Благодаря разделению на два списка, `Инструменты` («кнопки») остаются прежними, а `Действия` («код за кнопками») можно менять когда угодно. Агенты просто знают, что есть кнопка «Показать погоду», и им не важно, какой сайт используется для этого сегодня. Это даёт суперспособности:

- **Можно менять код, не ломая агентов**: Ты можешь сначала заставить ИИ придумывать погоду, а потом подключить настоящий погодный сервис. Агентам ничего переделывать не придётся.
- **Можно тестировать разные подходы**: Например, сравнить, что работает лучше — выдумка ИИ или данные с реального сайта для одной и той же задачи.
- **Можно обновляться постепенно**: Включить новый код для одних агентов, пока другие пользуются старым или просто фантазируют.

## От идеи к результату

Итак, мы разделили «что делать» (`Инструмент`) и «как делать» (`Действие`). Это делает систему очень гибкой. Но это только часть истории. Теперь, когда у нас есть и «кнопки», и «код» для них, нужно понять, как система управляет нажатиями на эти кнопки, запускает код и выстраивает их в правильном порядке.

Следующий документ, [004: Агент/Вызов](./004_agent_call.md), расскажет о том, как система превращает наши абстрактные идеи в конкретные, работающие шаги.