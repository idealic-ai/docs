# 002: Агент/Инструмент

> **Инструмент**: Представь, что это «приложение» для умного помощника (агента). Это инструкция, которая описывает, что помощник может сделать. Мозг помощника (LLM) читает эту инструкцию и, если нужно, запускает «приложение», создавая **Вызов** с нужными данными. Этот вызов выполняется либо самим мозгом «в уме», либо с помощью специальной программы (**Действия**). — [Глоссарий](./000_glossary.md)

> Sidenote: > Sidenote: Эта статья основана на [001: Агент/Запрос](./001_agent_request.md) и связана со следующей: [003: Агент/Действие](./003_agent_activity.md).
>

В этой статье мы разберёмся, что такое Инструменты. Это как набор приложений и инструкций к ним, которые помогают нашим умным помощникам (агентам) понимать, что они могут делать, и выполнять разные задачи.

## Что такое Инструменты?

**Инструменты — это суперспособность** для умных помощников. Они позволяют им не просто следовать командам, а **выбирать самое правильное действие в зависимости от ситуации**. Как если бы у тебя был волшебный рюкзак, из которого в нужный момент появляется именно тот предмет, который нужен.

Вот что дают Инструменты:

- **Понятные инструкции**: У каждого «приложения» есть описание, чтобы помощник понял, для чего оно.
- **Правила игры**: Чётко сказано, какие данные нужно дать «приложению» на вход и что оно вернёт в ответ.
- **Конструктор LEGO**: Инструменты можно соединять друг с другом, как кубики LEGO, чтобы выполнять сложные задачи.
- **Язык для машин**: Инструкции написаны так, чтобы главный мозг (LLM) мог их прочитать и решить, какой Инструмент использовать.

Когда помощник выбирает Инструмент и заполняет все нужные для него данные, он создаёт **Вызов**. Это как заполненная форма заказа: «Хочу использовать калькулятор, чтобы сложить 2 и 3». Этот Вызов и отправляется на выполнение (подробнее об этом в [004: Агент/Вызов](./004_agent_call.md)).

> **Примечание**: Любую простую команду для помощника можно представить как «Идею». Но Инструменты нужны для более крутых штук, когда помощнику нужно самому выбирать, что делать. О том, как превращать Идеи в Инструменты, читай в [007: Агент/Ввод](./007_agent_input.md).

## Когда нужны Инструменты?

Инструменты пригодятся, когда нужно, чтобы умный помощник мог:

- **Думать сам** и выбирать действия в зависимости от того, что происходит вокруг.
- **Выбирать из нескольких вариантов**, как достичь цели (например, найти информацию в Google или в Википедии).
- **Использовать разные версии** одного и того же действия (например, разные поисковики).
- **Сочетать размышления** своего «мозга» с точными командами.

## Как это всё устроено

### Главная идея: Инструкция отдельно от действия

Система Инструментов работает по простому правилу: **Инструмент — это просто инструкция (схема)**. В ней говорится, *что* можно сделать, но не *как* именно. А выполнить задачу может либо сам мозг помощника (LLM), используя свои знания, либо специальная программа — **[Действие](./003_agent_activity.md)**.

Инструкция к Инструменту описывает:

- **Что** он делает (его описание).
- **Что** ему нужно для работы (какие данные ему передать).
> Sidenote: > Sidenote: Есть и другие специальные поля, например `_instance` (о нём можно почитать в [011: Агент/Инстансинг](./011_agent_instancing.md)) и `_module` ([009: Агент/Модуль](./009_agent_module.md)).
>
- **Что** он вернёт в результате (поле `_output`).
- **Как** он называется (имя `_tool`).
- **Как** его выполнить (поле `_activity`, которое указывает на специальную программу, если она нужна; подробнее в [003: Агент/Действие](./003_agent_activity.md)).

### Системные поля в инструкции

В инструкциях к Инструментам есть специальные поля, которые начинаются с `_`. Это как пометки «для служебного пользования»:

- **_tool**: Уникальное имя Инструмента (обязательно).
- **_activity**: Указывает, какая программа (`Действие`) должна выполнить эту задачу.
- **_output**: Описывает, как будет выглядеть результат.
- **_reasoningForCall**: Сюда помощник записывает, почему он решил использовать именно этот Инструмент.

Все остальные поля без `_` — это обычные данные, которые нужны для работы Инструмента. Системные поля всегда пишутся в начале, чтобы всё было по порядку.

### За что отвечает система

Система Инструментов помогает:

- Записывать и хранить все Инструменты и их инструкции.
- Помогать помощнику заполнять нужные данные для Инструмента.
- Решать, кто выполнит задачу: сам мозг помощника или специальная программа (`Действие`).

Более сложные правила, например, как управлять цепочками действий, описаны в других документах (таких как [004: Агент/Вызов](./004_agent_call.md)).

## Как выглядит инструкция для Инструмента

Инструкции пишутся в формате JSON-схемы. Вот пример `Инструмента`, который определяет, какая у текста эмоциональная окраска (позитивная или негативная). Ему не нужна внешняя программа, потому что мозг помощника (LLM) отлично справляется с этим сам.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует тональность текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Объединение Инструментов в Вызов

Один Инструмент хорош, но их настоящая сила — в команде. Система показывает мозгу помощника (LLM) все доступные Инструменты сразу. Это как дать мастеру ящик с инструментами, чтобы он сам выбрал нужный. Когда LLM выбирает Инструмент и заполняет его данными, он создаёт **Вызов**. Этот **Вызов** — и есть готовая к выполнению команда, которая отправляется в работу.

> Sidenote: > Sidenote: Больше подробностей о Вызовах есть в документе [004: Агент/Вызов](./004_agent_call.md).
>

## Выполнение «в уме» и с помощью программы

Инструкция (`Инструмент`) — это только описание. А выполнить её можно двумя способами. Первый — **выполнение «в уме»**: LLM сам придумывает ответ, используя свои гигантские знания. Это идеально для задач, связанных с текстом или творчеством. Но если нужно сделать что-то во внешнем мире (например, узнать погоду с сайта или найти что-то в базе данных), то Инструмент связывают со специальной программой. Эта программа называется **Действие** (`Activity`).

Разделение инструкции (`Инструмент`) и исполнителя (`Действие`) — это очень важная идея. Она позволяет описывать возможности помощника в общих чертах, а способ их выполнения можно легко менять или улучшать. О том, как **Действия** выполняют работу для **Инструментов**, мы поговорим в следующем документе: **[003: Агент/Действие](./003_agent_activity.md)**.