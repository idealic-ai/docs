# 003: Агент/Действие

> **Действие:** Представь, что «Инструмент» — это кнопка в приложении, например, «Узнать погоду». А «Действие» — это сам компьютерный код, который запускается при нажатии на эту кнопку. Этот код идёт в интернет, получает прогноз погоды и показывает его тебе. Это та самая «рабочая» часть, которая заставляет кнопку функционировать. — [Глоссарий](./000_glossary.md)

> Sidenote: > Sidenote: Чтобы понять эту страничку, лучше сначала прочитать про [Инструменты](./002_agent_tool.md). Это как узнать, что такое кнопки, прежде чем разбираться, как они работают.
>

Этот документ объясняет, как «Инструменты» (идеи того, что можно сделать) превращаются в настоящий, работающий код. Если Инструмент — это обещание что-то сделать, то Действие — это само выполнение этого обещания.

## Архитектура двух записных книжек

Чтобы не запутаться, система агентов использует две разные «записные книжки»:

- **Книжка Инструментов**: Здесь записано всё, что агент *в принципе* может сделать. Например: «проверить погоду», «найти картинку». Это просто список возможностей, как меню в ресторане.
- **Книжка Действий**: А здесь хранится сам «рецепт» для каждого дела. То есть конкретный код, который нужно запустить, чтобы по-настоящему проверить погоду или найти картинку.

Разделять их очень удобно! Можно поменять рецепт (например, начать узнавать погоду с другого сайта), а название в меню останется прежним. Агент даже не заметит разницы, он просто продолжит заказывать «погоду».

## Регистрация Действия

Чтобы компьютер знал, какой код запускать, мы должны «зарегистрировать» Действие. Это похоже на добавление нового номера в телефонную книгу. Мы говорим: «Эй, компьютер, если тебя попросят 'проверитьПогоду', используй вот этот код».

```typescript
// Регистрируем наш код (Действие).
// Мы даём ему имя 'weatherCheck', и оно должно совпадать с названием Инструмента.
Activity.register('weatherCheck', async call => {
  const data = await weatherAPI.get(call.location);
  return { temperature: data.temp, conditions: data.desc };
});
```

## Режимы выполнения: Вообразить или Сделать

Агент может выполнить твою просьбу двумя способами:

- **Скрытое выполнение (Вообразить)**: Агент использует свой «ум» (нейросеть), чтобы придумать ответ. Например, если попросить его «описать погоду в сказочном городе», ему не нужно лезть в интернет. Он просто вообразит её. Это его режим по умолчанию, если он не находит конкретного кода для задачи.
  > Sidenote: > Sidenote: Этот режим «воображения» — очень интересная штука. Подробнее о том, как ИИ «думает», можно прочитать здесь: [104: Концепция / Скрытое](./104_concept_latent.md).
  >
- **Явное выполнение (Сделать по-настоящему)**: Если для просьбы есть специальный код (Действие), агент не придумывает, а честно запускает этот код. Например, чтобы узнать погоду в Москве, он вызовет Действие, которое подключится к реальному погодному сайту. Это нужно для задач, где важна точность и связь с реальным миром.

## Как агент выбирает, что делать

Как агент решает, воображать ему ответ или выполнять код? Он действует по простому плану, как курьер, который ищет, кому доставить посылку:

1.  **Прямое указание**: В Инструменте есть записка: «Для этого задания используй Действие с названием 'сделать_вот_так'». Это самый главный приказ.
2.  **Совпадение имён (самый простой способ)**: Если прямого указания нет, агент ищет Действие с таким же названием, как у Инструмента. Если Инструмент называется «найти_песню», он будет искать Действие «найти_песню». Это очень удобно, поэтому так делают чаще всего.
3.  **Если ничего не найдено (режим воображения)**: Если по первым двум правилам ничего не нашлось, агент понимает, что конкретного кода для этой задачи нет. Тогда он переключается в режим «воображения» и пытается придумать ответ сам.

Благодаря этому всё работает просто и надёжно. Если ты создаёшь Инструмент, который должен делать что-то по-настоящему, просто напиши для него Действие с таким же названием!

## Почему это разделение так важно

Зачем все эти сложности с разделением «кнопок» (Инструментов) и «кода» (Действий)? Представь игровой джойстик. Кнопка «прыжок» — это Инструмент. А то, как высоко и быстро прыгает твой персонаж — это Действие.

Если бы они были слиты в одно, то чтобы изменить физику прыжка, пришлось бы менять сам джойстик! А так, разработчики могут улучшать код прыжка сколько угодно, а для тебя кнопка на джойстике останется прежней.

Так же и здесь:

- **Агенты не ломаются**: Можно полностью поменять код Действия, и агенты, которые используют этот Инструмент, даже ничего не заметят.
- **Можно тестировать**: Можно создать два Действия для одного Инструмента: одно, где ИИ «воображает», а другое — где он обращается к реальному сайту. И посмотреть, что работает лучше.
- **Улучшать постепенно**: Можно дать новый, крутой код только некоторым агентам, а остальные пока пусть пользуются старым. Это безопасно.

## От идеи к действию

Итак, мы разобрались, как отделить «что делать» (Инструмент) от «как делать» (Действие). Это даёт нам огромную гибкость.

Но остался последний вопрос: как агент решает, какие Инструменты использовать и в каком порядке? Как он «нажимает на кнопки»?

Об этом — следующий документ, [004: Агент/Вызов](./004_agent_call.md), который расскажет, как всё это превращается в последовательность реальных шагов.