# 008: Агент/Импорты

> **Импорт:** Это как специальная бирка, которая показывает, какую именно информацию из «общей памяти» программы можно передать коду, который сейчас будет работать. Это помогает либо сфокусировать внимание искусственного интеллекта (ИИ), когда он думает «про себя», либо собрать всю нужную информацию для задачи, которая выполняется в отдельной, изолированной «песочнице». За это отвечает настройка `_imports`. — [Глоссарий](./000_glossary.md)

В другом документе ([Акт 004: Агент/Вызов](./004_agent_call.md)) мы обсуждали, что у каждой задачи (`Вызова`) есть два главных переключателя: **Область** (где она выполняется) и **Метод** (как она выполняется). Этот документ, **Протокол Импортов**, объясняет, как эти переключатели работают вместе и как «Импорты» помогают управлять информацией для каждого случая.

## Как сочетаются «Где» и «Как»

1.  **Прямо здесь и сейчас, по команде (`_activity`)**: Это самый обычный способ использовать инструменты. Представь, что ИИ — это ты, а инструмент — калькулятор. Ты говоришь ему «сложи 2+2» (это `params`), и он тут же показывает «4». «Импорты» здесь обычно не нужны, потому что всё и так понятно и происходит открыто.

2.  **Прямо здесь, но «в уме» (без `_activity`)**: Здесь ИИ сам представляет, какой будет результат. Он не использует калькулятор, а сразу говорит: «Если сложить 2 и 2, получится 4». Чтобы помочь ему не отвлекаться на другие мысли, мы можем использовать `_imports`. Это как сказать ему: «Думай только об этих двух числах». «Импорты» действуют как шоры для лошади, сужая поле зрения.

3.  **В отдельной «комнате» и по команде (`_module` + `_activity`)**: ИИ готовит данные (`params`). Затем система берёт эти данные и отправляет их в отдельную «комнату» (`_module`), где специальный помощник (`_activity`) выполняет задачу. Если мы указали `_imports`, то в эту «комнату» передаётся только строго определённая информация — как папка с нужными документами. Помощник не видит ничего за её пределами.

4.  **В отдельной «комнате» и «в уме» (`_module`, без `_activity`)**: ИИ готовит данные (`params`). Затем система запускает в изолированной «комнате» другого умного помощника (`_module`). Ему дают папку с документами (`_imports`) и говорят: «Подумай и реши эту задачу, используя только эти данные». Этот помощник не использует готовый инструмент, а думает сам, но в полной изоляции.

## Фокусируем зрение

Настройка `_imports` — это главный способ контролировать, какую информацию видит задача (`Вызов`). Она работает как список разрешений, фильтруя всю «общую память» и оставляя только то, что нужно. Это создаёт сфокусированный, ограниченный обзор.

- **Когда задача выполняется «прямо здесь»**: `_imports` помогают ИИ не отвлекаться.
- **Когда задача выполняется «в отдельной комнате»**: `_imports` определяют **вообще всё**, что может видеть помощник. Для него за пределами этой информации ничего не существует.

## Дать готовое или спросить, что нужно? Статические и Динамические Импорты

Настройка `_imports` в описании Инструмента (`Tool`) определяет, кто решает, какая информация будет передана: разработчик заранее или сам ИИ в процессе работы.

- **Статические Импорты (Дать готовое)**: Представь, что разработчик заранее собрал для инструмента «ланч-бокс» с едой. В настройках `_imports` он жёстко прописал, какие именно данные (`const`) нужны (например, `_imports: { "const": ["input"] }`). Инструмент получает этот «ланч-бокс» и не может попросить ничего другого. Информация **предоставляется** ему.

> Sidenote:
> 
> ```mermaid
> graph TD
>     subgraph Родительский контекст
>         direction LR
>         input("input")
>         state("state")
>     end
> 
>     subgraph Вызов инструмента
>         direction LR
>         filter{{"_imports: ['input']"}}
>     end
> 
>     input --> filter
>     state -.-> filter
> 
>     subgraph Предоставленный контекст
>         direction LR
>         input_prov("input")
>     end
> 
>     filter --> HITL{{Одобрение человеком}}
>     HITL --> input_prov
>     input_prov --> Execute(Выполнить инструмент)
> 
>     classDef unused stroke-dasharray: 5, 5, stroke:#aaa, color:#aaa
>     class state unused
>     classDef optional stroke-dasharray: 5, 5
>     class HITL optional
> ```

- **Динамические Импорты (Спросить, что нужно)**: А здесь у инструмента есть «меню» с доступными данными (`enum`). Настройка `_imports` гибкая (например, `_imports: { "type": "array", "items": { "enum": ["state"] } }`). ИИ сам смотрит в это «меню» и решает, какую информацию ему «заказать» для выполнения задачи. Информация **запрашивается** им.

Этот способ особенно полезен, когда рядом есть человек. Прежде чем ИИ получит запрошенные данные, человек может посмотреть на его «заказ» и одобрить его. Это даёт нам отличный контроль и делает работу системы прозрачной.

## Почему так важно ограничивать обзор

- **Больше безопасности и фокуса**: Когда мы ограничиваем обзор, мы защищаем данные от случайных «утечек». Это как дать работнику доступ только к тем файлам, которые нужны ему для дела. Он не сможет случайно увидеть или испортить что-то лишнее. А ещё это помогает ИИ лучше сосредоточиться, что делает его работу более точной, предсказуемой и дешёвой (ведь он не тратит время на анализ ненужного).
- **Улучшенная «лего-совместимость»**: «Импорты» позволяют делать разные части программы (Идеи и Действия) по-настоящему независимыми друг от друга, как детали конструктора LEGO. Каждую деталь можно использовать в разных поделках, потому что она работает сама по себе и не зависит от других, если дать ей нужные «крепления» (импорты).