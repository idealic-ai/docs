# 002: Агент/Инструмент

> **Что такое Инструмент?** Представь, что у нашего умного помощника (агента) есть набор суперспособностей. Инструмент — это инструкция к одной из таких способностей. ИИ читает эту инструкцию, чтобы понять, что он может сделать. Когда он решает её использовать, он создаёт команду «Вызов». А дальше эту команду выполняет либо сам ИИ в уме, либо специальная программа-помощник («Действие»). — [Глоссарий](./000_glossary.md)

> Sidenote: - **Нужно сначала прочитать:** [001: Агент/Запрос](./001_agent_request.md)
> - **Что будет дальше:** [003: Агент/Действие](./003_agent_activity.md)

Этот документ — путеводитель по миру Инструментов. Мы разберёмся, как они помогают нашим умным агентам получать новые способности.

## Что такое Инструменты?

Представь, что наш умный помощник (агент) — это герой компьютерной игры. А **Инструменты — это его суперспособности или заклинания из волшебной книги.** Каждое заклинание даёт ему новую силу — например, искать информацию в интернете, рисовать картинки или переводить слова.

Самое главное, что благодаря этим инструкциям-заклинаниям агент может **сам решать, какую способность использовать**. Он смотрит на задачу и выбирает из своей книги самое подходящее заклинание.

Что крутого в Инструментах:

- **Простые инструкции**: У каждой суперспособности есть понятное описание, чтобы агент точно знал, что она делает.
- **Никаких ошибок**: В инструкции чётко сказано, что нужно для колдовства и какой будет результат. Всё точно, как в рецепте зелья.
- **Конструктор LEGO**: Простые инструменты можно соединять вместе, чтобы выполнять сложные задачи, прямо как строить замок из кубиков LEGO.
- **Язык для ИИ**: Все инструкции написаны на специальном языке, который «мозг» агента (языковая модель) легко читает и понимает.

Когда агент выбрал заклинание и добавил все нужные детали (например, какое слово перевести), он создаёт **«Вызов»**. Это команда «Используй эту способность прямо сейчас!». О том, как эта команда выполняется, мы поговорим в документе [004: Агент/Вызов](./004_agent_call.md).

> **Заметка**: Простые просьбы к ИИ, например, «напиши стих», можно считать просто «Идеей». Но для сложных заданий, где нужно выбирать из разных действий, нужны Инструменты.

## Когда нужны Инструменты?

Инструменты — твой выбор, если агенту нужно:

- **Думать на лету** и выбирать, что делать дальше, в зависимости от ситуации.
- **Выбирать из разных суперспособностей** (например, поискать ответ в Google или в Википедии).
- **Использовать разных помощников** для одной задачи (например, разные программы для рисования).
- **Совмещать размышления и чёткие команды**, чтобы принять верное решение.

## Как это всё работает?

### Главный фокус: Инструмент — это только чертёж

Вся система построена на одной хитрой идее: **Инструменты — это просто чертежи, а не сами предметы.**

Представь, что у тебя есть чертёж стула. На нём нарисовано, какой стул должен получиться и из каких деталей он состоит. Но сам чертёж не может собрать стул. Для этого нужен мастер, который возьмёт чертёж и всё сделает.

Так и здесь. Инструмент — это просто описание: *что* нужно сделать. А само действие выполняет либо «мозг» нашего ИИ (если задача простая, вроде придумывания текста), либо его специальный помощник — программа под названием **[Действие](./003_agent_activity.md)** (если нужно что-то сделать в реальном мире, например, проверить погоду).

В чертеже Инструмента указано:

- **Что он делает** (описание).
- **Что ему нужно для работы** (какие детали нужны).
> Sidenote: Дополнительные возможности:
>
> - `_instance`: Смотри [011: Агент/Инстансинг](./011_agent_instancing.md)
> - `_module`: Смотри [009: Агент/Модуль](./009_agent_module.md)
- **Что получится в итоге** (поле `_output`).
- **Как он называется** (имя `_tool`).
- **Кто его будет выполнять** (поле `_activity`, которое вызывает помощника-«Действие»).

### Секретные пометки на чертежах

На чертежах есть специальные поля, которые начинаются с символа `_`. Это как секретные пометки для системы, чтобы она всё правильно поняла:

- `_tool`: Уникальное имя инструмента, чтобы не перепутать его с другими.
- `_activity`: Имя помощника («Действия»), которого нужно позвать, чтобы выполнить задачу.
- `_output`: Описание того, что мы ждём в результате.
- `_reasoningForCall`: Мысли самого агента о том, почему он выбрал именно этот инструмент (эту пометку система добавляет сама).

Все остальные поля без `_` — это обычные параметры, которые нужны для работы. Например, для инструмента-переводчика это будет текст, который нужно перевести.

### Кто за что отвечает

- **Система Инструментов**: Хранит все «чертежи», помогает ИИ заполнять их и решает, кто будет выполнять задачу — сам ИИ или его помощник «Действие».

Всё, что сложнее — например, как управлять цепочками из нескольких задач — строится поверх этой простой системы.

## Как выглядит чертёж Инструмента

Инструменты описываются в специальном формате, похожем на анкету (он называется JSON Schema). Вот как выглядит чертёж для Инструмента, который угадывает настроение текста (например, весёлый он или грустный). Эту задачку ИИ решает сам, «в уме», потому что для этого ему не нужны никакие помощники — он ведь и так отлично разбирается в словах.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует настроение текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Меню суперспособностей

Один инструмент — это хорошо, но настоящая магия начинается, когда их много. Система показывает ИИ все доступные ему Инструменты, как меню в ресторане. Это позволяет ему выбрать самый подходящий для конкретной задачи. Когда ИИ выбрал блюдо (Инструмент) и указал все детали, он делает **«Вызов»**. Это и есть готовая команда, которая отправляется на кухню для исполнения.

> Sidenote: Подробнее об этом можно прочитать в [004: Агент/Вызов](./004_agent_call.md).

## Два способа выполнить задачу: в уме и по-настоящему

Сам по себе чертёж — это просто описание. А вот выполнить команду можно двумя способами.

- **Выполнение в уме (Скрытое):** Это когда ИИ справляется сам, используя только свой «мозг». Например, если ты просишь его придумать рифму к слову «кот», ему не нужны помощники. Он просто думает и отвечает. Это способ по умолчанию.

- **Выполнение по-настоящему (Явное):** Это когда нужно сделать что-то за пределами «мозга» ИИ. Например, узнать, какая сейчас погода в Лондоне. ИИ не может сам «посмотреть» в окно в Лондоне. Вместо этого он использует Инструмент «УзнатьПогоду», который даёт команду специальной программе-помощнику (**Действию**). Этот помощник заходит на погодный сайт, узнаёт температуру и докладывает ИИ.

Это разделение на «чертёж» и «мастера» очень важно. Оно позволяет агенту сначала подумать обо всех своих возможностях, а уже потом решать, как их применить. А самого «мастера» (программу-помощника) можно легко заменить или улучшить, не меняя чертёж. Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, расскажет, как помощники-«Действия» оживляют «Инструменты».

> Sidenote: [003: Агент/Действие](./003_agent_activity.md).
>