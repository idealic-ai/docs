# 002: Агент/Инструмент

> **Инструмент**: Представь, что это описание суперспособности для искусственного интеллекта (агента). Когда агент получает задание, ему показывают список всех доступных «инструментов». Он выбирает нужный и использует его, чтобы что-то сделать. Это как выбрать приложение на телефоне и ввести в него данные. — [Глоссарий](./000_glossary.md)

> Sidenote: > Sidenote:
> > 
> > *   Нужен для понимания: [001: Агент/Запрос](./001_agent_request.md)
> > *   Следующий шаг: [003: Агент/Действие](./003_agent_activity.md)

Этот документ расскажет тебе про Инструменты. Это очень важная штука, которая помогает искусственному интеллекту (мы зовём его «агент») понять, что он умеет делать и как этим пользоваться.

## Что такое Инструменты?

Думай об агенте как о супергерое. **Инструменты — это его суперспособности.** Без них он может только болтать. А с инструментами он может делать полезные вещи: искать в интернете, рисовать картинки или проверять погоду.

Вот что инструменты дают агенту:

- **Простые инструкции**: Каждый инструмент — это как инструкция к суперспособности. Агент читает её и сразу понимает, что она делает и какая информация ей нужна.
- **Чёткие правила**: В инструкции точно сказано, что нужно дать на вход (например, название города для прогноза погоды) и что получится на выходе (температура и будет ли солнечно). Никакой путаницы!
- **Как LEGO**: Агент может брать несколько инструментов и использовать их вместе, чтобы решать сложные задачи, как будто собирает что-то из конструктора.
- **Умный выбор**: Когда агент получает задание, он смотрит на все свои инструменты и решает, какой из них лучше всего подойдёт для решения.

Когда агент выбрал инструмент и вписал в него нужные данные (например, выбрал «поиск картинок» и вписал «смешной котик»), это называется **Вызов**. Вызов — это команда «Сделай это прямо сейчас!». (Больше об этом ты узнаешь в документе [004: Агент/Вызов](./004_agent_call.md)).

> **Примечание**: Любую простую задачу для агента можно описать как «Идею». Но Инструменты нужны для более крутых штук, когда агенту нужно самому принимать решения. Представь, что «Идея» — это просто сказать «нарисуй кота», а «Инструмент» — это дать агенту палитру с красками и кисточками, чтобы он сам выбрал, как именно рисовать.

## Когда нужно использовать Инструменты

Инструменты нужны, когда агент должен:

- **Сам решать, что делать**, в зависимости от ситуации.
- **Выбирать из нескольких вариантов** (например, искать в Гугле или в Яндексе).
- **Использовать разные программы** для одной и той же цели (например, два разных приложения для рисования).
- **Сочетать своё «мышление» с запуском настоящих программ**, чтобы принимать решения.

## Как всё устроено

### Главный принцип: Инструкция отдельно от действия

Самое важное правило: **инструмент — это просто инструкция**. Она описывает, что можно сделать, но сама ничего не делает. Это как рецепт в поваренной книге. А «готовит» по этому рецепту либо сам агент, используя свой «ум» (это называется скрытым выполнением), либо отдельная программа-помощник, которая называется **[Действие](./003_agent_activity.md)**.

В инструкции к инструменту (в «рецепте») написано:

- **Что он делает** (например, «находит картинки в интернете»).
- **Что ему нужно для работы** (какие данные в него ввести).
> Sidenote: > Sidenote: о расширениях:
> > 
> > *   `_instance`: Смотри [011: Агент/Инстансинг](./011_agent_instancing.md)
> > *   `_module`: Смотри [009: Агент/Модуль](./009_agent_module.md)
- **Что получится в результате** (какой будет ответ).
- **Как он называется** (уникальное имя, вроде `поиск_картинок`).
- **Кто его выполнит** (если нужна программа-помощник, здесь будет её имя).

### Специальные поля в инструкции

В инструкциях есть поля, которые начинаются с `_`. Это как служебные записки для самой системы, а не для человека.

- **`_tool`**: Имя инструмента (нужно обязательно).
- **`_activity`**: Говорит, какая программа-«Действие» должна выполнить эту работу.
- **`_output`**: Описывает, как будет выглядеть результат.
- **`_reasoningForCall`**: Агент сюда записывает, почему он решил использовать именно этот инструмент. Прямо как в школе, когда просят объяснить своё решение.

### За что отвечает система

Система, которая управляет Инструментами, похожа на операционную систему в твоём телефоне. Она:

- Хранит все «инструкции» к инструментам (как список установленных приложений).
- Помогает агенту правильно заполнить все поля.
- Решает, кто будет выполнять задачу: сам агент «в уме» или специальная программа-«Действие».

Более сложные вещи, например, когда нужно выполнить несколько действий по очереди, строятся уже поверх этой простой системы.

## Как описать Инструмент

Инструменты описываются с помощью специального языка разметки, который называется JSON-схема. Это как анкета, которую нужно заполнить, чтобы объяснить системе, что делает инструмент. Вот пример инструмента, который определяет настроение текста (весёлый он или грустный). Ему не нужна внешняя программа — агент справится с этим сам, «в уме».

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует тональность текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Выбор инструмента и Вызов

Главная сила инструментов в том, что агент может сам выбирать из них. Система показывает ему все доступные инструкции. Агент читает их и решает, какая лучше всего подходит для текущей задачи. Когда он выбрал инструмент и заполнил все поля, он создаёт **Вызов**. Это готовая к исполнению команда.

> Sidenote: > Sidenote: Конкретный запрос на выполнение действия называется **Вызов**. Прочитай о нём здесь: [004: Агент/Вызов](./004_agent_call.md).

## Выполнение «в уме» и «по-настоящему»

Сама по себе инструкция к инструменту — это просто текст. А вот выполнить её можно двумя способами.

1.  **Выполнение «в уме»**: Агент использует свой собственный искусственный мозг, чтобы найти ответ. Это отлично подходит для задач, связанных с текстом или знаниями. Например: «Перескажи эту статью» или «Этот отзыв о фильме хороший или плохой?».

2.  **Выполнение «по-настоящему»**: Для задач, где нужно что-то сделать во внешнем мире (найти что-то в интернете, проверить погоду), инструмент связывают с настоящей программой. Эта программа-помощник называется **Действие**.

Такое разделение на инструкцию (**Инструмент**) и исполнителя (**Действие**) — очень умная идея. Она позволяет агенту рассуждать о своих возможностях, глядя на простые инструкции, а программисты могут в это время легко менять или обновлять программы-исполнители, не трогая сами инструкции.

Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, как раз расскажет о том, как «Действия» выполняют работу для «Инструментов».