# 003: Агент/Действие

> **Действие (Activity):** Это настоящий, работающий код, который выполняет то, что обещает «Инструмент». Помнишь, мы говорили, что Инструмент — это как кнопка на пульте? Так вот, **Действие — это то, что происходит внутри устройства, когда ты нажимаешь на эту кнопку**. Действия нужны, чтобы делать что-то в реальном мире, например, проверить погоду в интернете или найти что-то в базе данных. Это то, что искусственный интеллект не может просто «вообразить». — [Глоссарий](./000_glossary.md)

> Sidenote: - Требуется: [002: Агент/Инструмент](./002_agent_tool.md)
>

Помнишь, в прошлый раз мы говорили об «Инструментах»? Это описания того, *что* наш агент вообще умеет делать. А сегодня мы поговорим о «Действиях» — настоящем коде, который выполняет всю эту работу. Если «Инструмент» — это пункт в меню ресторана, то «Действие» — это **рецепт на кухне**.

## Меню и Кухня: два разных списка

Чтобы всё работало гибко, система разделяет «что можно сделать» и «как это сделать». Для этого у неё есть два отдельных списка:

- **Список Инструментов (Меню):** Здесь хранятся все описания: какие есть «кнопки» и что они обещают сделать.
- **Список Действий (Кухня):** А здесь лежит настоящий код, «рецепты», которые выполняют эту работу.

Представь, что ты в ресторане. Меню (`Список Инструментов`) говорит тебе, что есть «чизбургер». А на кухне (`Список Действий`) есть настоящий повар с рецептом, который знает, как его приготовить. Это разделение очень важно! Благодаря ему мы можем легко поменять рецепт на кухне (например, начать использовать новый соус), но в меню название «чизбургер» останется прежним.

## Записываем «рецепт» на кухню

Чтобы «кухня» знала о новом рецепте, мы его «регистрируем». Мы даём ему имя, которое связывает его с пунктом в «меню».

```typescript
// Говорим системе: "Эй, вот рецепт для 'weatherCheck'!"
// Имя 'weatherCheck' должно быть таким же, как у Инструмента,
// чтобы система поняла, что это рецепт именно для него.
Activity.register('weatherCheck', async call => {
  // тут код, который лезет в интернет за погодой
  const data = await weatherAPI.get(call.location);
  // а тут возвращает температуру и описание
  return { temperature: data.temp, conditions: data.desc };
});
```

Этот код — тот самый повар, который по-настоящему идёт и готовит блюдо, когда его заказывают.

## Два способа работы: «Придумать» или «Сделать»

Когда агент использует Инструмент, система может поступить одним из двух способов:

- **«Придумать» (Скрытый режим):** В этом режиме ИИ сам «воображает» результат. Это как спросить своего очень умного друга: «Как думаешь, какая погода в Париже?». Он, основываясь на всём, что знает, просто придумает правдоподобный ответ, не заглядывая в интернет. Так система поступает, если для Инструмента нет настоящего «рецепта» на кухне.
  > Sidenote: - [104: Концепция/Скрытое](./104_concept_latent.md)
- **«Сделать» (Явный режим):** А здесь всё по-настоящему. Запрос передаётся на «кухню», где повар (код «Действия») выполняет работу. Это как если бы твой друг достал телефон, открыл приложение погоды и сказал тебе точный прогноз. Этот режим нужен, когда важна точность или нужно связаться с реальным миром — например, с сайтом или базой данных.

## Как система решает, «придумать» или «сделать»?

Компьютер сам решает, как поступить, и делает это очень просто. Он, как детектив, ищет подходящий «рецепт» на «кухне».

1.  **Сначала он смотрит на прямую подсказку.** В описании Инструмента (в «меню») может быть специальное поле `_activity`, где прямо сказано: «Используй рецепт с вот таким названием».
2.  **Если подсказки нет, он ищет по совпадению имён (самый простой способ).** Компьютер смотрит на имя Инструмента (например, `weatherCheck`) и ищет «рецепт» с точно таким же именем. Если находит — ура, они связаны!
3.  **Если ничего не нашлось.** Если ни подсказки, ни совпадения имён нет, система вздыхает и говорит ИИ: «Ладно, похоже, у нас нет рецепта. Придумай что-нибудь сам!» — и включает режим «придумать».

Благодаря этому, всё очень просто:

- **Хочешь связать Инструмент и Действие? Просто назови их одинаково.**
- Инструменты, для которых ты ещё не написал код, будут безопасно работать в режиме «воображения».
- А если нужно, можно использовать один и тот же «рецепт» для разных пунктов в «меню», просто указав его имя в подсказке.

## Зачем нужно это разделение на «меню» и «кухню»?

Представь, что было бы, если бы рецепт был напечатан прямо в меню. Если бы шеф-повар придумал, как готовить бургер вкуснее, пришлось бы перепечатывать все меню в ресторане! Это ужасно неудобно.

Разделение на «Инструмент» (меню) и «Действие» (кухня) решает эту проблему. Агенты (посетители) видят только меню. Им неважно, как именно повар готовит их заказ. Это даёт нам суперспособности:

- **Можно улучшать «рецепты», не трогая агентов.** Можно переключить проверку погоды с «придумывания» на настоящий сайт, и ни один агент этого даже не заметит — он просто начнёт получать более точные ответы.
- **Легко тестировать.** Можно дать одной группе агентов старый рецепт, а другой — новый, и посмотреть, какой лучше.
- **Плавные обновления.** Можно сначала просто описать Инструмент, чтобы ИИ «придумал» ответы, а настоящий код («рецепт») написать потом, когда будет время.

## От идеи к результату

Итак, мы разделили «что делать» (`Инструмент`) и «как делать» (`Действие`). Это делает систему очень мощной и гибкой.

Но это ещё не всё! У нас есть «меню» и есть «кухня». Но кто-то же должен принимать заказы от посетителей и передавать их поварам?

Об этом «официанте» — системе, которая управляет вызовами и превращает идеи в реальные результаты — мы поговорим в следующем документе: [004: Агент/Вызов](./004_agent_call.md).