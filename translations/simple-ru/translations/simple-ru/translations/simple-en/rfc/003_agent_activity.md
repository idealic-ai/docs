# 003: Агент/Действие

> **Действие (Activity):** Представь, что `Инструмент` — это кнопка в приложении, например, «Какая погода?». А `Действие` — это тот самый настоящий код, который «под капотом» лезет в интернет, находит сайт с погодой и приносит тебе ответ. Это как бы «мускулы» для «мозгов» ИИ, которые нужны, чтобы делать что-то в реальном мире, а не просто вспоминать факты. — [Глоссарий](./000_glossary.md)

> Sidenote: - Это продолжение того, что мы узнали в [002: Агент/Инструмент](./002_agent_tool.md).
>

В этой статье мы разберемся, откуда у `Инструментов` суперсилы. Если `Инструмент` — это описание способности (например, «умею узнавать погоду»), то **`Действие`** — это и есть сама магия: тот самый компьютерный код, который эту погоду узнаёт.

## Две книги рецептов

Представь себе ресторан. Чтобы всё работало как надо, там есть две разные книги:

- **Меню для гостей (`Реестр Инструментов`)**: Здесь перечислены все блюда, которые можно заказать. Ты видишь название («Проверить погоду») и короткое описание.
- **Книга рецептов для повара (`Реестр Действий`)**: Это секретная тетрадка на кухне. В ней подробно расписано, как готовить каждое блюдо из меню, шаг за шагом.

Зачем так сложно? На самом деле, это очень удобно! ИИ (наш гость) может просто выбрать что-то из меню, не вникая в рецепт. А повар (программист) может поменять рецепт — например, найти новый сайт с погодой, который работает быстрее, — и при этом меню для гостя останется прежним. Никто даже не заметит, а всё станет лучше!

## Добавление рецепта в книгу

Чтобы повар знал, какой рецепт к какому блюду относится, мы даем им одинаковые названия. В коде это выглядит так: мы «регистрируем» рецепт с именем, которое точно совпадает с названием блюда в меню.

```typescript
// Это мы говорим системе: «Вот рецепт! Он называется 'weatherCheck'».
// Теперь, когда кто-то закажет из меню 'weatherCheck', используй эти инструкции.
Activity.register('weatherCheck', async call => {
  // Сходи на сайт погоды и спроси, какая погода в нужном месте.
  const data = await weatherAPI.get(call.location);
  // А потом верни ответ: температуру и описание.
  return { temperature: data.temp, conditions: data.desc };
});
```

## Два способа получить ответ: вообразить или сделать

Когда ИИ нужно использовать `Инструмент`, у него есть два пути:

1.  **Просто придумать ответ (скрытое исполнение)**.
    Это как спросить тебя: «Кто написал "Капитанскую дочку"?». Тебе не нужно лезть в интернет, ты просто вспоминаешь ответ из головы. ИИ так же использует свои огромные знания, чтобы ответить на вопросы, не запуская никакой код. Если для `Инструмента` нет специального «рецепта», ИИ будет пытаться ответить так.
> Sidenote: - Подробнее о том, что такое «Скрытое», можно прочитать здесь: [104: Концепция/Скрытое](./104_concept_latent.md)
2.  **Сделать что-то по-настоящему (явное исполнение)**.
    А если спросить: «Какая сейчас температура за окном?». Ты не сможешь это «вспомнить», тебе нужно посмотреть на градусник. Точно так же и ИИ. Для таких задач он запускает настоящий код (`Действие`), который лезет в интернет или в базу данных, чтобы получить свежую информацию.

## Как система решает, что делать

Компьютеру не нужно каждый раз подсказывать, что делать. Он действует по простым правилам, как по инструкции:

1.  **Сначала смотрит на особые пометки.** Если в меню рядом с блюдом написано: «Готовить по рецепту №5», повар будет готовить именно по нему, без вопросов.
2.  **Если пометок нет, ищет рецепт с таким же названием.** Если в меню есть блюдо «Фирменный лимонад», повар поищет в своей книге рецепт с названием «Фирменный лимонад». Нашел? Отлично, будет готовить по нему. Это самый частый способ.
3.  **Если ничего не нашлось, ИИ пытается выкрутиться сам.** Если повар не нашел рецепт, он не будет кричать: «Я не знаю, как это готовить!». Вместо этого ИИ (наш супер-умный гость) просто попробует «вообразить» результат, основываясь на своих знаниях. Так система никогда не ломается.

Благодаря этим правилам всё становится очень просто:

- Хочешь, чтобы `Инструмент` работал по-настоящему? Просто создай для него `Действие` **с таким же названием**.
- Создал `Инструмент`, но пока не написал для него код? Не беда, ИИ сам справится.
- Хочешь, чтобы несколько разных `Инструментов` использовали один и тот же код? Просто дай им «особую пометку» (Правило №1), указывающую на один рецепт.

## Почему это разделение так важно

Зачем так всё усложнять и разделять? А теперь представь, что меню и рецепт склеены вместе. Если повар решит добавить в лимонад чуть больше мяты, ему пришлось бы бежать в зал, забирать у всех гостей меню и исправлять в нём состав! Абсурд, правда?

Разделение даёт нам суперспособности:

- **Можно менять «кухню», не трогая «зал»**: Программисты могут полностью переписать код для проверки погоды (например, перейти на новый, более точный сайт), а ИИ-агент этого даже не заметит. Для него кнопка «Проверить погоду» будет работать как раньше.
- **Можно экспериментировать**: Можно дать ИИ и «вообразить» ответ, и получить его с помощью настоящего кода, а потом сравнить, что получается лучше.
- **Безопасно пробовать новое**: Можно дать новый, еще не проверенный рецепт только одному агенту-испытателю, а все остальные будут пользоваться старым и надёжным.

## От знания к действию

Отлично, теперь мы знаем, *что* умеет делать наш ИИ-агент (это `Инструменты` в меню) и *как* он это делает (с помощью `Действий`-рецептов на кухне).

Но как принимается заказ? Как он попадает на кухню? И кто следит, чтобы всё приготовилось вовремя? Об этом — в следующей части нашего приключения!

Читай дальше: [004: Агент/Вызов](./004_agent_call.md).