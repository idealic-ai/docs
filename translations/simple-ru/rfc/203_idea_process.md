# 203: Идея/Процесс

> **Идея-Процесс:** Это как волшебная книга рецептов, в которой записан не только сам стратегический [План](./012_agent_plan.md), но и то, на каком шаге приготовления мы сейчас находимся. Её `схема` — это все доступные нам «кухонные инструменты» ([Инструменты](./002_agent_tool.md)). Её `решение` — это *новый* `План` на следующий шажок. А её `контекст` хранит исходный заказ (`Входные данные`), текущее состояние блюда (`Состояние`) и предыдущий `План`.
>
> — [Глоссарий](./000_glossary.md)



В то время как [202: Идея/Носитель](./202_idea_vessel.md) — это одно мгновенное решение, **Идея-Процесс** — это целый продуманный пошаговый план действий. Это как сборник рецептов, который создаёт система [012: Агент/План](./012_agent_plan.md), чтобы выполнить сложную задачу, состоящую из многих шагов. В ней записано всё: и что агент умеет делать, и какой именно путь он выбрал.

## Анатомия Плана

Идея-Процесс — это полный «снимок» рабочего процесса. Этот снимок содержит не только выбранную агентом стратегию (`План`), но и весь набор его возможностей и текущее состояние дел.

Представь, что агент — это повар, который готовит сложное блюдо:

- **`схема` (Палитра):** Это как кладовка на кухне. В ней перечислены все доступные [Инструменты](./002_agent_tool.md), из которых можно составить `План`. Это полный набор всего, что умеет делать агент.

- **`решение` (Новый План):** Это последовательность шагов ([Вызовов](./004_agent_call.md)), которую агент-повар решил выполнить *прямо сейчас*. Этот маленький план становится «запиской на будущее» для следующего шага.

- **`контекст` (Обстановка):** Здесь хранится вся информация, чтобы агент мог понять, что делать дальше. Это как кухонный стол, где всё под рукой.
  - **Исходный Заказ:** Первоначальная задача, которая запустила весь процесс. Например, «приготовить торт». Обычно она не меняется.



  - **Текущее Состояние Блюда:** Это живые, меняющиеся данные о процессе. Например, «яйца смешаны с мукой». Эти данные связывают между собой разные шаги `Плана`.



  - **Записка о Предыдущем Шаге:** Здесь хранится план, который был выполнен на предыдущем шаге. Агент может решить следовать ему дальше или изменить его.



### Единство Планирования и Исполнения

Главный секрет этой системы в том, что планирование и действие — это одно и то же. Они происходят одновременно на каждом шаге. Агент не составляет сначала длинный план, а потом слепо ему следует. Сам процесс создания `решения` (нового `Плана`) — это *и есть* выполнение текущего шага.

Это делает систему очень быстрой и гибкой. План — это живая схема, которая постоянно меняется и адаптируется. `Вызовы`, которые генерирует ИИ, — это одновременно и структура плана, и сами действия. Один запрос к ИИ может одновременно проверить текущее состояние, изменить план на основе новых данных и выполнить следующий логический шаг. Не нужно тратить время на отдельное перепланирование — исполнение *и есть* проверка, планирование и корректировка, всё в одном.



Такой подход даёт два больших преимущества. Во-первых, можно придумать и «проиграть» план ещё до того, как появятся реальные данные. ИИ может представить, как будет работать каждый шаг. Во-вторых, ИИ работает как умный переходник между шагами. Если результат одного шага не совсем подходит для следующего, ИИ может это исправить. Это делает систему очень надёжной и спасает от ошибок, которые часто случаются в обычных системах, где всё жёстко связано.



### Спектр Гибкости Плана

Благодаря объекту `Состояние` план может развиваться и проходить три стадии: от свободного творчества до чёткого и предсказуемого алгоритма.

1.  **Свободный План:** Вначале агент похож на художника-экспериментатора. Он может пробовать разные пути и создавать новые связи между шагами, чтобы найти лучший `План`.

2.  **План с Указаниями:** Следующий шаг — закрепить основные пути передачи данных. Это можно сделать по-разному:
    - **Открытые Связи:** Можно определить главные пути, но позволить агенту создавать новые, если это понадобится для редких случаев.
    - **Закрытые Связи:** Можно создать жёсткую структуру, которой агент должен строго следовать.

3.  **Утверждённый План:** Это финальная стадия, когда план считается полностью готовым и предсказуемым. Такой план передаётся на следующие шаги как «Окончательный План». Он может быть двух видов:
    - **«Удачный» План:** Описывает идеальный сценарий. Он очень эффективен, но может потребовать изменений, если что-то пойдёт не так.
    - **«Полный» План:** Проверенный временем план, который учитывает возможные сбои и альтернативные пути, что делает его максимально надёжным.

Такая эволюция позволяет Идее-Процессу превращаться из гибкого наброска в надёжный и многоразовый инструмент.

## Неизменяемые Процессы: Управление, Анализ и Масштабирование

Сила Идеи-Процесса в её **неизменности**. Каждый шаг создаёт новый, полный «снимок» `Плана` и `Состояния`. Это как если бы мы фотографировали кухню после каждого действия. Так у нас остаётся идеальная, подробная история всего процесса. Эта идея «цепочки снимков» даёт суперспособности для управления, анализа и масштабирования.

- **Надёжное, Адаптивное Исполнение:** Цикл выполнения по шагам очень надёжен, потому что каждый новый шаг начинается с полного «снимка» предыдущего состояния. Это предотвращает путаницу и гарантирует, что агент принимает решения, основываясь на точной картине мира. Результат каждого шага — новая Идея-Процесс, которая безопасно двигает работу вперёд.



- **Устойчивое Управление:** Идея-Процесс — это самодостаточный «файл», который делает управление процессами очень надёжным. Работу можно поставить на паузу, просто сохранив последний «снимок». Внешние системы или люди могут изучить это замороженное состояние и принять решение. Любые изменения создают *новую* Идею-Процесс, позволяя безопасно возобновить работу, не меняя историю.



- **Точное Моделирование:** Эта система — настоящая машина времени. Каждая сохранённая Идея-Процесс — это идеальный снимок процесса в определённый момент. Это позволяет пользователям или другим агентам «переместиться» в любую точку прошлого, чтобы проверить, как всё работало, найти ошибки или запустить сценарий «а что, если?..» с этого момента.



- **Последовательная Пакетная Обработка:** Подход со «снимками» помогает, когда нужно выполнить одну и ту же задачу много раз (например, обработать 100 анкет). `План` работает как шаблон, который применяется к каждой анкете. Поскольку и `План`, и начальное `Состояние` каждой анкеты — это чёткие «снимки», агент может обработать всю пачку за один шаг, гарантируя одинаковый и предсказуемый результат для всех.



## От Предсказуемого Плана к Управляемому Исполнению

Идея-Процесс может превратиться в **«Утверждённый План»** — очень предсказуемый и надёжный процесс. Но строгость ограничивает гибкость. Нужен способ давать плану небольшие подсказки, не ломая его проверенную структуру.

Эту роль выполняет **[Идея-Инструкция](./204_idea_instruction.md)**. `Инструкция` — это структурированный совет, который можно применить к стабильному `Процессу`. Вместо того чтобы менять сам план, она даёт точечное указание для конкретного выбора *внутри* этого плана. Например, инструкция может подсказать, как рассуждать на определённом шаге, или повлиять на решение в одной из точек схемы. Это позволяет улучшать *логику* процесса, сохраняя его надёжность.


