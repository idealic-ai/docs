# 203: Идея/Процесс

> **Идея-Процесс:** Это как отдельная [Идея](./101_concept_idea.md), которая содержит в себе и стратегический [План](./012_agent_plan.md), и то, как он выполняется прямо сейчас. Её «схема» — это набор всех доступных [Инструментов](./002_agent_tool.md), «решение» — это _новый_ `План` на следующий шаг, а «контекст» хранит исходную задачу, текущее состояние и предыдущий `План`.
>
> — [Словарь](./000_glossary.md)

> Sidenote:
> - Требуется:
>   - [101: Концепция/Идея](./101_concept_idea.md)
>   - [012: Агент/План](./012_agent_plan.md)
>   - [010: Агент/Состояние](./010_agent_state.md)
>   - [007: Агент/Входные данные](./007_agent_input.md)
> - Дополняется:
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)

Там, где [Идея-Носитель (202)](./202_idea_vessel.md) — это одно моментальное решение, **Идея-Процесс** — это целый план действий, как рецепт сложного блюда. Она создаётся системой [Планирования (012)](./012_agent_plan.md), когда нужно выполнить большую задачу из нескольких шагов. В итоге получается полная запись: и того, что можно было сделать, и того, как именно система решила действовать.

## Из чего состоит План

`Идея-Процесс` использует тройную структуру `Идеи`, чтобы сделать «фотографию» всего процесса. На этом снимке виден не только выбранный план действий, но и все доступные инструменты, и текущее состояние дел.

- **`schema` (Палитра):** Это как ящик со всеми доступными инструментами или кубиками LEGO, из которых можно построить `План`. Он показывает всё, на что способна система.

- **`solution` (Новый План):** Это последовательность шагов-`Вызовов`, которую система выбрала для выполнения *прямо сейчас*. На следующем шаге этот план станет «Планом из прошлого».

- **`context` (Что происходит вокруг):** Здесь хранится вся информация, нужная для планирования и выполнения текущего шага.
  - **Входное Сообщение:** Та самая первая задача, с которой всё началось. Обычно она даётся один раз и больше не меняется.

    > Sidenote:
    > - [007: Агент/Входные данные](./007_agent_input.md)

  - **Сообщение о Состоянии:** Это данные, которые постоянно обновляются в процессе работы. Представь, что это твоя постройка из LEGO в её нынешнем виде. Они связывают между собой разные шаги `Плана`.

    > Sidenote:
    > - [010: Агент/Состояние](./010_agent_state.md)

  - **Сообщение о Плане:** Здесь хранится план, который был утверждён на *предыдущем* шаге. Система может либо продолжить следовать ему, либо изменить его.

    > Sidenote:
    > - [012: Агент/План](./012_agent_plan.md)

### Единство Плана и Действия

Главный принцип этой системы — объединение планирования и выполнения в один процесс. В обычных системах ты сначала пишешь план, а потом его выполняешь. Здесь же они происходят одновременно на каждом шаге. Система не создаёт сначала огромный план, а затем слепо ему следует. Сам процесс создания следующего шага `Плана` (`solution`) — это и есть *выполнение* текущего шага.

Это единство делает систему очень быстрой и гибкой. `План` — это живая схема, которой не нужно быть завершённой, чтобы быть полезной. Она может быть частичной и меняться прямо на лету, учитывая результаты предыдущего шага. `Вызовы`, которые генерирует ИИ, — это одновременно и структура плана, и команды, которые по нему передаются. Благодаря этому ИИ за один раз может проверить текущее состояние, поправить план и выполнить следующий логический шаг. Нет нужды в отдельных дорогих операциях для перепланирования или проверки — выполнение и есть проверка, планирование и корректировка, всё в одном.

> Sidenote:
> - [004: Агент/Вызов](./004_agent_call.md)

Такая модель даёт два мощных преимущества. Во-первых, `План` можно продумать и «проиграть в уме», даже когда реальных данных ещё нет. ИИ может представить, как будет работать каждый шаг, что позволяет создавать и проверять сложные процессы с самого начала. Во-вторых, ИИ работает как умный переходник между шагами. Если результат одного `Вызова` не совсем подходит для входа другого, ИИ может «сгладить углы» и исправить данные. Это делает систему невероятно устойчивой и защищает от ошибок, которые часто ломают обычные, жёстко связанные системы.

> Sidenote:
> - [105: Концепция/ИИ-центричность](./105_concept_ai_native.md)

### Разные стадии гибкости Плана

Благодаря объекту `Состояния`, `План` может пройти три стадии жизни, превращаясь из гибкого наброска в предсказуемый и надёжный процесс:

1.  **Свободный План:** Вначале `Состояние` можно не описывать строгими правилами (`schema`). Это даёт системе максимум свободы, чтобы найти подходящий `План`, создавая новые связи между шагами на лету.

2.  **План с правилами:** Следующий шаг — «заморозить» правила для `Состояния`, то есть определить основные пути для данных. Это можно сделать с разной степенью строгости:
    - **Открытые связи:** Можно разрешить создавать дополнительные связи (`additionalProperties`), если понадобятся. Основные пути будут заданы, но останется место для творчества.
    - **Закрытые связи:** Можно запретить любые отклонения (`additionalProperties` в `false`). Это создаст жёсткую структуру, которой система должна будет строго следовать.

3.  **Завершённый План:** Это финальная стадия, когда план считается полностью продуманным и предсказуемым. Такой План становится **Утверждённым Планом**, который передаётся для выполнения на следующих шагах. Он бывает двух видов:
    - **«Счастливый» План:** План, который описывает идеальный сценарий. Он очень эффективен, но может потребовать корректировки, если что-то пойдёт не так.
    - **Полный План:** План, который со временем дополнили решениями для частых ошибок, альтернативными путями и другими сценариями, что делает его почти на 100% предсказуемым.

Такое развитие позволяет `Идее-Процессу` вырасти из простого наброска в очень надёжный и полезный инструмент.

## Неизменяемые процессы: Управление, Анализ и Масштабирование

Сила `Идеи-Процесса` в её неизменяемости. Представь, что после каждого шага ты делаешь «фотографию» всего процесса (`Плана` и `Состояния`). У тебя остаётся идеальная история всех действий, которую можно проверить. Этот принцип создания цепочки неизменяемых снимков открывает самые крутые возможности системы.

- **Надёжное и гибкое выполнение:** Пошаговое выполнение очень надёжно, потому что каждый новый шаг начинается с полного снимка предыдущего состояния. Это защищает от путаницы и гарантирует, что решение системы следовать плану или изменить его основано на понятной картине мира. Результат каждого шага — это новая `Идея-Процесс`, безопасно продвигающая работу вперёд.

  > Sidenote:
  > - [005: Агент/Цикл](./005_agent_loop.md)
  > - [012: Агент/План](./012_agent_plan.md)

- **Устойчивое управление:** `Идея-Процесс` — это самодостаточный объект, что делает управление процессами очень надёжным. Работу можно остановить, просто сохранив её последний снимок. Другие системы или люди могут изучить это «замороженное» состояние и принять решение. Любые изменения, например, перепланирование, создают *новую* `Идею-Процесс`, позволяя безопасно возобновить работу, не меняя историю.

  > Sidenote:
  > - [010: Агент/Состояние](./010_agent_state.md)

- **«Путешествия во времени»:** Эта архитектура позволяет буквально путешествовать во времени по процессу. Каждая сохранённая `Идея-Процесс` — это идеальный снимок в определённый момент. Это позволяет пользователям или другим системам загрузить любую точку из прошлого, чтобы проверить, что пошло не так, или запустить сценарий «а что, если?..», создав новую ветку процесса с этого момента.

  > Sidenote:
  > - [202: Идея/Носитель](./202_idea_vessel.md)

- **Массовая обработка:** Подход со снимками гарантирует, что при обработке множества задач всё будет работать одинаково. `План` действует как шаблон, который применяется к разным наборам данных (`Состояний`). Поскольку и `План`, и начальное `Состояние` для каждой задачи — это чёткие снимки, система может обработать всю партию за один шаг, гарантируя одинаковый и предсказуемый результат для всех.

  > Sidenote:
  > - [011: Агент/Инстансинг](./011_agent_instancing.md)

## От предсказуемого Плана к управляемому выполнению

`Идея-Процесс` может превратиться в **Завершённый План** — очень предсказуемый и надёжный процесс. Но такая жёсткость может мешать гибкости. Нужен способ давать небольшие подсказки, не ломая при этом устоявшийся план.

Эту роль выполняет **[Идея-Инструкция](./204_idea_instruction.md)**. `Инструкция` — это рецепт для действия, который можно применить к стабильному `Процессу`. Вместо того чтобы менять структуру плана, она даёт точечные указания для отдельных шагов *внутри* этого плана. `Инструкция` может направить рассуждения в нужную сторону, добавить проверку или повлиять на решение в конкретной точке, давая дополнительный контроль, но сохраняя надёжность всего плана. Она улучшает логику процесса, а не просто последовательность его действий.

> Sidenote:
> - [204: Идея/Инструкция](./204_idea_instruction.md)
