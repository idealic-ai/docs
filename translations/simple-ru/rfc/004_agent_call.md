# 004: Агент/Вызов

> **Вызов:** Это как готовая к выполнению инструкция для `Инструмента`, в которой уже заполнены все нужные детали. Это конкретная просьба о том, что _нужно сделать_.
>
> — [Глоссарий](./000_glossary.md)

> Sidenote:
>
> - Требует:
>   - [103: Концепция/Идеатор](./103_concept_ideator.md)
> - Открывает возможности для:
>   - [008: Агент/Импорты](./008_agent_imports.md)
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)
>   - [202: Идея/Контейнер](./202_idea_vessel.md)
>   - [203: Идея/Процесс](./203_idea_process.md)

Документ [101: Концепция/Идея](./101_concept_idea.md) рассказал нам об «Идеях» — умных контейнерах для знаний. А [002: Агент/Инструмент](./002_agent_tool.md) объяснил, как эти Идеи превращаются в «Инструменты», которые ИИ-агент может понять и использовать. Теперь мы поговорим о **Вызове** — это команда, которая заставляет Инструменты работать.

Представь, что Инструмент — это рецепт торта. В нём написано, *что можно* испечь и какие ингредиенты для этого нужны. А **Вызов** — это когда ты берёшь этот рецепт и говоришь: «Испеки шоколадный торт, положив 200 грамм сахара и 3 яйца». Это уже не просто рецепт, а конкретная, готовая к исполнению команда.

## Путь от Идеи к Вызову

Всё происходит в три шага:

1.  **Идея**: Сначала есть просто мысль или знание. Например, «как построить домик из LEGO».
2.  **Инструмент**: Эта мысль превращается в инструкцию с пустыми полями. Например, «инструкция по постройке домика из <количество> кубиков <такого-то> цвета». Теперь агент знает, *что* он может сделать.
3.  **Вызов**: Когда ИИ-агент решает использовать этот Инструмент, он заполняет все пустые поля. Например: «построй домик из 100 красных кубиков». Это и есть **Вызов** — одна-единственная, полностью готовая команда.

Главный принцип: **любая Идея может стать Инструментом, который можно запустить с помощью Вызова.**

Чтобы узнать подробнее, как именно Идея превращается в Инструмент, загляни в документ **[007: Агент/Ввод](./007_agent_input.md)**.

## Управление выполнением: Область и Метод

У каждого Вызова есть две важные настройки, которые решают, как он будет выполнен: **Область** (где он сработает) и **Метод** (как он сработает).

### Две оси выполнения

1.  **Область (Внутри или Снаружи)**
    Область определяет, будет ли задача выполнена прямо здесь и сейчас, или её поручат кому-то другому.
    - **Встроенная Область**: Это как делать работу самому. Вызов выполняется немедленно, в текущем процессе.
    - **Модульная Область**: Это как попросить друга помочь. Вызов передаётся в отдельный, изолированный модуль, чтобы он не мешал основной работе. Для этого используется специальный параметр `_module`.

2.  **Метод (Чёткий или Творческий)**
    Метод определяет, будет ли результат получен по строгим правилам или с помощью «воображения» ИИ.
    - **Явный Метод**: Это как следовать рецепту. Результат всегда предсказуем, потому что он создаётся чётким кодом. Для этого используется параметр `_activity`.
    - **Скрытый Метод**: Это как рисовать картину. Нет точных шагов. ИИ сам придумывает результат. Для этого используется параметр `_output`, который подсказывает, что примерно должно получиться.

Эти настройки можно смешивать, создавая разные способы выполнения задач. Подробнее о том, как они сочетаются, читай в документе **[008: Агент/Импорты](./008_agent_imports.md)**.

## Создание сложных сценариев

Вызов — это маленький кирпичик, из которого можно строить большие и сложные проекты. Например, с помощью Вызовов можно запустить такие большие Идеи, как **[202: Идея/Контейнер](./202_idea_vessel.md)** или **[203: Идея/Процесс](./203_idea_process.md)**.

Представь, что «Контейнер» — это целая миссия для агента. В ней есть всё: описание ситуации (`context`), список доступных Инструментов (`schema`) и ответ агента — решение (`solution`), которое состоит из одного или нескольких Вызовов, которые нужно выполнить.

> Sidenote:
>
> - [202: Идея/Контейнер](./202_idea_vessel.md)
> - [203: Идея/Процесс](./203_idea_process.md)

## Способы выполнения Вызовов

Когда агент создаёт сразу несколько Вызовов (как список дел), их можно выполнить по-разному, в зависимости от задачи:

```typescript
// Выполнить один Вызов
const result = await Tool(call);

// Запустить все Вызовы и дождаться, пока все завершатся
const results = await Tool.all(calls);

// Запустить все Вызовы и вернуть результат первого успешного
const result = await Tool.any(calls);

// Запустить все Вызовы и вернуть результат самого первого, который завершится (неважно, успешно или нет)
const result = await Tool.race(calls);
```

Эти способы позволяют:

- **Точно всё контролировать**: Выполнять Вызовы по одному, делая что-то между ними.
- **Делать всё сразу**: Запускать независимые Вызовы одновременно, чтобы сэкономить время.
- **Находить быстрые решения**: Останавливаться, как только найдётся первый успешный результат (`.any()`).
- **Действовать по принципу «всё или ничего»**: Убедиться, что все связанные задачи выполнены успешно (`.all()`), чтобы избежать ошибок.