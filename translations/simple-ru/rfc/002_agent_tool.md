# 002: Агент/Инструмент

> **Инструмент**: Это как чертёж или инструкция для какой-нибудь суперспособности, которую может использовать агент (умный помощник). Эту инструкцию показывают большому искусственному интеллекту (LLM), чтобы он понял, что можно сделать. ИИ активирует инструмент, создавая «Вызов» с нужными данными. Этот вызов выполняется либо «в уме» самим ИИ, либо с помощью настоящей программы («Действия»). — [Глоссарий](./000_glossary.md)

> Sidenote: - Требуется: [001: Агент/Запрос](./001_agent_request.md)
> - Дополняется: [003: Агент/Действие](./003_agent_activity.md)

Этот документ описывает Инструмент — своего рода шаблон, который помогает агентам понимать и использовать разные способности.

## Что такое Инструменты?

**Инструменты — это как кубики LEGO** для системы действий агента. Они дают ему новую крутую возможность: **выбирать, что делать, прямо по ходу дела**. Это позволяет агентам подбирать правильное поведение в зависимости от ситуации.

Что дают Инструменты:

- **Понятные инструкции**: Чётко описанные способности, которые агенты могут найти и понять.
- **Надёжность**: Понятные правила о том, какие данные нужны на входе и что получится на выходе.
- **Сочетаемость**: Это как строительные блоки, из которых можно собирать сложное поведение агента.
- **Понятность для ИИ**: Инструкции, которые языковая модель (мозг агента) может проанализировать и выбрать нужную.

Когда агент заполняет все поля для какого-то Инструмента, он создаёт **Вызов** — это как бы «заявка на использование» Инструмента со всеми нужными данными, готовая к выполнению (подробнее о выполнении читай в документе [004: Агент/Вызов](./004_agent_call.md)).

> **Примечание**: Хотя любой запрос к ИИ можно представить как Идею (и это хорошо работает для простых задач), Инструменты нужны для более сложных случаев, когда нужно выбирать действие на лету. О том, как Идеи могут превращаться в Инструменты, читай в документе [007: Агент/Входные данные](./007_agent_input.md).

## Когда использовать систему Инструментов

Используй систему Инструментов, когда хочешь, чтобы агенты:

- **Выбирали действия на лету**, исходя из ситуации.
- **Могли выбирать из нескольких разных способностей** для достижения цели.
- **Использовали разные способы** для выполнения одной и той же задачи (например, искали информацию через разные поисковики).
- **Сочетали размышления ИИ с чёткой логикой** при принятии решений.

## Как устроена система Инструментов

### Главный принцип: Инструкция — это интерфейс

Система Инструментов построена на простом правиле: **Инструменты — это всего лишь инструкции (схемы)**, которые описывают, *что* можно сделать, но не *как* это делать. За выполнение отвечает либо сам ИИ «в уме», либо отдельная программа под названием **[Действие](./003_agent_activity.md)**.

Инструкция (схема) Инструмента описывает:

> Sidenote: Расширения:
>
> - [010: Агент/Состояние](./011_agent_state.md)
>   - `_outputPath`
> - [011: Агент/Инстансинг](./011_agent_instancing.md)
>   - `_instance`
> - [009: Агент/Модуль](./009_agent_module.md)
>   - `_module`

- **Что инструмент делает** (в поле `description`)
- **Что ему нужно** (параметры для ввода)
- **Что он выдаёт в результате** (структура `_output`)
- **Как он называется** (имя в `_tool`)
- **Как он выполняется** (поле `_activity`, подробнее в [003: Агент/Действие](./003_agent_activity.md))

### Служебные поля в схеме Инструмента

В схемах Инструментов используются специальные «служебные» поля (они начинаются с подчёркивания), чтобы описать системные свойства:

- **_tool**: Уникальное имя инструмента (обязательно).
- **_activity**: Указывает, какое «Действие» должно выполнить этот инструмент. Подробнее о том, как оно выбирается, читай в [003: Агент/Действие](./003_agent_activity.md).
- **_output**: Описание того, что мы ожидаем получить в результате (система делает это поле необязательным).
- **_reasoningForCall**: Объяснение от агента, почему он решил сделать этот Вызов (добавляется системой).

Любое поле без подчёркивания считается обычным параметром инструмента. Служебные поля всегда идут первыми, чтобы ИИ было проще и понятнее их читать.

### Границы системы

Система Инструментов отвечает за:

- Регистрацию Инструментов (хранение их инструкций).
- Заполнение параметров (ИИ сам достаёт нужные данные из контекста).
- Направление на выполнение (решает, будет ли ИИ выполнять задачу «в уме» или передаст её «Действию»).

Более сложные вещи, вроде управления задачами или состоянием, строятся поверх этих базовых функций (например, в системе [Вызовов](./004_agent_call.md)).

## Описание Инструмента

Инструменты описываются с помощью JSON-схем. Это такой способ записать правила в понятном для компьютера формате. Ниже пример Инструмента для анализа тональности текста. Он рассчитан на то, что его выполнит сам ИИ «в уме», потому что языковые модели отлично с этим справляются и не требуют отдельной программы.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует тональность текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Объединение схем и Вызов

Один инструмент — это хорошо, но настоящая магия начинается, когда их много. Система показывает ИИ все доступные Инструменты сразу, как будто даёт ему целый ящик с инструментами. Это позволяет ИИ выбрать самый подходящий для конкретной задачи. Когда ИИ выбрал Инструмент и заполнил нужные поля, он создаёт **Вызов** — готовую к выполнению «заявку». Этот Вызов и есть та единица действия, которая передаётся дальше на исполнение.

> Sidenote: - [004: Агент/Вызов](./004_agent_call.md).

## «Скрытое» и «Явное» выполнение

Сам по себе Инструмент — это просто инструкция. А вот выполнить его можно двумя способами. Первый — **«скрытое» выполнение**: это когда ИИ использует свои внутренние знания, чтобы выдать результат. Идеально для задач, связанных с языком или знаниями. Второй способ — для действий, которые требуют взаимодействия с внешним миром: например, отправить запрос в интернет или посмотреть что-то в базе данных. Для этого Инструмент нужно связать с настоящей программой. Такое явное выполнение называется **Действие**.

Разделение инструкции (Инструмент) и исполнителя (Действие) — это ключевая идея. Она позволяет агенту «думать» о своих способностях в общем, а то, как именно они выполняются, можно менять или обновлять отдельно. В следующем документе, **[003: Агент/Действие](./003_agent_activity.md)**, мы как раз и поговорим о том, как «Действия» дают Инструментам реальную силу.

> Sidenote: - [003: Агент/Действие](./003_agent_activity.md).
