# 002: Агент/Инструмент

> **Инструмент**: Это как схема или инструкция, которая описывает какое-то умение агента. Эту инструкцию показывают большой языковой модели (LLM), чтобы она поняла, какие действия можно совершить. LLM активирует инструмент, создавая `Вызов` (Call) с нужными параметрами. Этот вызов потом выполняется либо «в уме» самой LLM, либо с помощью специального кода (`Действие`). — [Глоссарий](./000_glossary.md)

> Sidenote: Связан с: [001: Агент/Запрос](./001_agent_request.md) <br> Дополняется: [003: Агент/Действие](./003_agent_activity.md)

Этот документ описывает Инструмент — базовую «схему», с помощью которой агенты понимают и используют разные возможности.

## Что такое Инструменты?

**Инструменты — это основа** для всех действий агента. Они дают ему новую суперспособность: **выбирать правильное действие в зависимости от ситуации**. Это как если бы у тебя был пояс с кучей гаджетов, и ты бы всегда знал, какой из них достать в нужный момент.

Инструменты обеспечивают:

- **Структурированные интерфейсы**: Понятные инструкции, которые агенты могут изучить и понять.
- **Надёжность**: Чёткие правила, что подавать на вход и что ожидать на выходе.
- **Компонуемость**: Они как кубики LEGO, из которых можно строить сложное поведение агента.
- **Интеграция с LLM**: Схемы, которые языковая модель может анализировать и выбирать.

Когда агент заполняет нужные параметры для Инструмента, он создаёт **Вызов** (Call) — это как бы полностью заполненная заявка на выполнение действия (подробнее об этом в [004: Агент/Вызов](./004_agent_call.md)).

## Когда использовать систему Инструментов

Используйте систему Инструментов, когда вам нужно, чтобы агенты:

- **Выбирали действия на лету**, в зависимости от того, что происходит.
- **Выбирали из нескольких вариантов**, чтобы достичь цели.
- **Использовали разные способы** для выполнения одной и той же задачи (например, разные поисковые системы).
- **Сочетали «мышление» LLM и чёткую логику кода** при принятии решений.

## Архитектура системы Инструментов

### Главный принцип: Схема как интерфейс

Система Инструментов построена на одном простом правиле: **Инструменты — это просто описание того, «что» делать, а не «как»**. Представьте себе чертёж розетки: он показывает, куда вставлять вилку (это интерфейс), но не говорит, откуда берётся электричество (это реализация). Выполнением занимается либо «скрытое» мышление LLM, либо конкретный код, который называется [Действие (Activity)](./003_agent_activity.md).

> Sidenote: Представьте `Инструмент` как анкету. Обычные поля — это вопросы, которые нужно заполнить. А поля, начинающиеся с `_`, — это служебные заметки для системы, которые говорят ей, как обращаться с этой анкетой.

Схема `Инструмента` — это стандартное описание в формате JSON Schema. Любое поле без знака подчёркивания (`_`) в начале — это параметр, который нужно заполнить. А поля, которые начинаются с `_`, — это служебные «заметки на полях», которые помогают системе понять, что это за инструмент и как с ним работать.

Схема Инструмента полностью описывает его интерфейс:

- **`title`**: Понятное человеку название схемы.
- **`description`**: Объяснение, что делает инструмент.
- **`parameters`**: Любые поля без подчёркивания, которые описывают входные данные.
- **`_tool`**: Уникальное имя для опознания инструмента, как ярлычок.
- **`_output`**: Описывает, как должен выглядеть результат работы инструмента.
- **`_reasoningForCall`**: Поле, которое система добавляет, чтобы агент мог объяснить, почему он выбрал именно этот инструмент.

### Границы системы

Система Инструментов отвечает за:

- **Регистрацию Инструментов** (определение и хранение схем)
- **Заполнение параметров** (LLM сама извлекает нужные данные из контекста)
- **Скрытое выполнение** (когда LLM сама придумывает результат на основе входных данных)

Более сложные вещи, такие как управление задачами, состоянием и правилами выполнения, строятся поверх этих базовых функций с помощью других протоколов (например, [004: Агент/Вызов](./004_agent_call.md)).

## Определение Инструмента

Инструменты описываются с помощью JSON-схем. Пример ниже показывает `Инструмент` для анализа тональности текста. Этот `Инструмент` рассчитан на скрытое выполнение, так как он полагается на встроенное понимание языка LLM и не требует внешней функции.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Analyzes text sentiment',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Text to analyze' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Комбинация схем и Вызов

Хотя каждый Инструмент — это отдельная возможность, их настоящая сила — в комбинации. Система показывает языковой модели сразу все доступные `Инструменты`, как меню в ресторане. Модель изучает ситуацию и выбирает самый подходящий «пункт меню». Когда она выбрала инструмент и добавила все нужные детали (например, какой текст проанализировать), она создаёт **Вызов** (Call). Этот `Вызов` — это уже готовый к исполнению «заказ».

> Sidenote: Подробнее о `Вызове` можно прочитать в документе [004: Агент/Вызов](./004_agent_call.md).

## Скрытое и Явное выполнение

Схема `Инструмента` — это только описание. А вот выполнить его можно двумя способами. Первый — **скрытое выполнение**: это когда языковая модель выполняет задачу «в уме», используя свои знания. Например, отвечает на вопрос или анализирует текст. Второй способ нужен для действий во внешнем мире, например, чтобы проверить погоду на сайте. Для этого `Инструмент` нужно подключить к настоящей программе. Такое «явное» выполнение с помощью кода называется **Действием** (Activity).

Разделение интерфейса `Инструмента` от его реализации в `Действии` — это ключевой принцип. Это позволяет агенту думать о своих возможностях в общем (что он может сделать), а то, как именно это делается, можно менять, не трогая сам инструмент. Это как патрон для лампочки (`Инструмент`): он всегда один и тот же, а саму лампочку (`Действие`) можно вкрутить любую — светодиодную или обычную. Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, подробно описывает, как `Действия` обеспечивают конкретную логику для `Инструментов`.