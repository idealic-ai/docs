# 301: Идеатор/Хранилище

## 1. Введение

Этот документ описывает **Систему: Хранилище** — это как главная библиотека для всей экосистемы Идей. Представь его как особого **Преобразователя Идей**, чья главная задача — быть надёжным хранилищем для `Идей`, где у каждой есть свой уникальный адрес. Это как цифровой сейф.

Это основа для памяти и воспоминаний системы, позволяющая сохранять `Идеи` и создавать их разные версии, чтобы потом другие сервисы, например [Система: Распознаватель](./202_ideator_resolver.md), могли их использовать.

## 2. Основная концепция: Хранилище как Преобразователь Идей

Сервис Хранилища работает по принципу `Преобразователя Идей`: он принимает одну `Идею` на вход и возвращает другую `Идею` на выход.

- **Вход**: Обычная `Идея`, состоящая из трёх частей (`схема`, `решение`, `контекст`).
- **Процесс**: Сервис получает `Идею`, даёт ей уникальный номер (как инвентарный номер в библиотеке), который включает в себя и номер версии, а затем надёжно сохраняет её в своей базе данных (например, в PostgreSQL).
- **Выход**: В ответ сервис возвращает ту же самую `Идею`, но с добавленной информацией — например, с её новым уникальным номером и версией. Это как квитанция, подтверждающая, что `Идея` успешно сохранена.

## 3. Ключевые особенности

### 3.1. Хранение по принципу «чёрного ящика»

Хранилище работает как «чёрный ящик». Ты просто отправляешь `Идею` на сохранение, и тебе не нужно знать, как именно она хранится — в какой базе данных, на каком диске и так далее. Это как положить деньги в банк: ты не знаешь, в каком именно сейфе они лежат, но ты уверен, что банк их сохранит. Сервис гарантирует, что если он принял `Идею`, то она будет в безопасности и доступна.

### 3.2. Версии и неизменность

Система построена на принципе неизменности. Это значит, что однажды сохранённую `Идею` нельзя изменить. Когда ты «обновляешь» `Идею`, сервис не перезаписывает старую. Вместо этого он создаёт и сохраняет её новую версию. Это как черновики в документе: у тебя всегда есть доступ ко всем предыдущим версиям, и история правок никогда не теряется. Благодаря этому, ссылка на определённую версию `Идеи` всегда будет указывать на одно и то же содержимое. Ты можешь сослаться как на конкретную старую версию, так и на самую последнюю (`latest`).

### 3.3. Адресация по содержимому

Хотя точный способ адресации — это внутренняя деталь, главный принцип в том, что у каждой сохранённой `Идеи` есть свой уникальный номер, как отпечаток пальца. Это позволяет очень точно и надёжно ссылаться на любую `Идею` из любого места.

## 4. Публичный интерфейс

Интерфейс Хранилища очень простой и создан только для одной цели — записи данных.

- **Основное взаимодействие**: Единственное, что ты можешь сделать — это отправить `Идею` на сохранение.

- **Отделение от чтения**: Чтобы всё было просто и понятно, Хранилище не позволяет тебе запрашивать или искать `Идеи`. Оно работает как почтовый ящик, в который можно только опускать письма, но не доставать их. Задачу по поиску и получению `Идей` выполняет другой сервис — **Распознаватель**. Так каждый сервис занимается своим делом: Хранилище отвечает за надёжное сохранение, а Распознаватель — за поиск и предоставление `Идей`.