# 301: Идеатор/Хранилище

## 1. Введение

Этот документ описывает **Систему: Хранилище** — очень важного помощника в нашей вселенной Идей. Представь, что Хранилище — это как супернадёжная библиотека для `Идей`. Его главная задача — сохранять все `Идеи` так, чтобы они никогда не потерялись и их всегда можно было найти. Это наша память, которая позволяет другим помощникам, например [Системе: Распознавателю](./202_ideator_resolver.md), находить и использовать эти `Идеи` в будущем.

## 2. Основная идея: Хранилище как Превращатель Идей

Хранилище работает как волшебная коробка, которую мы называем `Превращатель Идей`: ты кладёшь в неё `Идею`, а она возвращает тебе её же, но уже в целости и сохранности.

- **Что кладём внутрь (Вход)**: Любую `Идею`, которая состоит из трёх частей: `schema` (это как чертёж), `solution` (это само решение) и `context` (это объяснение, где и как её использовать).
- **Что происходит внутри (Процесс)**: Сервис берёт `Идею`, даёт ей уникальный адрес (как номер дома), по которому её всегда можно будет найти, и аккуратно кладёт её в очень надёжное место (например, в специальную базу данных `PostgreSQL`). В адресе также указана версия, как в обновлениях для игр.
- **Что получаем обратно (Выход)**: Сервис возвращает тебе твою же `Идею`, как бы говоря: «Всё в порядке, я её сохранил!». К ней может быть прикреплена записка с её новым адресом и номером версии.

## 3. Ключевые особенности

### 3.1. Сохранение по принципу «чёрного ящика»

Представь себе почтовый ящик. Ты опускаешь в него письмо (`Идею`), и почта сама решает, как его доставить. Тебе не нужно знать, на какой машине его повезут или в каком мешке оно будет лежать. Ты просто знаешь, что оно доберётся до места. Наше Хранилище — это такой же «чёрный ящик». Ты просто отдаёшь ему `Идею`, и оно гарантирует, что она будет в безопасности и доступна. А как именно оно это делает — это его маленький секрет.

### 3.2. Версии и Неизменность

Это как страницы в книге истории. Ты не можешь вернуться назад и переписать прошлое. Вместо этого ты добавляешь новую страницу и пишешь, что произошло дальше. Всё, что было записано раньше, остаётся без изменений.

Когда ты «обновляешь» `Идею`, старая версия никуда не исчезает. Хранилище просто создаёт новую версию рядом со старой. Так сохраняется вся история изменений, и можно в любой момент посмотреть, какой `Идея` была раньше. Ты можешь попросить показать тебе конкретную версию, например «версию номер 5», или просто самую последнюю (`latest`).

### 3.3. Адрес по содержимому

У каждой сохранённой `Идеи` есть свой уникальный адрес, как отпечаток пальца. Этот адрес создаётся на основе того, что у `Идеи` внутри. Это значит, что если две `Идеи` абсолютно одинаковы, у них будет и одинаковый адрес. Это помогает нам быть уверенными, что мы всегда найдём именно ту `Идею`, которую ищем, и ничего не перепутаем.

## 4. Как с ним общаться

Общаться с Хранилищем очень просто. Представь, что это окошко для приёма заказов, которое работает по строгим правилам.

- **Основное действие**: Единственное, что ты можешь сделать через это окошко, — это отдать свою `Идею` на хранение. Оно работает только на приём.

- **Отделение от получения данных**: Чтобы у каждого была своя работа и никто не путался, Хранилище не выдаёт `Идеи` обратно. Оно только сохраняет. За то, чтобы найти и достать нужную `Идею`, отвечает другой сервис — **Распознаватель**. Это как в большой библиотеке: один работник (Хранилище) расставляет книги по полкам, а другой (Распознаватель) находит их для тебя, когда они тебе понадобятся.