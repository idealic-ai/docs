# 303: Идеатор/Реактор

> **Реактор:** Это особый «Преобразователь Идей», который работает как универсальная игровая приставка для умных компьютерных игроков (агентов). Он смотрит на то, что сейчас происходит в игре («Идея»), и показывает, что случится на следующем ходу (новую «Идею»).
>
> — [Глоссарий](./000_glossary.md)

Этот документ — наш план по превращению старой программы для игры в покер в нечто гораздо большее — в **«Реактор»**. Это будет универсальная система, которую можно расширять. Она будет управлять общением умных компьютерных игроков в реальном времени. Мы превращаем нашу мощную систему из программы для одной-единственной игры в целый язык (протокол), с помощью которого умные и самостоятельные агенты смогут взаимодействовать с любым пошаговым миром. Это может быть игра, где нужно победить, совместный проект или даже сложный рабочий процесс. Реактор станет первым таким «движком» для нашей большой сети идей.

## От Покера к Универсальному Языку

Наша текущая программа для покера отлично работает. Она использует специальные рабочие процессы (Temporal), чтобы управлять целым мирком покерных ботов, которые играют, думают и реагируют на события в казино. Мы уже придумали, как отделить правила игры от самой программы, создав специальный «разъём» (API) для игрового движка. Наш покерный движок — первый, который мы вставили в этот «разъём». Это подготовило почву для будущего, где мы сможем легко подключать и отключать любые игровые движки.

Однако сейчас общение внутри системы всё ещё «заточено» под специальный покерный язык (формат истории покерных раздач). Чтобы по-настоящему раскрыть потенциал нашей системы, мы должны это изменить.

Главная идея этого улучшения — перейти на общение с помощью **«Триады Идей»**. Вместо того чтобы просто отправлять информацию о том, что происходит в игре, каждое сообщение в системе будет как бы целым набором из трёх частей:

1.  **Схема:** Это как инструкция или чертёж для LEGO. Она на универсальном языке JSON Schema объясняет, что значат все данные в игре. Благодаря ей данные описывают сами себя, и в них содержится достаточно информации, чтобы понять, какой ход можно сделать следующим.
2.  **Контекст:** Это дополнительная информация, например, правила игры, подсказки для бота или история прошлых ходов. Контекст помогает правильно понять, что происходит.
3.  **Решение:** Это сама игровая ситуация в данный момент, построенная по инструкции из «Схемы».

Вместе `Schema` и `Solution` создают полный и самодостаточный снимок состояния игры. Само по себе `Solution` — это просто набор данных, как гора кирпичиков LEGO. А `Schema` придаёт ему смысл, объясняя, что это за кирпичики, как они называются и по каким правилам их можно соединять. Этого достаточно, чтобы понять, что можно добавить в игру дальше и как может ответить другой игрок. Это значит, что любая часть системы может понять не только текущую ситуацию, но и возможные следующие ходы, даже не зная правил игры заранее. Важное техническое решение: эта триада будет единственным, что передаётся по главному пути всех наших программ; мы больше не будем пересылать частичные данные.

Это делает «Идею» настоящим строительным блоком, из которого можно создавать сложные, развивающиеся системы. В отличие от простого вопроса чат-боту, который он тут же забывает, «Идея» — это самодостаточный и долгоживущий артефакт. В ней упакованы `входные данные`, `результат` (`solution`), `правила` (`schema`) и весь `контекст`, который был при её создании. Всё это в одной переносимой коробочке. Это не просто вопрос, а вопрос, ответ и вся формула, которая их связывает. Это позволяет создавать надёжные системы, которые помнят прошлое, а не просто выполняют одноразовые команды.

## От Скрытого к Явному: Стратегия «Кристаллизации»

Такая архитектура позволяет нам использовать очень мощный подход. Логика игры может начинаться с гибкого набора **«Скрытых Правил»**, а затем постепенно «кристаллизоваться», превращаясь в чёткий и однозначный набор **«Явных Правил»**. Система по умолчанию работает со Скрытыми Правилами, а Явные Правила — это крутое улучшение, а не обязательное требование.

### 1. Скрытые Правила

Наш главный принцип — начинать с самого сложного случая: с игры, для которой у нас нет готового компьютерного движка. Система по умолчанию должна отлично работать в таком режиме.

Здесь наш большой языковой ИИ (LLM) выступает в роли **«Универсального Переводчика»**. Он становится как бы дилером и судьёй в игре. Он использует `Схему` и `Контекст` из «триады», чтобы понять правила, проверить правильность ходов и двигать игру вперёд. Правила здесь «скрытые» — они содержатся в огромных знаниях самого ИИ и в информации из триады, а не в строчках кода. Базовый «универсальный движок» будет совсем простым: он будет только рассаживать игроков и следить за очередью ходов. Остальное сделает ИИ, что даёт невероятную гибкость.

### 2. Явные Правила

Для игр, где у нас есть специальный движок (как наш покерный), система работает в ускоренном и предсказуемом режиме. Движок предоставляет Явные Правила, которые не заменяют «триаду», а мощно её дополняют. Он выполняет две главные функции:

- **Обеспечение Чёткости и Предсказуемости:** Движок проверяет все ходы по строгим правилам игры, подтверждая, что игрок может сделать в данный момент, и проверяя действия ботов. Это гарантирует честную и предсказуемую игру.

- **Подготовка Контекста:** Движок работает как умный поставщик контекста. Он обогащает часть `Контекст` в «триаде» очень ценной, специфичной для игры информацией. Это может быть статистика о поведении игроков, типичные игровые ситуации и другая аналитика. Такой «подготовленный контекст» позволяет нашим ботам принимать гораздо более умные и стратегические решения.

В этом режиме игровой движок даёт чёткую, прописанную в коде логику, которая служит источником правды и улучшает качество решений наших агентов. Система становится одновременно надёжной и умной.

### 3. От Игры к Правилам: Новый Способ Разработки

Эта стратегия «кристаллизации» от скрытой логики к явной открывает совершенно новый подход к разработке. Вместо того чтобы с нуля писать правила для новой игры, мы сначала будем _играть_ в неё с помощью «Реактора» и его Скрытых Правил.

1.  **Играем (Симулируем):** Мы даём Реактору «триаду», описывающую новую игру (например, домино), даже ту, которую мы только что придумали. ИИ, как универсальный переводчик, начнёт симулировать игру.
2.  **Собираем Данные:** Пока ИИ играет, он создаёт записи ходов, свои рассуждения и множество разных игровых ситуаций.
3.  **Пишем Правила:** Затем мы используем эти богатые данные, полученные в игре, как материал для написания надёжных и проверенных правил, а также полного набора тестов.

Игра предшествует коду и помогает его написать. Мы можем понять и изучить все тонкости и редкие случаи в игре ещё до того, как напишем первую строчку кода для её движка. Это сильно ускоряет разработку и помогает создавать более качественные и продуманные игровые движки.

## Агенты с Долговременной Памятью

Ключевая возможность Реактора в том, что агенты внутри него обладают состоянием, то есть памятью. Это не простые боты, выполняющие одноразовые команды. Поскольку система построена на постоянных процессах, каждый агент может хранить долговременную память о своих действиях.

Агент может помнить, что происходило в прошлых раундах, вспоминать стратегии из совершенно других игр и со временем изучать привычки других игроков. Эта способность помнить — наше главное отличие. Она превращает агентов из простых исполнителей в существ, которые учатся и адаптируются в своей среде. Это позволяет им вести себя гораздо сложнее и стратегичнее, чем в простой модели «вопрос-ответ».

## Что Это Значит для Бизнеса

Такое изменение в архитектуре имеет огромное значение для бизнеса:

- **Быстрое Добавление Нового:** Мы можем предлагать клиентам подключать новые игры и даже сложные рабочие процессы почти без усилий со стороны программистов. Универсальный подход позволяет нам запускать ботов для новой игры сразу же, как только мы получим её схему, ещё до того, как для неё будет написан специальный движок.
- **Понятные Инструкции:** Мы можем давать клиентам или другим разработчикам чёткий формат инструкций (`Схему` состояния игры), чтобы они могли создавать новые игровые движки, которые сразу подключатся к нашей системе. А наш подход «сначала играем, потом пишем код» поможет нам и нашим партнёрам создавать эти инструкции быстрее и точнее.
- **Правила как Услуга:** Если клиентам сложно описать сложную систему (например, программу лояльности), мы можем отнестись к их процессу как к «игре». Наш Реактор может проиграть этот процесс, используя универсальный путь, помогая им уточнить правила и автоматически создавая надёжные инструкции и тесты. Это решает большую проблему для бизнеса и само по себе становится ценной услугой.
- **Мгновенная Готовность:** Наша система может начать запускать ботов для новой игры в тот же момент, как мы получим её схему, даже до того, как для неё будет написан специальный движок.

Перестраивая нашу систему на основе универсального языка, мы не просто улучшаем существующий продукт. Мы строим фундамент для будущей экосистемы самостоятельных агентов, способных освоить любую игру, что открывает безграничные возможности для роста и инноваций.

## Связь с Глобальной Целью

Это стратегическое изменение не просто улучшает наш игровой продукт; оно объединяет все наши продукты под одной общей идеей. Эта работа — прямое и практическое продолжение нашей цели по созданию децентрализованной, равноправной сети для обмена идеями, как описано в _Эдикте Автономности_.

**Первый Клиент и Проверка Идеи**
Эта обновлённая система станет первым специальным клиентом для нашего протокола **«Триады Идей»**. Это важнейшая проверка концепции, которая покажет на реальном коммерческом примере, как эта абстрактная модель может создавать реальную ценность, гибкость и интеллект.

**Больше, чем Игры: Универсальная Модель Взаимодействия**
Архитектура, которую мы строим, не ограничивается играми. Она предоставляет общую и мощную модель для того, чтобы ИИ-агенты могли реагировать на отдельные изменения в любом окружении. Если присмотреться, всё можно представить как пошаговую игру: разговор, финансовая операция, управление проектом.

Реактор — это первый из многих подобных микросервисов, «Преобразователей Идей». Тот же самый протокол будет поддерживать целую экосистему сервисов, которые могут работать вместе, включая:

- Сервис **«Уточнитель»**, который обогащает «Идею», находя и добавляя в неё связанные данные из базы данных.
- Сервис **«Статистик»**, который анализирует «Идею» и добавляет исторический или статистический контекст.
- Сервис **«Проверяющий»**, который сверяет «Идею» с набором правил и даёт подсказки для повторных попыток.

Создавая систему, которая мастерски владеет этой моделью взаимодействия, мы создаём фундаментальную технологию — как бы один из «инструментов в наборе» в большой экосистеме сервисов. Её можно будет применять к огромному множеству будущих продуктов и услуг, что делает этот проект краеугольным камнем будущего нашей компании.