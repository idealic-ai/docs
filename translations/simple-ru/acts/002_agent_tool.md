# 002: Агент/Инструмент

> **Инструмент**: Это как чертёж или инструкция, которая описывает, что умеет делать агент. Эту инструкцию показывают «мозгу» ИИ (LLM), когда ему дают задание. Она работает как понятное меню возможных действий. ИИ может выбрать инструмент и дать команду `Call` с конкретными параметрами. Эту команду он может выполнить либо сам, в своём «воображении» (скрытое исполнение), либо запустив специальный программный код (`Действие`). — [Глоссарий](./000_glossary.md)

> Sidenote:
> - Требуется: [001: Агент/Запрос](./001_agent_request.md)
> - Дополняется: [003: Агент/Действие](./003_agent_activity.md)

`Инструмент` — это описание способности агента в виде строгих правил (схемы). Это как один кубик в конструкторе, из которого строятся все действия агента. Благодаря ему, искусственный интеллект (ИИ) может понять, какие у него есть «суперсилы», и выбрать нужную из списка.

## Что такое Инструменты?

**Инструменты — это основа** того, как действуют агенты. Они дают им новую, очень важную возможность: **выбирать действие по ситуации**. Это позволяет агентам решать, что делать, исходя из того, какая перед ними стоит задача.

Что дают Инструменты:

- **Понятную инструкцию**: Чётко описанные способности, которые агент может изучить и понять.
- **Надёжность**: Точные правила о том, что нужно дать Инструменту на вход и что он вернёт на выходе. Как в рецепте: «дай муку и воду — получишь тесто».
- **Сочетаемость**: Инструменты можно соединять, как детали конструктора, чтобы создавать сложные цепочки действий.
- **Понимаемость для ИИ**: Инструкции написаны так, что «мозг» агента может их проанализировать и выбрать подходящую.

Когда агент решает использовать Инструмент и заполняет все необходимые для него данные, он создаёт **Вызов (Call)** — это как заполненный бланк заказа на выполнение действия.

> Sidenote:
> Когда ИИ выбирает и заполняет Инструмент, он создаёт [004: Агент/Вызов](./004_agent_call.md).

## Когда использовать Инструменты?

Используйте систему Инструментов, когда вам нужно, чтобы агенты:

- **Выбирали действия на лету**, в зависимости от задачи и ситуации.
- **Могли выбирать из нескольких разных способностей** для достижения цели.
- **Использовали разные способы для одного и того же действия** (например, искали в Google или в Яндексе).
- **Сочетали «творческое» мышление ИИ с точными программными командами** при принятии решений.

## Как устроена система Инструментов

### Главный принцип: Инструкция отдельно от действия

Система Инструментов построена на одной простой идее: **Инструменты — это просто схемы**, описания того, *что* можно сделать, но не *как* это сделать. Это разделение инструкции и самого действия — ключ к гибкости всей системы.

Схема `Инструмента` — это обычный объект JSON Schema. Любое поле без знака `_` в начале — это параметр, который нужен для работы. Система использует специальные поля (начинающиеся с `_`), чтобы описать служебные свойства: как инструмент называется и как его выполнять.

Схема Инструмента полностью описывает его:

> Sidenote:
> Расширения:
>
> - **`_activity`**: Связывает инструмент с программным кодом для явного выполнения. ([003: Агент/Действие](./003_agent_activity.md))
> - **`_module`**: Передаёт выполнение инструмента внешнему, изолированному модулю. ([009: Агент/Модуль](./009_agent_module.md))
> - **`_outputPath`**: Позволяет инструменту сохранять свой результат в общее хранилище данных. ([010: Агент/Состояние](./010_agent_state.md))
> - **`_instance`**: Направляет выполнение инструмента на конкретный экземпляр, если в запросе их несколько. ([011: Агент/Инстансинг](./011_agent_instancing.md))

- **`title`**: Понятное человеку название (необязательно).
- **`description`**: Объяснение, что делает инструмент.
- **`parameters`**: Поля без знака `_` описывают, какие данные нужны инструменту для работы.
- **`_tool`**: Уникальное имя, по которому можно найти этот инструмент.
- **`_output`**: Описание того, как должен выглядеть результат работы.
- **`_reasoningForCall`**: Поле, которое добавляет система, чтобы агент объяснил, почему он выбрал именно этот инструмент.

Более сложные системы затем используют эти простые «детали» для организации целых рабочих процессов, управления состоянием и выполнения задач.

## Описание Инструмента

Инструменты описываются в формате JSON Schema. Пример ниже показывает `Инструмент` для определения тональности текста (позитивный он или негативный). Этот `Инструмент` рассчитан на скрытое исполнение — ИИ сам понимает язык и может выполнить задачу без помощи внешнего кода.

```typescript
// Регистрируем новый инструмент под названием 'sentimentAnalysis'
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует тональность текста',
  properties: {
    // Уникальное имя этого инструмента
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    // Текст, который нужно проанализировать
    text: { type: 'string', description: 'Текст для анализа' },
    // Описание того, как будет выглядеть результат
    _output: {
      type: 'object',
      properties: {
        // Тональность (например, 'позитивная')
        sentiment: { type: 'string' },
        // Уверенность в оценке (от 0 до 1)
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Сочетание и выполнение Инструментов

Хотя каждый Инструмент — это отдельная небольшая способность, их настоящая сила проявляется, когда их много. Система показывает ИИ все доступные Инструменты сразу в одном запросе. Это позволяет ИИ выбрать самый подходящий для текущей ситуации и передать ему нужные данные. Когда ИИ делает выбор и заполняет параметры, он создаёт объект под названием `Вызов (Call)`.

> Sidenote:
> Когда ИИ использует `Инструмент` для выполнения задачи, он создаёт объект [004: Агент/Вызов](./004_agent_call.md).

## Скрытое и явное выполнение

Сам по себе `Инструмент` — это всего лишь инструкция. А вот выполнить его можно двумя способами. Первый, по умолчанию, — **скрытое выполнение**. Это когда ИИ использует свои внутренние знания, чтобы выдать результат. Такой способ хорош для задач, связанных с языком или знаниями. Но для действий, которые требуют взаимодействия с внешним миром — например, получить данные с сайта или заглянуть в базу данных, — `Инструмент` нужно связать с конкретным программным кодом. Такое явное, программное исполнение называется **Действием (Activity)**.

Разделение инструкции (`Инструмент`) и её исполнения (`Действие`) — это ключевая идея. Она позволяет сначала описать все способности агента в общем виде, чтобы ИИ мог о них «думать», а уже потом, отдельно, написать код, который будет эти способности реализовывать. Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, расскажет, как `Действия` превращают Инструменты в реальные шаги.

> Sidenote:
> [003: Агент/Действие](./003_agent_activity.md).
>
