# 007: Агент/Переменные

> [!DEFINITION] [:term[Ссылка на переменную]{canonical="Variable Reference"}](./000_glossary.md)
> Это специальная строка (текст) с особым синтаксисом (`†<тип>.<путь>`), которая используется в параметрах :term[Вызова Инструмента]{canonical="Tool Call"}, чтобы сослаться на значение, хранящееся где-то в памяти агента.

:term[Переменные]{canonical="Variable"} строятся на основе системы :term[Данных]{canonical="Data"} ([005: Агент/Данные](./005_agent_data.md)) для создания динамических потоков информации. Они делают данные «живыми» и интерактивными. С их помощью :term[Вызовы Инструментов]{canonical="Tool Call"} могут использовать значения из памяти (контекста) агента (например, из сообщения :term[Ввода]{canonical="Input"} или :term[Состояния]{canonical="State"}), не копируя сами данные в свои параметры.

## Чтение из контекста

Параметр в :term[Вызове Инструмента]{canonical="Call"} может содержать не само значение, а **:term[Ссылку на переменную]{canonical="Variable Reference"}** — специальную строку, которая указывает на это значение в другом месте. Представь, что вместо того, чтобы переписывать всю книгу, ты просто даёшь номер страницы. Это гораздо эффективнее и надёжнее, чем заставлять ИИ копировать большие объёмы данных из одного места в другое. Использование ссылок быстрее, дешевле и безопаснее, так как исключает риск того, что ИИ случайно изменит данные при копировании.

Ссылка — это простая текстовая строка, которая начинается со знака кинжала (`†`). Её формат: `†<тип>.<путь>`, где `<тип>` — это вид сообщения с :term[Данными]{canonical="Data"} (например, `state`, `input`), а `<путь>` — это путь к нужному значению, записанный через точку.

> Sidenote:
> - Википедия: [Кинжал (типографика)](<https://ru.wikipedia.org/wiki/Кинжал_(знак)>)

::::columns
:::column{title="Параметры инструмента, использующие переменные"}

```json
{
  "_tool": "greetUser",
  "userName": "†input.userName"
}
```

:::
:::column{title="Эквивалентный код на Typescript"}

```typescript
greetUser({
  userName: input.userName,
});
```

:::
::::

## Взаимодействие с другими системами

- **:term[Данные]{canonical="Data"}:** :term[Переменные]{canonical="Variable"} — это как раз тот механизм, который делает сообщения с :term[Данными]{canonical="Data"} интерактивными. :term[Ссылки на переменные]{canonical="Variable Reference"} читают информацию из сообщений с :term[Данными]{canonical="Data"} (таких как :term[Ввод]{canonical="Input"} или :term[Состояние]{canonical="State"}), а :term[Пути Вывода]{canonical="Output Path"} записывают информацию обратно. Так создаётся динамический цикл, в котором данные можно и получать, и изменять.

  > Sidenote:
  > - [005: Агент/Данные](./005_agent_data.md)

- **:term[Ввод]{canonical="Input"}:** :term[Ссылки на переменные]{canonical="Variable Reference"} могут указывать на сообщения :term[Ввода]{canonical="Input"}, что позволяет настраивать рабочий процесс с помощью параметров. Это очень важно для создания повторяемых планов, где общая структура действий задана, а конкретные данные, с которыми нужно работать, передаются в момент запуска.

  > Sidenote:
  > - [006: Агент/Ввод](./006_agent_input.md)

- **:term[Состояние]{canonical="State"}:** :term[Состояние]{canonical="State"} — это главный «черновик» для переменных в многошаговых задачах. Именно сюда чаще всего указывают :term[Пути Вывода]{canonical="Output Path"}, потому что :term[Состояние]{canonical="State"} сохраняется между шагами выполнения агента. Это позволяет одному шагу оставить результат, который сможет прочитать следующий.

  > Sidenote:
  > - [009: Агент/Состояние](./009_agent_state.md)

- **:term[План]{canonical="Plan"}:** :term[Переменные]{canonical="Variable"} — это ключевая технология, на которой держится вся система :term[Планов]{canonical="Plan"}. Сообщение :term[Плана]{canonical="Plan"} — это, по сути, схема :term[Вызовов Инструментов]{canonical="Call"}, где связи между ними создаются с помощью :term[Ссылок на переменные]{canonical="Variable Reference"}, которые указывают на :term[Пути Вывода]{canonical="Output Path"}. Это позволяет агенту описать весь рабочий процесс в виде единой и понятной структуры данных.

  > Sidenote:
  > - [011: Агент/План](./011_agent_plan.md)

## От временных связей к постоянной памяти

:term[Переменные]{canonical="Variable"} позволяют связывать данные с инструментами в рамках одного запроса. Но чтобы создавать сложных агентов, выполняющих задачи в несколько этапов, нужна более постоянная форма памяти — тот самый «черновик», где результаты могут храниться и использоваться в разных независимых запросах.

В следующем документе, [008: Агент/Вывод](./008_agent_output.md), описывается, как именно результаты записываются в контекст.
