# 006: Агент/Данные

> **Сообщение с данными:** Это как записка, которая не пропадает. В ней есть сама информация (`data`) и, по желанию, инструкция, как её понимать (`schema`). Она остаётся на месте, пока агент выполняет свою работу, чтобы у него всегда под рукой была важная и понятная информация. — [Глоссарий](./000_glossary.md)

> Sidenote:
> - Требует:
>   - [001: Агент/Запрос](./001_agent_request.md)
> - Делает возможным:
>   - [007: Агент/Ввод](./007_agent_input.md)
>   - [010: Агент/Состояние](./010_agent_state.md)
> - Дополняется:
>   - [005: Агент/Цикл](./005_agent_loop.md)
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)

Этот документ описывает **Протокол Данных**. Представь, что это универсальный способ упаковывать информацию в «умные контейнеры». Такой контейнер не только хранит данные, но и объясняет, что это за данные. Другие части системы, например [Ввод](./007_agent_input.md) и [Состояние](./010_agent_state.md), используют эти контейнеры, чтобы работать с информацией внутри агента. В отличие от обычных сообщений, которые похожи на мимолётные разговоры, сообщения с данными — постоянны. Они остаются с агентом на протяжении всей его работы, помогая ему не сбиться с пути при выполнении сложных задач.

## Сообщение с данными

> Sidenote:
> - [001: Агент/Запрос](./001_agent_request.md)

Сообщение с данными — это простая, но мощная вещь, которая добавляет понятную информацию в [Запрос](./001_agent_request.md). Это как коробка, на которой есть несколько важных наклеек:

- **`data`**: Это то, что лежит *внутри* коробки. Это может быть что угодно: число, текст, список дел или сложная инструкция.
- **`schema`**: Это *инструкция* к содержимому, приклеенная к коробке. Она объясняет умной системе (ИИ), что именно лежит внутри, как это устроено и что с этим можно делать. Например: «Внутри — список покупок, и каждый пункт должен быть текстом».
- **`kind`**: Это *наклейка-категория* на коробке, например, «Состояние Игры» или «Что Сказал Пользователь». Она помогает системе и ИИ быстро понять, для чего эти данные нужны.

Когда мы кладём в коробку данные (`data`) вместе с инструкцией (`schema`), информация становится понятной для машины. Схема — это как чертёж, который помогает ИИ не гадать, а точно знать, что означает каждая часть данных. Это также помогает и людям понять, какие настройки можно изменить.

## Объединение и идентичность

Система умеет работать с несколькими «умными контейнерами» одновременно. Если она видит несколько коробок с одинаковыми наклейками (например, с категорией `kind: "state"`), она может объединить их содержимое в одну большую коробку. Это полезно, когда нужно собрать несколько маленьких изменений в одно целое.

Главный способ понять, что коробки одинаковые — это посмотреть на їх категорию (`kind`). Например, все сообщения с категорией `"state"` считаются частью одного и того же. Эту идентичность можно уточнить с помощью других правил, например, [011: Агент/Инстансинг](./011_agent_instancing.md), который позволяет создавать отдельные «рабочие пространства» для параллельных задач.

> Sidenote:
> - [011: Агент/Инстансинг](./011_agent_instancing.md)

Когда появляется несколько таких похожих сообщений (например, несколько обновлений для состояния), система может поступить двумя способами. Первый: она сама заранее «пересыпает» всё содержимое в одну коробку, чтобы ИИ было проще. Второй: ИИ сам достаточно умён, чтобы посмотреть на несколько коробок и в уме представить их как одно целое, понимая, что это части одной большой картины.

## Как это работает с другими протоколами

Протокол Данных — это фундамент, на котором строятся другие, более сложные правила.

- **Цикл:** Рабочий цикл агента использует Сообщения с данными, чтобы не терять нить повествования. Сообщение «Состояние» — это как раз такой специальный контейнер, который хранит память о том, что происходило на предыдущих шагах.

  > Sidenote:
  > - [005: Агент/Цикл](./005_agent_loop.md)

- **Состояние:** Протокол Состояния использует Сообщение с данными, чтобы хранить «память» агента, которая постоянно меняется и растёт. Схема (`schema`) в этом сообщении описывает, из чего состоит эта память: какие переменные и факты в ней есть.

  > Sidenote:
  > - [010: Агент/Состояние](./010_agent_state.md)

- **Инстансинг:** Все Сообщения с данными подчиняются правилам Инстансинга. Это как если бы у каждой коробки был свой уникальный номер (`_instance`), который привязывает её к определённой задаче. Коробки с разными номерами никогда не смешиваются, чтобы задачи, выполняемые одновременно, не мешали друг другу.

  > Sidenote:
  > - [011: Агент/Инстансинг](./011_agent_instancing.md)

- **Ввод:** Протокол Ввода использует Сообщение с данными, чтобы объявить, какую информацию ожидает получить Запрос. Это превращает обычный документ с заданием в многоразовый инструмент, который можно использовать с разными параметрами, как функцию в программировании.

  > Sidenote:
  > - [007: Агент/Ввод](./007_agent_input.md)

## От данных к действию

Протокол Данных даёт нам «умный контейнер» для любой информации. Теперь, когда у нас есть этот фундамент, мы можем перейти к его первому важному применению: передаче понятных параметров для выполнения запроса. Это ключевой шаг, который превращает статичный документ в живой, работающий инструмент.

Следующий документ, **[007: Агент/Ввод](./007_agent_input.md)**, расскажет, как этот принцип используется для создания чётких инструкций для Запроса.
