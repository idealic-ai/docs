# 006: Агент/Данные

> **Сообщение с данными:** Это специальное сообщение, которое остаётся в «памяти» агента надолго. В нём есть сами `данные` и, необязательно, `схема`, которая их описывает. Оно помогает агенту хранить важную информацию, пока он работает над задачей. — [Словарь](./000_glossary.md)

> Sidenote:
> - Требует:
>   - [001: Агент/Запрос](./001_agent_request.md)
> - Лежит в основе:
>   - [007: Агент/Ввод](./007_agent_input.md)
>   - [010: Агент/Состояние](./010_agent_state.md)
> - Дополняется:
>   - [005: Агент/Цикл](./005_agent_loop.md)
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)

Этот документ рассказывает о **Протоколе Данных** — простом способе передавать информацию в понятном для компьютера виде. Это как фундамент для других частей системы, например для [Ввода](./007_agent_input.md) и [Состояния](./010_agent_state.md). Он помогает агенту работать со структурированными данными в его «рабочей области» или `контексте`. В отличие от обычных сообщений, которые появляются и исчезают, сообщения с `Данными` остаются надолго и помогают агенту выполнять сложные задачи, состоящие из нескольких шагов.

## Сообщение с Данными

> Sidenote:
> - [001: Агент/Запрос](./001_agent_request.md)

Сообщение с `Данными` — это простой, но очень полезный способ добавить структурированную информацию к [Запросу](./001_agent_request.md). Представь, что это записка с чёткими инструкциями, у которой есть три поля:

*   **`data`**: Сама информация в формате JSON. Это может быть что угодно: текст, число, список или целый объект.
*   **`schema`**: Необязательная инструкция (JSON Schema), которая объясняет, что значат эти данные. Это как чертёж, который показывает, из чего состоит деталь и как её использовать.
*   **`kind`**: Необязательная метка, которая говорит о роли сообщения (например, `"state"` — состояние, `"input"` — ввод). Это помогает и системе, и нейросети понимать, что это за данные и для чего они нужны.

Когда у данных есть `схема`, они становятся понятны машине. Эта схема — как инструкция для нейросети, объясняющая, что означает каждое поле, какого оно типа и какие у него есть правила. Это не только помогает нейросети лучше соображать, но и служит подсказкой для людей, показывая, что можно изменить или настроить.

## Объединение и Уникальность

Протокол устроен так, что может обрабатывать несколько сообщений с `Данными` в одном `контексте`. Если система видит, что несколько сообщений относятся к одной и той же сущности, она их объединяет в одно целое. Это очень удобно, когда нужно, например, внести несколько небольших изменений в состояние агента.

Уникальность сообщения определяется его меткой `kind`. Например, все сообщения с меткой `kind: "state"` считаются частью одной и той же сущности. Эту уникальность можно уточнить с помощью других протоколов, например [011: Агент/Инстансинг](./011_agent_instancing.md), который позволяет запускать несколько процессов параллельно, создавая для каждого свою «рабочую область».

> Sidenote:
> - [011: Агент/Инстансинг](./011_agent_instancing.md)

Когда появляется несколько сообщений, которые можно объединить (например, несколько правок для `состояния`), система может поступить двумя способами. Во-первых, она может сама собрать их в один объект перед тем, как показать нейросети. Это упрощает модели задачу. Во-вторых, нейросеть может сама «мысленно» объединить эту информацию, понимая, что разные сообщения описывают одну и ту же вещь с разных сторон.

## Как это работает с другими протоколами

Протокол `Данных` — это базовый строительный блок, который используют и расширяют другие, более сложные протоколы.

*   **Цикл:** Рабочий цикл агента использует сообщения с `Данными`, чтобы сохранять преемственность между шагами. Сообщение `Состояние` (State) — это особый вид сообщения с `Данными`, главный способ хранить информацию между «тактами» работы агента.

  > Sidenote:
  > - [005: Агент/Цикл](./005_agent_loop.md)

*   **Ввод:** Протокол `Ввода` (Input) использует сообщение с `Данными`, чтобы официально объявить, какие параметры принимает `Запрос`. Именно так статичная `Идея` превращается в многоразовый инструмент (`Идеатор`), похожий на функцию.

  > Sidenote:
  > - [007: Агент/Ввод](./007_agent_input.md)

*   **Состояние:** Протокол `Состояния` (State) использует сообщение с `Данными` для хранения «памяти» агента, которая может меняться со временем. `Схема` этого сообщения описывает, из чего состоит объект состояния и какие в нём есть переменные.

  > Sidenote:
  > - [010: Агент/Состояние](./010_agent_state.md)

*   **Инстансинг:** Все сообщения с `Данными` подчиняются правилам `Инстансинга`. Свойство `_instance` работает как ключ, который привязывает данные к определённому потоку выполнения в большой задаче. Сообщения с разными ключами `_instance` не будут объединяться, что гарантирует их изоляцию друг от друга при параллельной работе.

  > Sidenote:
  > - [011: Агент/Инстансинг](./011_agent_instancing.md)

## От данных к действию

Протокол `Данных` даёт нам универсальный «контейнер» для структурированной информации. С этим фундаментом мы можем перейти к его первому главному применению: передаче структурированных параметров в запрос. Это ключевой шаг, который превращает обычный документ в динамический, исполняемый инструмент.

Следующий документ, **[007: Агент/Ввод](./007_agent_input.md)**, расскажет, как этот подход используется для создания официального интерфейса ввода для `Идеи`.
