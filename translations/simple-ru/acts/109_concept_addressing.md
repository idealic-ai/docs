# 109: Концепция/Адресация

> [!DEFINITION] [idea:](../../acts/000_glossary.md)
> Это как специальный интернет-адрес (URI), но для :term[Идей]{canonical="Idea"}. Он помогает ориентироваться в мире :term[Идей]{canonical="Idea"} с их разными версиями и ветками. С помощью этого адреса можно как попросить самую новую версию :term[Идеи]{canonical="Idea"}, так и получить постоянную, точную ссылку на какую-то конкретную версию.

> Sidenote:
> - Требуется знание:
>   - :term[Видимость]{href="./108_concept_visibility.md"}

Схема адресов :term[idea:]{canonical="idea:"} — это язык, который помогает нам ориентироваться в мире :term[Идей]{canonical="Idea"} с их множеством версий и веток. Представьте, что это как почтовый адрес для :term[Идей]{canonical="Idea" href="./101_concept_idea.md"}. Он даёт нам чёткие правила, чтобы запрашивать нужные :term[Идеи]{canonical="Idea" href="./101_concept_idea.md"} и создавать постоянные ссылки на их конкретные версии, чтобы всегда можно было найти именно ту, что нужна.

> Sidenote:
> - Понятия :term[Веток]{canonical="Branch" href="./108_concept_visibility.md#branches-publication-and-partitioning"} и :term[Пути Поиска]{canonical="Search Path" href="./108_concept_visibility.md#the-search-path-prioritized-retrieval"}, по которым работает эта система адресов, подробно описаны в главе :term[Видимость]{href="./108_concept_visibility.md"}.

## Из чего состоит ссылка `idea:`

Ссылка :term[idea:]{canonical="idea:"} может состоять из нескольких частей:

- **Схема**: :term[idea:]{canonical="idea:"} — всегда начинается так.
- **Домен**: Необязательное имя пространства, как адрес сайта (например, `//my-project.com`). Если его нет, то поиск идёт в текущем пространстве.
- **Указатель ветки**: Необязательное указание, в какой именно :term[ветке]{canonical="Branch"} искать (например, `~main/`). Символ `/` в начале — это короткая запись для `~main/`.
- **Путь**: Название :term[Идеи]{canonical="Idea" href="./101_concept_idea.md"}, как имя файла (например, `schemas/UserProfile`).
- **Префикс версии**: Необязательное условие для версии (например, `?1.2`), как просьба «дай мне что-то похожее на версию 1.2».
- **Найденная версия**: В готовой ссылке — точная версия, которая была найдена (например, `:1.2.3`).
- **Фрагмент**: Указатель на определённую часть внутри :term[Идеи]{canonical="Idea" href="./101_concept_idea.md"} (например, `#schema`).

## Состояния ссылки

Адрес :term[idea:]{canonical="idea:"} может быть в разных состояниях, как записка с просьбой или уже готовый ответ.

1.  **Относительный запрос («Просьба»):** `idea:schemas/UserProfile?1.2`
    - Это просьба найти последнюю версию `UserProfile`, совместимую с `1.2`, в **текущем пространстве**. Система будет искать её по :term[Пути Поиска]{canonical="Search Path" href="./108_concept_visibility.md#the-search-path-prioritized-retrieval"}.

2.  **Абсолютный запрос:** `idea://my-project.com/schemas/UserProfile?1.2`
    - Это точный запрос к конкретному домену. Он не зависит от того, где вы находитесь сейчас.

3.  **Запрос к конкретной ветке:** `idea:~main/schemas/UserProfile` (или `idea:/schemas/UserProfile`)
    - `~` в начале означает, что нужно искать только в :term[ветке]{canonical="Branch"} `main`, игнорируя обычный :term[Путь Поиска]{canonical="Search Path" href="./108_concept_visibility.md#the-search-path-prioritized-retrieval"}.

4.  **Найденная ссылка («Ответ»):** `idea://my-project.com/:staging/schemas/UserProfile?1.2:1.2.staging.4`
    - Это постоянная и однозначная ссылка. Она говорит нам: «Я искал в домене `my-project.com`, в :term[ветке]{canonical="Branch"} `staging`, и нашёл точную версию `1.2.staging.4`».

## Полный цикл разработки

Благодаря этим правилам несколько человек могут работать вместе над одним проектом, не мешая друг другу.

1.  **Создаём ветку**: Разработчик создаёт новую :term[ветку]{canonical="Branch"} `feature/user-onboarding-v2`. Его :term[Путь Поиска]{canonical="Search Path" href="./108_concept_visibility.md#the-search-path-prioritized-retrieval"} теперь такой: сначала искать в `feature/user-onboarding-v2`, а потом в `main`.

2.  **Разрабатываем процесс**: Он создаёт новую :term[Идею]{canonical="Idea" href="./101_concept_idea.md"} типа `Process` с адресом `idea:processes/onboarding`. Так как он работает в своей :term[ветке]{canonical="Branch"}, все изменения сохраняются только там. Он может свободно экспериментировать и создавать другие :term[Идеи]{canonical="Idea" href="./101_concept_idea.md"}, например `Instruction` и `Record`.

3.  **Используем существующие части**: Новому процессу нужна стандартная инструкция «Отправить письмо». Разработчик ссылается на неё по адресу `idea:activities/send-email`. Система сначала ищет её в его :term[ветке]{canonical="Branch"} `feature/user-onboarding-v2`. Не найдя, она ищет дальше и находит стабильную версию в `main`.

4.  **Переопределяем компонент**: Разработчик понимает, что ему нужен особый шаблон «Приветственного письма». Он создаёт новую версию `idea:records/email-templates/welcome` и сохраняет её. Эта новая версия попадает в его :term[ветку]{canonical="Branch"} `feature/user-onboarding-v2`. Теперь, когда его процесс запрашивает эту :term[Идею]{canonical="Idea" href="./101_concept_idea.md"}, система сначала находит его новую версию и использует её, не трогая старую в `main`.

5.  **Публикация**: Когда всё готово, разработчик «публикует» свою работу. :term[Идея]{canonical="Idea" href="./101_concept_idea.md"} версии `1.3.new-login.2` копируется, её версия становится `1.4`, и она добавляется в главную :term[ветку]{canonical="Branch"} `main`. Теперь это новая стабильная версия для всех.

6.  **Контролируемый эффект «домино»**: Другой процесс использовал `idea:processes/onboarding?1` (любую версию, начинающуюся с `1`). Поскольку новая версия `1.4` подходит под это условие, в следующий раз этот процесс автоматически подхватит её. Чтобы такого не случилось и всё работало стабильно, можно «закрепить» зависимость, попросив более точную версию, например `?1.3`.
