# 301: Идеатор/Хранилище

**Система: Хранилище** — это главный служебный сервис во всей экосистеме Идей. Представьте его как особый **Трансформатор Идей**, чья главная задача — быть надёжным, постоянно действующим архивом для :term[Идей]{canonical="Idea"}. Это фундаментальный слой памяти, позволяющий сохранять :term[Идеи]{canonical="Idea"} и их версии для дальнейшего использования другими сервисами, такими как [Система: Распознаватель](./302_ideator_resolver.md).

## 2. Основная концепция: Хранилище как Трансформатор Идей

Сервис Хранилища работает по принципу `Трансформатора Идей`: он принимает :term[Идею]{canonical="Idea"} на входе и возвращает :term[Идею]{canonical="Idea"} на выходе.

- **Вход**: правильная :term[Идея]{canonical="Idea"}, состоящая из трёх частей (`схема`, `решение`, `контекст`).
- **Процесс**: Сервис получает :term[Идею]{canonical="Idea"}, присваивает ей уникальный адрес-идентификатор (который также включает информацию о версии) и навсегда записывает её в надёжное место (например, в базу данных PostgreSQL).
- **Выход**: Сервис возвращает исходную :term[Идею]{canonical="Idea"} в качестве подтверждения, что она успешно сохранена. Этот ответ может содержать дополнительную информацию, например, присвоенный идентификатор и номер версии, чтобы подтвердить, что всё записано.

## 3. Хранилище как граница операций

Критически важная роль Хранилища — служить **границей операций**. Когда кто-то извне (например, пользователь или другой сервис) отправляет :term[Идею]{canonical="Idea"} и получает подтверждение о сохранении, эта первая операция считается завершённой.

Это разделение — ключ к надёжности и масштабируемости всей архитектуры. Оно позволяет строить сложные, управляемые событиями процессы. Как только :term[Идея]{canonical="Idea"} попадает в `Хранилище`, другие сервисы (например, «Наблюдатель» или «Подписчик») могут отреагировать на это изменение, запуская свои собственные, независимые операции для продолжения работы. Это избавляет от необходимости поддерживать одну большую, долгую и громоздкую операцию и создаёт чёткую, легко отслеживаемую передачу «эстафетной палочки» между разными этапами процесса.

## 4. Ключевые характеристики

### 4.1. «Чёрный ящик» для хранения

Сервис Хранилища спроектирован как управляемый «чёрный ящик». Пользователи просто отправляют :term[Идеи]{canonical="Idea"} на сохранение, не зная и не контролируя, как именно они хранятся (какая база данных используется, как распределяются данные и т.д.). Сервис гарантирует, что принятая :term[Идея]{canonical="Idea"} будет сохранена и доступна для поиска. Все технические детали остаются «под капотом» и решаются провайдером сервиса.

### 4.2. Версионирование и неизменность

Система построена на принципе неизменности. Когда существующая :term[Идея]{canonical="Idea"} «обновляется», сервис хранения не меняет старую запись. Вместо этого он создаёт и сохраняет новую версию :term[Идеи]{canonical="Idea"}, сохраняя полную и неразрывную историю её изменений. Это гарантирует, что любая ссылка на конкретную версию :term[Идеи]{canonical="Idea"} всегда будет указывать на одно и то же содержимое. Ссылки могут указывать как на конкретную версию, так и на динамическую ветку (например, `latest` — «последняя»).

### 4.3. Контентная адресация

Хотя точная схема адресации является деталью реализации, основной принцип таков: каждая сохранённая :term[Идея]{canonical="Idea"} имеет уникальный адрес и может быть найдена по своему идентификатору и версии. Это позволяет создать надёжную и децентрализованную систему, где на :term[Идеи]{canonical="Idea"} можно ссылаться с абсолютной точностью.

## 5. Публичный интерфейс

Публичный интерфейс системы Хранилища очень прост и ориентирован только на запись, что соответствует его роли «приёмника» :term[Идей]{canonical="Idea"}.

- **Основное взаимодействие**: Единственное публичное действие — это отправка :term[Идеи]{canonical="Idea"} на сохранение.

- **Отделение от чтения**: Для чёткого разделения обязанностей сервис Хранилища не предоставляет публичного интерфейса для чтения или поиска :term[Идей]{canonical="Idea"}. Ответственность за поиск и получение :term[Идей]{canonical="Idea"} полностью возложена на сервис **Распознавателя**. Это позволяет каждому сервису сосредоточиться на одной задаче: Хранилище отвечает за сохранение, а Распознаватель — за поиск и компоновку.
