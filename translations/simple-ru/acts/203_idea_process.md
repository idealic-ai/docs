# 203: Идея/Процесс

> **Идея-Процесс:** Это как отдельная коробочка-идея ([Идея](./101_concept_idea.md)), в которой хранится целый стратегический план ([План](./012_agent_plan.md)) и всё, что происходит во время его выполнения прямо сейчас. Её `схема` — это набор всех доступных инструментов ([Инструменты](./002_agent_tool.md)), её `решение` — это *новый* `План` на следующий шаг, а её `контекст` содержит первоначальную задачу (`Ввод`), текущее состояние дел (`Состояние`) и предыдущий `План`.
>
> — [Глоссарий](./000_glossary.md)

> Sidenote:
> - Требует:
>   - [101: Концепция/Идея](./101_concept_idea.md)
>   - [012: Агент/План](./012_agent_plan.md)
>   - [010: Агент/Состояние](./010_agent_state.md)
>   - [007: Агент/Ввод](./007_agent_input.md)
> - Дополняется:
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)

Если [202: Идея/Носитель](./202_idea_vessel.md) — это как быстрая реакция на что-то одно, то **Идея-Процесс** — это продуманный план действий для большой и сложной задачи. Представь, что это подробная карта путешествия, которую рисует система [012: Агент/План](./012_agent_plan.md), чтобы выполнить что-то, что требует много шагов. В этой «карте» записано всё: и какие у агента есть способности, и какой именно маршрут он выбрал.

## Из чего состоит План

`Идея-Процесс` использует тройную структуру `Идеи`, чтобы сделать полный «снимок» всего рабочего процесса. Этот снимок показывает не только стратегию, которую выбрал агент (то есть `План`), но и все его возможные действия, и то, что происходит прямо сейчас.

- **`схема` (Палитра):** Это как палитра с красками или ящик со всеми деталями Lego. Здесь описаны все доступные [Инструменты](./002_agent_tool.md), из которых можно построить `План`. Это полный набор способностей агента.

- **`контекст` (Что происходит вокруг):** Здесь хранится вся информация, которая нужна агенту, чтобы спланировать и сделать следующий шаг.
  - **Входящее сообщение:** Это самая первая задача, с которой всё началось. Обычно она даётся один раз и больше не меняется.

    > Sidenote:
    > - [007: Агент/Ввод](./007_agent_input.md)

  - **Сообщение о состоянии:** Это «живые» данные, которые постоянно обновляются. Представь, что это твой инвентарь в игре, который меняется по ходу дела. В нём хранятся все переменные, которые связывают разные шаги `Плана` между собой.

    > Sidenote:
    > - [010: Агент/Состояние](./010_agent_state.md)

  - **Сообщение о плане:** Здесь лежит `План`, который был выполнен на *предыдущем* шаге. Агент может посмотреть на него и решить: продолжать следовать этому пути или придумать что-то новое.

    > Sidenote:
    > - [012: Агент/План](./012_agent_plan.md)

- **`решение` (Новый План):** Это карта маршрута из `Вызовов`, которую агент составил на *следующий* шаг. Именно она станет «Сообщением о плане» для будущего шага.

### Единство Планирования и Исполнения

Главный секрет этой системы в том, что планирование и действие происходят одновременно. В обычных системах ты сначала составляешь подробный план, а потом начинаешь его выполнять. Здесь же всё иначе: агент думает и делает в один и тот же момент. Сам процесс создания нового `решения` (нового `Плана`) — это и *есть* выполнение текущего шага.

Это единство делает систему очень быстрой и гибкой. `План` — это живая схема, которой не нужно быть законченной, чтобы работать. Она может быть частичной, меняться на лету и использовать результаты предыдущего шага. `Вызовы`, которые создаёт нейросеть, — это одновременно и структура плана, и команды, которые по нему передаются. Благодаря этому нейросеть за один запрос успевает проверить текущее состояние, изменить план на основе новых данных и выполнить следующий логический шаг. Не нужно тратить время на отдельную перепроверку или перепланирование — действие и есть проверка, планирование и корректировка, всё сразу.

> Sidenote:
> - [004: Агент/Вызов](./004_agent_call.md)

Такая модель даёт два больших преимущества. Во-первых, `План` можно составить и «проиграть в уме», даже когда нет настоящих данных. Нейросеть может представить, как будет работать каждый шаг, что позволяет придумывать и проверять сложные процессы с самого начала. Во-вторых, нейросеть работает как умный переходник. Если результат одного `Вызова` не совсем подходит для входа следующего, она может «сгладить» разницу. Это придаёт системе невероятную устойчивость. Она не ломается из-за мелких нестыковок, как это часто бывает в обычных, жёстко связанных системах.

> Sidenote:
> - [105: Концепция/ИИ-центричность](./105_concept_ai_native.md)

### Как План может меняться: от гибкого до жёсткого

Объект `Состояние` позволяет `Плану` пройти три стадии взросления: от гибкого поиска лучшего пути до предсказуемого и надёжного процесса:

> Sidenote:
> - [010: Агент/Состояние](./010_agent_state.md)

1.  **План в свободной форме:** Вначале `Состояние` можно не описывать строгими правилами (`схемой`). Это даёт агенту полную свободу, чтобы исследовать и находить лучший `План`, создавая новые связи (свойства в объекте `Состояние`) на ходу. Он как первооткрыватель, который сам прокладывает тропы.

2.  **План с определёнными связями:** Следующий шаг — сделать `План` более строгим. Для этого мы замораживаем `схему` для `Состояния`, то есть прокладываем на карте главные дороги. Это можно сделать по-разному:
    - **Открытые связи:** Можно разрешить `additionalProperties` (дополнительные свойства). Это заставит агента придерживаться основных дорог, но оставит ему свободу прокладывать небольшие тропинки в обход, если это нужно.
    - **Закрытые связи:** Можно запретить `additionalProperties`. Тогда агент должен будет двигаться строго по проложенным дорогам, без каких-либо отклонений.

3.  **Завершённый План:** Это финальная стадия, когда план считается взрослым и предсказуемым. Такой **Утверждённый План** передаётся как `Сообщение о плане` на следующих шагах. Он может быть двух видов:
    - **Идеальный План:** Это план для идеальных условий, когда всё идёт как по маслу. Он очень быстрый и эффективный, но может потребовать изменений, если случится что-то неожиданное.
    - **Полный План:** Это план, который со временем дополнили решениями для всех частых проблем и альтернативных сценариев. Он очень надёжный и работает почти в любой ситуации.

Такое развитие позволяет `Идее-Процессу` превратиться из гибкого наброска в очень надёжный и полезный инструмент, который можно использовать много раз.

## Неизменяемые Процессы: Управление, Анализ и Масштабирование

Сила `Идеи-Процесса` в её неизменяемости. Представь, что каждый шаг процесса — это новая фотография, на которой запечатлено всё: и `План`, и `Состояние`. Мы никогда не меняем старые фото, а просто добавляем новое. Так получается целый фотоальбом, который в деталях рассказывает историю всего процесса. Эта идея создания цепочки неизменных «снимков» даёт системе суперспособности для управления, анализа и роста.

- **Надёжное, адаптивное исполнение:** Цикл выполнения по шагам («тикам») очень надёжен, потому что каждый новый шаг начинается с чистого и полного «снимка» предыдущего состояния. Это предотвращает путаницу и гарантирует, что агент принимает решение (следовать плану или изменить его) на основе ясной и предсказуемой картины мира. Результат каждого шага — это новая `Идея-Процесс`, которая безопасно двигает процесс вперёд.

  > Sidenote:
  > - [005: Агент/Цикл](./005_agent_loop.md)
  > - [012: Агент/План](./012_agent_plan.md)

- **Устойчивое управление:** `Идея-Процесс` — это самодостаточная вещь, что делает управление процессами невероятно надёжным. Процесс можно поставить на паузу, просто сохранив его последний «снимок». Внешние системы или люди-наблюдатели могут изучить это замороженное состояние и принять решение. Любые изменения, например, перепланирование или правка состояния, создают *новую* `Идею-Процесс`, с помощью которой можно безопасно продолжить работу, не меняя при этом историю.

  > Sidenote:
  > - [010: Агент/Состояние](./010_agent_state.md)

- **Точное моделирование:** Эта архитектура позволяет путешествовать во времени. Каждая `Идея-Процесс` из прошлого — это идеальный, подробный снимок процесса в определённый момент. Это позволяет пользователям или другим агентам загрузить любую точку из прошлого, чтобы проверить, что пошло не так, или запустить сценарии «а что, если...», начав новый процесс с этой точки.

  > Sidenote:
  > - [202: Идея/Носитель](./202_idea_vessel.md)

- **Согласованная параллельная обработка:** Архитектура на основе «снимков» позволяет выполнять огромное количество задач одновременно с помощью протокола Инстансинга. Каждая задача в большой пачке обрабатывается как отдельный, независимый поток со своим изолированным «снимком» `Состояния`. Единый `План` работает как шаблон-стратегия, который применяется ко всем потокам сразу. За один шаг агент параллельно планирует действия для всей пачки, создавая согласованный набор `Вызовов`, подходящий для каждого случая. Это гарантирует одинаковый результат для разных задач и резко повышает эффективность.

  > Sidenote:
  > - [011: Агент/Инстансинг](./011_agent_instancing.md)

## От Предсказуемого Плана к Управляемому Исполнению

`Идея-Процесс` может созреть до **Завершённого Плана** — очень предсказуемого и надёжного процесса. Хотя такая жёсткость даёт стабильность, она может ограничивать гибкость. Системе нужен способ давать тонкие, подходящие к ситуации советы, не ломая при этом сам выстроенный план.

Эту роль играет **[Идея-Инструкция](./204_idea_instruction.md)**. `Инструкция` — это структурированный совет к действию, который даёт более высокий уровень стратегического руководства. Она работает как «мысленная памятка» или набор принципов, которые влияют на процесс на двух уровнях: помогает агенту выбрать или создать самый подходящий `План` для конкретной ситуации и даёт точечные подсказки для отдельных шагов во время выполнения этого `Плана`. По сути, `Инструкция` улучшает *логику* и *рассуждения* в процессе, гарантируя, что и общая стратегия, и конкретные действия соответствуют желаемому подходу.

> Sidenote:
> - [204: Идея/Инструкция](./204_idea_instruction.md)