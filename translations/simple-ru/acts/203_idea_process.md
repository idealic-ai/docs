# 203: Идея/Процесс

> [!DEFINITION] :term[Идея-Процесс]{canonical="Process Idea"}
> Это как отдельная :term[Идея]{canonical='Idea'} ([101: Концепция/Идея](./101_concept_idea.md)), которая хранит в себе хитроумный :term[План]{canonical='Plan'} ([011: Агент/План](./011_agent_plan.md)) и следит за его выполнением в реальном времени. Её `schema` — это набор всех доступных :term[Инструментов]{canonical='Tool'} ([002: Агент/Инструмент](./002_agent_tool.md)), её `solution` — это *новый* `План` на следующий шаг, а её `context` содержит `входные данные` (Input), `текущее состояние` (State) и `предыдущий План`.

> Sidenote:
> - Требует:
>   - [101: Концепция/Идея](./101_concept_idea.md)
>   - [011: Агент/План](./011_agent_plan.md)
>   - [009: Агент/Состояние](./009_agent_state.md)
>   - [006: Агент/Входные данные](./006_agent_input.md)
> - Дополняется:
>   - [012: Агент/Экземплирование](./012_agent_instancing.md)

Если :term[Идея-Носитель]{canonical='Vessel Idea'} ([202: Идея/Носитель](./202_idea_vessel.md)) — это как моментальный снимок одного решения, то **Идея-Процесс** — это целый фильм, показывающий, как выполняется большой и важный план. Она не просто реагирует, а действует наперёд, как шахматист. Это результат работы системы :term[Планирования]{canonical='Plan'} ([011: Агент/План](./011_agent_plan.md)), которая организует сложную, многошаговую задачу. Поэтому в ней записано всё: и какие инструменты есть у агента, и какой именно план он выбрал.

## Анатомия Плана

`Идея-Процесс` использует тройную структуру `Идеи`, чтобы сделать полный «слепок» всего рабочего процесса. В этом слепке хранится не только стратегия, которую выбрал агент (его `План`), но и весь набор его возможностей, и «живое» состояние выполнения задачи.

- **`schema` (Палитра):** Это список всех доступных :term[Инструментов]{canonical='Tool'} ([002: Агент/Инструмент](./002_agent_tool.md)), из которых можно составить `План`. Это как ящик с инструментами, показывающий всё, что умеет делать агент.

- **`context` (Что происходит вокруг):** Здесь собрана вся информация, которая нужна агенту, чтобы спланировать и выполнить текущий шаг.
  - **Входное Сообщение:** Это первоначальный толчок, который запустил весь процесс. Обычно его дают один раз, и он не меняется.

    > Sidenote:
    > - [006: Агент/Входные данные](./006_agent_input.md)

  - **Сообщение о Состоянии:** Это «живые» данные, которые постоянно меняются по ходу работы. В нём хранятся временные переменные, которые связывают разные :term[Вызовы]{canonical='Call'} в `Плане` — как ниточки между шагами.

    > Sidenote:
    > - [009: Агент/Состояние](./009_agent_state.md)

  - **Сообщение о Плане:** Это сообщение содержит `План`, *утверждённый* на предыдущем шаге. Агент может решить следовать ему дальше или изменить его.

    > Sidenote:
    > - [011: Агент/План](./011_agent_plan.md)

- **`solution` (Новый План):** Это карта действий (:term[Вызовов]{canonical='Call'}), которую агент выбрал для *текущего* шага. На следующем шаге она станет `Сообщением о Плане`.

### Единство Планирования и Выполнения

Главный принцип этой системы в том, что планирование и выполнение — это один и тот же процесс. В обычных системах их разделяют, но здесь они происходят одновременно на каждом шаге. Агент не просто создаёт статичный план, а потом отдельно его выполняет. Сам процесс создания нового `solution` (нового `Плана`) *и есть* шаг выполнения.

Это единство делает систему очень быстрой и гибкой. `План` — это живая схема, которой не нужно быть законченной, чтобы приносить пользу. Она может быть частичной, работать с результатами прошлого шага и меняться на лету. :term[Вызовы]{canonical='Call'}, которые создаёт ИИ, — это одновременно и структура плана, и данные, которые по нему передаются. Благодаря этому один запрос к ИИ может одновременно проверить текущее состояние, поправить план на основе новой информации и выполнить следующий шаг. Нет нужды в отдельных и дорогих операциях для перепланирования или проверки — выполнение *и есть* проверка, планирование и исправление, всё в одном.

> Sidenote:
> - [004: Агент/Вызов](./004_agent_call.md)

Такая единая модель даёт два мощных преимущества. Во-первых, `План` можно создать и «проиграть в уме» на основе одних только схем, ещё до того, как появятся реальные данные. ИИ может представить, как будет работать каждый шаг, что позволяет придумывать и проверять сложные процессы с самого начала. Во-вторых, ИИ работает как умный переходник между шагами. Если результат одного :term[Вызова]{canonical='Call'} не совсем подходит для входа следующего, ИИ может это исправить. Это делает систему невероятно устойчивой, в отличие от старых систем, где любая ошибка в связях приводила к поломке всего процесса.

> Sidenote:
> - [105: Концепция/ИИ-центричность](./105_concept_ai_native.md)

### Разные стадии гибкости Плана

Объект `Состояния` позволяет `Плану` проходить три стадии развития: от гибкого поиска идей до предсказуемого и чёткого алгоритма.

> Sidenote:
> - [009: Агент/Состояние](./009_agent_state.md)

1.  **Свободный План:** Вначале `Состояние` можно определить без `схемы`. Это даёт агенту полную свободу, чтобы найти `План`, создавая новые связи (переменные в `Состоянии`) прямо на ходу.

2.  **План с Указанными Связями:** Следующий шаг, чтобы сделать `План` более надёжным, — «заморозить» `схему` `Состояния`, которая определяет главные пути для данных. Это можно сделать с разной степенью строгости:
    - **Открытые Связи:** Схема может разрешать `additionalProperties` (дополнительные свойства). Это заставляет придерживаться основных путей, но даёт агенту свободу создавать новые связи для редких или особых случаев.
    - **Закрытые Связи:** В схеме можно установить `additionalProperties` в `false`. Это создаёт жёсткую структуру, которой агент должен следовать в точности.

3.  **Завершённый План:** Это финальная стадия, когда план считается полностью готовым и предсказуемым. `Завершённый План` становится **Утверждённым Планом**, который передаётся как `Сообщение о Плане` на следующих шагах. Такой план может быть двух видов:
    - **«Счастливый» План:** Завершённый план, который описывает идеальный сценарий. Он очень эффективен, но может потребовать изменений, если случится что-то непредвиденное.
    - **Полный План:** Полностью проработанный план, который со временем дополнили решениями для частых ошибок, альтернативными путями и другими сценариями. Это делает его крайне надёжным.

Такое развитие позволяет `Идее-Процессу` превратиться из гибкого наброска в очень надёжный и многоразовый инструмент.

## Неизменяемые процессы: Управление, Анализ и Масштабирование

Сила `Идеи-Процесса` в её неизменяемости. Каждый шаг в процессе создаёт новый, полный «слепок» `Плана` и `Состояния`, сохраняя идеальную историю, которую можно проверить. Этот главный принцип — создание цепочки неизменяемых артефактов — и даёт системе её самые продвинутые возможности для управления, анализа и масштабирования.

- **Надёжное и Гибкое Выполнение:** Цикл выполнения по шагам («тикам») очень надёжен, потому что каждый новый шаг работает с полным слепком предыдущего состояния. Это предотвращает путаницу и гарантирует, что решение агента следовать `Плану` или изменить его основано на понятной и предсказуемой картине мира. Результат каждого шага — это новая `Идея-Процесс`, которая безопасно двигает работу на один шаг вперёд.

  > Sidenote:
  > - [010: Агент/Цикл](./010_agent_loop.md)
  > - [011: Агент/План](./011_agent_plan.md)

- **Устойчивое Управление:** `Идея-Процесс` — это самодостаточный артефакт, что делает управление процессами невероятно надёжным. Работу можно поставить на паузу, просто сохранив её последний слепок. Внешние системы или люди-наблюдатели могут изучить это замороженное состояние, чтобы принять решение. Любые изменения, например, перепланирование или правка состояния, создают *новую* `Идею-Процесс`, с помощью которой можно безопасно продолжить работу, не меняя историю.

  > Sidenote:
  > - [009: Агент/Состояние](./009_agent_state.md)

- **Точное Моделирование («Путешествие во времени»):** Эта архитектура — ключ к интерактивным путешествиям во времени. Каждая историческая `Идея-Процесс` — это идеальный, точный слепок процесса в определённый момент. Это позволяет пользователям или другим агентам загрузить любую точку в истории процесса, чтобы проверить его, найти причину сложного поведения или запустить сценарии «а что, если», создав новую ветку процесса с этого момента.

  > Sidenote:
  > - [202: Идея/Носитель](./202_idea_vessel.md)

- **Согласованная Параллельная Работа:** Архитектура на основе «слепков» позволяет выполнять огромный объём работы с помощью протокола :term[Экземплирования]{canonical='Instancing'}. Этот подход рассматривает каждую задачу в большой пачке как отдельный, независимый поток выполнения, у каждого из которых свой изолированный слепок `Состояния`. Один `План` работает как стратегический шаблон, применяемый ко всем потокам одновременно. За один шаг агент параллельно планирует действия для всей пачки, создавая согласованный набор `Вызовов`, подходящий для каждого случая. Это гарантирует одинаковый результат для разных задач и резко повышает эффективность.

  > Sidenote:
  > - [012: Агент/Экземплирование](./012_agent_instancing.md)

## От Предсказуемого Плана к Управляемому Выполнению

`Идея-Процесс` может созреть и стать **Завершённым Планом** — очень предсказуемым и надёжным алгоритмом. Хотя такая жёсткость даёт стабильность, она может ограничивать гибкость. Системе нужен способ вносить тонкие, зависящие от ситуации указания, не нарушая при этом целостность уже созданного плана.

Эту роль выполняет **:term[Идея-Инструкция]{canonical='Instruction Idea'}** ([204: Идея/Инструкция](./204_idea_instruction.md)). `Инструкция` — это структурированный рецепт для действия, который даёт более высокий уровень стратегических указаний. Она действует как «мысленная памятка» или набор принципов, влияющих на процесс на двух уровнях: помогает агенту выбрать или создать наиболее подходящий `План` для конкретной ситуации и даёт точечные подсказки для отдельных решений и рассуждений во время выполнения этого `Плана`. По сути, `Инструкция` улучшает *логику* и *рассуждения* в процессе, гарантируя, что и общая стратегия, и её выполнение соответствуют желаемому подходу.

> Sidenote:
> - [204: Идея/Инструкция](./204_idea_instruction.md)
