# 51: Задание/Эволюционный черновик

> [!DEFINITION] Эволюционный черновик
> Это быстрая заметка, которую мы создаём, чтобы договориться об изменениях, исправить ошибки и понять, что делать дальше, прежде чем обновлять главный документ. Представь, что это набросок перед созданием чистовой картины.
>
> Sidenote:
> - Смотри документ :term[02: Компания/Процесс]{href="./02_process.md"}, чтобы узнать, как устроен этот процесс.

## Зачем это нужно

Эволюционный черновик — это как мостик между обсуждением идеи (в так называемых Pull Request'ах) и её окончательным описанием в главном документе. Он помогает зафиксировать новую мысль или понимание, которое родилось во время разговора.

## Инструкция для Агента

Когда пользователь просит тебя создать Эволюционный черновик, тебе **ОБЯЗАТЕЛЬНО** нужно получить от него ссылку на Pull Request и указание на время.

### 1. Проверь, всё ли на месте

1.  **Ссылка на PR:** Если её нет, **ОСТАНОВИСЬ** и спроси:

    > «Пожалуйста, дай мне ссылку на Pull Request в GitHub, который нужно проанализировать».

2.  **Дата:** Если пользователь не указал, с какого дня смотреть комментарии, **ОСТАНОВИСЬ** и спроси:
    > «Пожалуйста, укажи дату в формате ГГГГ-ММ-ДД, чтобы я знал, с какого момента читать комментарии. Если хочешь, чтобы я изучил всю историю, просто напиши „Все“».

### 2. Сбор информации

**ОГРАНИЧЕНИЕ:** Тебе разрешено делать ТОЛЬКО следующие запросы в интернет:

1.  **ЗАГРУЗИТЬ** `https://idealic.academy/ru/company/02_process.md/`
2.  **ЗАГРУЗИТЬ** `https://idealic.academy/ru/company/50_truth.md/`
3.  **ЗАПРОСИТЬ** комментарии с GitHub (с помощью команды ниже)

**НЕЛЬЗЯ** скачивать содержимое других файлов, историю изменений (коммиты) или различия между файлами (диффы) по отдельности.

**Шаг 1: Скачай обязательные документы**
Ты **ДОЛЖЕН** использовать инструмент для загрузки веб-страниц и скачать их содержимое прямо по этим ссылкам. **Не ищи их в интернете.** Просто скачай эти конкретные страницы.

- [02: Компания/Процесс](https://idealic.academy/ru/company/02_process.md/)
- [50: Задание/Истина](https://idealic.academy/ru/company/00_truth.md/)

**Шаг 2: Получи комментарии (одной командой)**
Выполни именно эту команду. Замени `{PR_NUMBER}` на номер (например, 123) и `{SINCE_DATE}` на дату (например, 2025-01-01). ВАЖНО: команда скачивает все комментарии за раз (до 200 штук на страницу). Не пытайся разбивать её на части.

**СУПЕРВАЖНО**: Этот шаг очень важен. Команда группирует комментарии по веткам обсуждения, учитывает фрагменты кода, к которым они относятся, и загружает сразу много комментариев. Не пытайся её изменить, иначе результат будет неверным.

```bash
gh api "repos/{OWNER}/{REPO}/pulls/{PR_NUMBER}/comments?since={SINCE_DATE}&per_page=200" --paginate --jq 'map({id, body, user: .user.login, created_at, html_url, diff_hunk, in_reply_to_id}) | group_by(.in_reply_to_id // .id) | map(sort_by(.created_at) | .[0] as $root | [$root] + (.[1:] | map(del(.diff_hunk))))' | jq '.' > "comments_{SINCE_DATE}.json"
```

### 3. Анализ и обобщение (Язык: русский)

**Правило:** Итоговый документ должен быть на **русском языке** (кроме простых слов вроде «окей» или технических терминов).

**Метод: Умный синтез («Магия ИИ»)**
Это **НЕ** просто превращение данных из одного формата в другой. Ты должен использовать свой интеллект, чтобы сделать короткую и правдивую выжимку:

- **Пересказывай и сокращай:** Сжимай комментарии до самой сути, но не теряй смысл. Не копируй длинные куски текста.
- **Убирай «шум»:** Пропускай комментарии, которые не несут пользы или не помогают понять суть.
- **Добавляй контекст:** Если нужно, приводи только те строчки кода из обсуждения, которые важны для понимания.
- **Цель:** Создать компактный, понятный и правдивый документ.

Проанализируй полученный файл. Твоя задача — **ничего не упустить**. Каждая отдельная ветка обсуждения должна быть отражена.

**Для каждого пункта обсуждения определи:**

1.  **Что хотят сделать?** В чём главная цель?
2.  **Почему это нужно?** Какая причина или смысл у этого изменения? Собери объяснение из всего обсуждения.
3.  **Что нужно сделать?** Какие конкретные шаги?
4.  **Поменялось ли общее видение?**
5.  **Договорились или нет?** Все согласны? Или есть недопонимание?
    - Если автор **не ответил**, отметь: «Требует подтверждения».
6.  **Контекст:** Доказательства в виде цитат.

### 4. Проверка

**САМЫЙ ВАЖНЫЙ ШАГ:** Прежде чем закончить, ты должен проверить сам себя.

1.  Прочитай список пунктов, который у тебя получился.
2.  Сравни его с исходным файлом `comments_{ДАТА}.json`.
3.  **Сопоставь каждый комментарий:** Убедись, что каждый комментарий (особенно те, с которых начинаются ветки обсуждения) связан с определённым номером намерения в твоём отчёте.
4.  **Проверка на «призраков»:** Убедись, что каждый номер намерения в твоей итоговой таблице действительно существует в тексте.
    - **Исправь:** Если нашёл «призрака» (номер в таблице есть, а раздела с таким номером в тексте нет), ты **ОБЯЗАН** вернуться и написать этот недостающий раздел. Не удаляй просто строчку из таблицы, а добавь сам текст.
5.  **Задай себе вопрос:** «Я не пропустил _ни одной_ ветки обсуждения?»
6.  Если пропустил, сразу же добавь её.

### 5. Создание документа

Создай новый файл (например, `evolution_{ДАТА}.md`).

**Обязательная структура:**

```markdown
# Эволюционный черновик: {ДАТА}

> Статус: Черновик
> Источник: {ССЫЛКА_НА_PR}

## Обзор

{Краткая выжимка всего обсуждения на русском. Ответь на вопросы:}

1.  **Что предлагали проверяющие:** {Основные темы предложений и критики}
2.  **С чем согласился автор:** {Ключевые моменты, где автор поменял мнение}
3.  **Общий итог:** {Какие недопонимания были устранены, как изменилось видение}
4.  **Что было понято не так (если было):** {Перечисли конкретные пункты}
5.  **Что осталось обсудить (если есть):** {Вопросы, которые затронули, но не решили}
6.  **Новые идеи:** {Интересные мысли, которые появились во время обсуждения}
7.  **Связанные документы:** {Ссылки на другие документы, которые упоминались}

## Список намерений

<!-- Повтори этот блок для КАЖДОЙ отдельной темы из обсуждения -->

### {N}. {Короткий заголовок на русском}

- **Что хотим:** {Какую цель преследуем?}
- **Почему:** {Объяснение, зачем это изменение нужно, собранное из комментариев.}
- **Что делать:** {Конкретные шаги, которые нужно предпринять.}
- **Статус:** {Согласовано / Недопонимание / Требует уточнения / Изменение видения / Требует подтверждения}
- **Как думали раньше (если применимо):** {Кратко о том, каким было видение раньше, если оно поменялось.}
- **Итог:** {Коротко: поменялось ли видение? договорились? убрали недопонимание?}
- **Контекст:
  > [{Имя проверяющего}]({Ссылка}): «{Коротко пересказанная мысль}»
  >
  > [{Имя автора}]({Ссылка}): «{Коротко пересказанное решение}» (или «Нет ответа»)
  >
  > _Фрагмент кода:_ `{1–2 строки, если это помогает понять суть}`

---

## Отчёт о проверке

| ID комментария | Суть (заголовок) | № намерения | Статус          |
| ------------- | ----------------- | -------- | --------------- |
| [{ID}]({URL}) | {3-6 слов}     | {N}      | Учтено        |
| [{ID}]({URL}) | {3-6 слов}     | -        | Пропущено (шум) |
```
