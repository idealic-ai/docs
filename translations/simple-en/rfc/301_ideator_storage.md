# 301: Идеатор/Хранилище

## 1. Введение

Этот документ описывает **Систему: Хранилище**. Представь себе огромную волшебную библиотеку, созданную специально для `Идей`. Эта система и есть та самая библиотека.

Её главная задача — брать `Идеи`, надёжно сохранять их и присваивать им уникальный номер, как на книжке в библиотеке. Это как память для всей системы, где `Идеи` хранятся и ждут, пока они не понадобятся другим сервисам, например, [Системе: Поисковик](./202_ideator_resolver.md), которая умеет их находить.

## 2. Основная концепция: Хранилище как трансформатор Идей

Хранилище работает как специальная машина: ты кладёшь в неё `Идею`, она что-то с ней делает и возвращает её тебе.

- **Что на входе**: `Идея`, состоящая из трёх частей (`схема`, `решение`, `контекст`).
- **Что происходит**: Машина получает твою `Идею`, даёт ей уникальный адрес (который также включает номер версии) и кладёт её на вечное хранение в надёжное место (например, в базу данных).
- **Что на выходе**: Машина возвращает тебе твою же `Идею`. Это как квитанция, подтверждающая, что всё сохранено. К ней может быть прикреплена записка с новым адресом и версией твоей `Идеи`.

## 3. Ключевые характеристики

### 3.1. Хранение по принципу «чёрного ящика»

Представь Хранилище как волшебный сундук. Ты просто кладёшь в него свою `Идею`, и он гарантирует, что она будет в целости и сохранности. Тебе не нужно знать, из какого дерева сделан сундук, какие на нём замки или как он устроен внутри. Ты просто доверяешь ему свои `Идеи`, а он их надёжно хранит.

### 3.2. Версионирование и неизменность

Эта система никогда ничего не стирает. Если ты хочешь «обновить» `Идею`, Хранилище не будет исправлять старую запись. Вместо этого оно создаст новую копию с твоими изменениями и сохранит её как «версию 2».

Таким образом, сохраняется полная история всех изменений, и ты всегда можешь вернуться и посмотреть, как `Идея` выглядела раньше. Это как разные издания одной книги: когда выходит второе издание, первое никуда не исчезает.

### 3.3. Адресация по содержимому

Каждая `Идея`, сохранённая в Хранилище, получает свой уникальный адрес. Это похоже на то, как у каждой страницы в интернете есть своя ссылка. Благодаря этому адресу любую `Идею` и любую её версию можно найти точно и без путаницы.

## 4. Публичный интерфейс

У этой системы очень простая задача, поэтому и взаимодействовать с ней можно только одним способом.

- **Основное действие**: Единственное, что можно сделать, — это отдать `Идею` на хранение.

- **Поиском занимается другой**: Чтобы не было путаницы, Хранилище не занимается поиском и выдачей `Идей`. Эту работу выполняет другой сервис — **Поисковик** (Resolver).

Представь себе почтовое отделение. Один сотрудник (Хранилище) только принимает и раскладывает посылки по полкам. А другой сотрудник (Поисковик) помогает тебе найти и забрать нужную посылку. Так у каждого своя простая и понятная задача.