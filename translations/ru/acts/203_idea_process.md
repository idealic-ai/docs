# 203: Идея/Процесс

> [!DEFINITION] [:term[Идея Процесса]{canonical="Process Idea"}](./000_glossary.md)
> Автономная [:term[Идея]{canonical="Idea"}](./101_concept_idea.md), которая содержит стратегический [:term[План]{canonical="Plan"}](./012_agent_plan.md) и его текущее состояние исполнения. Её `schema` — это библиотека [:term[Инструментов]{canonical="Tool"}](./002_agent_tool.md), её `solution` — это _новый_ `Plan` для текущего такта, а её `context` содержит `Input`, `State` и предыдущий `Plan`.

> Sidenote:
> - Требуется:
>   - [101: Концепция/Идея](./101_concept_idea.md)
>   - [011: Агент/План](./012_agent_plan.md)
>   - [009: Агент/Состояние](./009_agent_state.md)
>   - [006: Агент/Ввод](./006_agent_input.md)
> - Дополняется:
>   - [012: Агент/Экземплирование](./013_agent_instancing.md)

В то время как [:term[202: Идея/Носитель]{canonical="202: Idea/Vessel"}](./202_idea_vessel.md) фиксирует единичное реактивное решение, **:term[Идея Процесса]{canonical="Process Idea"}** представляет собой проактивный и стратегический рабочий процесс. Это артефакт, создаваемый системой [:term[011: Агент/План]{canonical="011: Agent/Plan"}](./012_agent_plan.md) при организации сложной, многоэтапной задачи во времени. Это делает её полной записью как возможностей, доступных для рабочего процесса, так и конкретной стратегии, выбранной агентом.

## Анатомия Плана

`Process Idea` использует триплет `Idea` для предоставления полного снимка рабочего процесса. Этот снимок содержит не только выбранную агентом стратегию (`Plan`), но и полную библиотеку возможностей и текущее состояние исполнения.

- **`schema` (Палитра):** Определяет библиотеку всех доступных [:term[Инструментов]{canonical="Tool"}](./002_agent_tool.md), из которых может быть построен `Plan`. Она представляет полный набор возможностей агента.

- **`context` (Ситуационная осведомлённость):** Содержит всю информацию, необходимую агенту для планирования и выполнения текущего такта.
  - **Входное Сообщение:** Первоначальный стимул, который запустил весь процесс. Обычно предоставляется только один раз и остается неизменным.

    > Sidenote:
    > - [006: Агент/Ввод](./006_agent_input.md)

  - **Сообщение о Состоянии:** Актуальные, изменяющиеся данные рабочего процесса. Оно содержит сохраненные локальные переменные, которые образуют связи (ребра) между :term[Вызовами]{canonical="Call"} в `Plan`.

    > Sidenote:
    > - [009: Агент/Состояние](./009_agent_state.md)

  - **Сообщение о Плане:** Это сообщение содержит _утвержденный_ план с предыдущего такта, который агент может либо выполнить, либо скорректировать.

    > Sidenote:
    > - [011: Агент/План](./012_agent_plan.md)

- **`solution` (Новый План):** Направленный ациклический граф :term[Вызовов]{canonical="Call"}, который является выбранной стратегией агента на _текущий_ такт. Он становится `Plan Message` для следующего такта.

### Единство планирования и исполнения

Основной принцип этой архитектуры — слияние планирования и исполнения в единый, унифицированный процесс. В отличие от традиционных систем, где эти фазы разделены, здесь они происходят одновременно в рамках каждого такта. Агент не просто создает статический план, а затем отдельно его выполняет; сам акт создания следующего `solution` (нового `Plan`) _является_ шагом исполнения для текущего такта.

Именно это единство делает систему такой динамичной и эффективной. `Plan` — это живой граф, которому не обязательно быть полным, чтобы быть полезным. Он может быть частичным, работать с результатами предыдущего такта и адаптироваться на лету. :term[Вызовы]{canonical="Call"}, генерируемые LLM, представляют собой как структуру конвейера, так и сообщения, передаваемые внутри него. Эта двойственность позволяет одному запросу к LLM одновременно проверять текущее состояние, корректировать план на основе новых данных и выполнять следующий логический шаг. Нет никаких дорогостоящих накладных расходов на отдельные вызовы для перепланирования или проверки; исполнение _это_ и есть проверка, планирование и корректировка, происходящие одновременно.

> Sidenote:
> - [004: Агент/Вызов](./004_agent_call.md)

Эта единая модель дает два мощных преимущества. Во-первых, `Plan` можно создать и симулировать на основе только его схем, еще до того, как появятся конкретные данные. LLM может "сыграть роль" поведения каждого шага, что позволяет проектировать и проверять сложные рабочие процессы с самого начала. Во-вторых, LLM выступает в роли интеллектуального адаптера между шагами. Если выход одного :term[Вызова]{canonical="Call"} не полностью соответствует ожидаемому входу следующего, LLM может устранить этот разрыв, обеспечивая исключительную стабильность по мере развития системы. Эта устойчивость предотвращает каскадные сбои, характерные для традиционных, жестко связанных систем.

> Sidenote:
> - [105: Концепция/ИИ-центричность](./105_concept_ai_native.md)

### Спектр гибкости Плана

Объект :term[Состояния]{canonical="State"} обеспечивает мощный трехэтапный жизненный цикл для `Plan`, позволяя ему развиваться от гибкого процесса обнаружения до предсказуемого, детерминированного рабочего процесса:

> Sidenote:
> - [009: Агент/Состояние](./009_agent_state.md)

1.  **План в свободной форме:** Изначально :term[Состояние]{canonical="State"} может быть определено без `schema`. Это дает агенту максимальную свободу для нахождения `Plan` путем создания новых связей (свойств в объекте `State`) на лету.

2.  **Определенные связи:** Следующий шаг в "закалке" `Plan` — заморозить `schema` :term[Состояния]{canonical="State"}, которая определяет основные пути передачи данных. Это можно сделать в спектре от более гибкого к менее гибкому:
    - **Открытые связи:** Схема может разрешать `additionalProperties`, что обеспечивает соблюдение основных путей данных, но при этом дает агенту свободу создавать новые связи для второстепенных или исключительных путей.
    - **Закрытые связи:** Схема может устанавливать `additionalProperties` в `false`, создавая жесткую структуру, которой агент должен точно следовать.

3.  **Завершенный План:** Это финальная стадия, на которой план считается полностью зрелым и предсказуемым. **Завершенный План** становится **Утвержденным Планом**, который передается как `Plan Message` в `context` для последующих тактов. Завершенный план может существовать в двух формах стабильности:
    - **"Счастливый" План:** Завершенный план, который охватывает идеальный случай. Он обеспечивает высокоэффективный путь, но может потребовать корректировки в случае непредвиденных событий.
    - **Полный План:** Полностью завершенный план, который со временем был расширен для учета распространенных сбоев, альтернатив и других сценариев, что делает его высоко детерминированным.

Такая последовательность позволяет :term[Идее Процесса]{canonical="Process Idea"} развиваться от гибкого проекта до высоконадежного и многократно используемого актива.

## Неизменяемые рабочие процессы: Оркестрация, анализ и масштабирование

Сила :term[Идеи Процесса]{canonical="Process Idea"} заключается в её неизменяемости. Каждый шаг рабочего процесса создает новый, полный снимок `Plan` и :term[Состояния]{canonical="State"}, сохраняя идеальную, проверяемую историю. Этот основной принцип создания цепочки неизменяемых артефактов и обеспечивает самые передовые возможности системы для оркестрации, анализа и масштабирования.

- **Надежное, адаптивное исполнение:** Цикл исполнения, основанный на "тактах", фундаментально надежен, потому что каждый новый такт работает с полным снимком предыдущего состояния. Эта атомарность предотвращает состояния гонки и гарантирует, что решение агента следовать или корректировать `Plan` основано на последовательном и предсказуемом видении мира. Результатом каждого такта является новая :term[Идея Процесса]{canonical="Process Idea"}, безопасно продвигающая рабочий процесс на один шаг вперед.

  > Sidenote:
  > - [010: Агент/Цикл](./010_agent_loop.md)
  > - [011: Агент/План](./012_agent_plan.md)

- **Устойчивая оркестрация:** :term[Идея Процесса]{canonical="Process Idea"} — это самодостаточный артефакт, что делает оркестрацию невероятно надежной. Рабочий процесс можно приостановить, просто сохранив его последний снимок. Внешние системы или люди-супервизоры могут затем изучить это замороженное состояние для принятия решений. Любые корректировки, такие как перепланирование или изменение состояния, приводят к созданию _новой_ :term[Идеи Процесса]{canonical="Process Idea"}, которая затем может быть использована для безопасного возобновления рабочего процесса без изменения исторической записи.

  > Sidenote:
  > - [009: Агент/Состояние](./009_agent_state.md)

- **Высокоточное моделирование:** Эта архитектура является необходимым условием для интерактивного "путешествия во времени". Каждая историческая :term[Идея Процесса]{canonical="Process Idea"} — это идеальный, высокоточный снимок рабочего процесса в определенный момент. Это позволяет пользователям или другим агентам загружать любую точку в истории процесса для проведения аудита, отладки сложного поведения или запуска сценариев "что, если" путем ветвления процесса с этой точки.

  > Sidenote:
  > - [202: Идея/Носитель](./202_idea_vessel.md)

- **Согласованная параллельная обработка:** Архитектура на основе снимков достигает огромного масштаба благодаря протоколу :term[Экземплирования]{canonical="Instancing"}. Этот паттерн рассматривает каждую задачу в пакете как независимый поток выполнения, каждый со своим изолированным снимком `State`. Единый `Plan` действует как стратегический шаблон, применяемый ко всем потокам одновременно. За один атомарный такт агент выполняет параллельное планирование для всего пакета, создавая согласованный набор :term[Вызовов]{canonical="Call"}, адаптированный для каждого экземпляра. Это гарантирует последовательный результат для разнообразных задач, одновременно значительно повышая эффективность.

  > Sidenote:
  > - [012: Агент/Экземплирование](./013_agent_instancing.md)

## От предсказуемого Плана к управляемому исполнению

:term[Идея Процесса]{canonical="Process Idea"} может созреть до **Завершенного Плана** — высокопредсказуемого и надежного рабочего процесса. Хотя эта жесткость обеспечивает стабильность, она также может ограничивать гибкость. Системе нужен способ вводить тонкие, контекстно-зависимые указания, не жертвуя целостностью установленного плана.

Эту роль выполняет **[:term[Идея Инструкции]{canonical="Instruction Idea"}](./204_idea_instruction.md)**. :term[Инструкция]{canonical="Instruction"} — это структурированный рецепт действий, который обеспечивает более высокий уровень стратегического руководства. Она действует как "ментальный чек-лист" или набор принципов, влияющих на рабочий процесс на двух уровнях: направляя агента при выборе или создании наиболее подходящего `Plan` для данного контекста и предоставляя целенаправленное руководство для отдельных выборов и этапов рассуждения во время выполнения этого `Plan`. По сути, :term[Инструкция]{canonical="Instruction"} улучшает _логику_ и _рассуждения_ рабочего процесса, обеспечивая соответствие как общей стратегии, так и тактического исполнения желаемой методологии.

> Sidenote:
> - [204: Идея/Инструкция](./204_idea_instruction.md)
