# 007: Агент/Переменные

> [!DEFINITION] [Ссылка на переменную](./000_glossary.md)
> Строка со специальным синтаксисом (`†<тип>.<путь>`), используемая в параметрах :term[вызова инструмента]{canonical="Call"} для динамической ссылки на значение из контекста агента.

:term[Переменные]{canonical="Variable"} основаны на системе [Данных](./005_agent_data.md) для обеспечения динамических потоков данных. Они делают структурированную информацию интерактивной, позволяя :term[вызовам инструментов]{canonical="Tool Call"} ссылаться на значения, существующие в контексте агента (например, сообщение :term[ввода]{canonical="Input"} или :term[состояния]{canonical="State"}), без необходимости прямого копирования данных в их параметры.

## Чтение из контекста

Параметр в :term[вызове инструмента]{canonical="Call"} может содержать **ссылку на переменную** — специальную строку, указывающую на значение в другом месте контекста, — вместо самого значения. Это предотвращает неэффективный и подверженный ошибкам процесс, когда LLM копирует большие объекты данных из своего контекста в параметры :term[вызова инструмента]{canonical="Call"}. Использование ссылки быстрее, дешевле и надежнее, так как исключает риск изменения данных LLM при их воспроизведении.

Ссылка представляет собой простой строковый синтаксис с префиксом в виде крестика (`†`). Синтаксис таков: `†<тип>.<путь>`, где `<тип>` — это тип сообщения с :term[данными]{canonical="Data"} (например, `state`, `input`), а `<путь>` — это путь к желаемому значению в точечной нотации.

> Sidenote:
> - Википедия: [Крестик (знак)](<https://en.wikipedia.org/wiki/Dagger_(mark)>)

::::columns
:::column{title="Параметры инструмента, использующие переменные"}

```json
{
  "_tool": "greetUser",
  "userName": "†input.userName"
}
```

:::
:::column{title="Эквивалентный код на Typescript"}

```typescript
greetUser({
  userName: input.userName,
});
```

:::
::::

## Взаимодействие с другими системами

- **:term[Данные]{canonical="Data"}:** Переменные — это механизм, который делает сообщения с :term[данными]{canonical="Data"} интерактивными. :term[Ссылки на переменные]{canonical="Variable Reference"} читают из сообщений с :term[данными]{canonical="Data"} (таких как :term[ввод]{canonical="Input"} или :term[состояние]{canonical="State"}), а :term[пути вывода]{canonical="Output Path"} записывают данные обратно, создавая динамический цикл, в котором данные можно получать и изменять.

  > Sidenote:
  > - [005: Агент/Данные](./005_agent_data.md)

- **:term[Ввод]{canonical="Input"}:** :term[Ссылки на переменные]{canonical="Variable Reference"} могут указывать на сообщения :term[ввода]{canonical="Input"}, что позволяет параметризовать рабочий процесс. Это необходимо для создания воспроизводимых планов, в которых общая структура определена, а конкретные данные для работы предоставляются во время выполнения.

  > Sidenote:
  > - [006: Агент/Ввод](./006_agent_input.md)

- **:term[Состояние]{canonical="State"}:** Объект :term[состояния]{canonical="State"} является основной рабочей областью для переменных в многоэтапных рабочих процессах. Это наиболее частая цель для :term[путей вывода]{canonical="Output Path"}, поскольку состояние сохраняется между тактами цикла выполнения агента, позволяя одному шагу оставлять результат, который сможет прочитать следующий шаг.

  > Sidenote:
  > - [009: Агент/Состояние](./009_agent_state.md)

- **:term[План]{canonical="Plan"}:** Переменные — это фундаментальная технология, лежащая в основе системы :term[планов]{canonical="Plan"}. Сообщение с :term[планом]{canonical="Plan"} содержит граф :term[вызовов инструментов]{canonical="Call"}, где соединения (ребра) формируются :term[ссылками на переменные]{canonical="Variable Reference"}, указывающими на :term[пути вывода]{canonical="Output Path"}. Это позволяет агенту определять полный, исполняемый рабочий процесс в виде единой, декларативной структуры данных.

  > Sidenote:
  > - [011: Агент/План](./011_agent_plan.md)

## От эфемерных соединений к постоянной памяти

:term[Переменные]{canonical="Variable"} предоставляют механизм для связывания данных с инструментами в рамках одного атомарного запроса. Однако для создания сложных агентов, выполняющих задачи в несколько шагов, требуется более устойчивая форма памяти — «рабочая область», где результаты могут храниться и быть доступными для нескольких независимых запросов в цикле выполнения.

Следующий документ, [008: Агент/Вывод](./008_agent_output.md), описывает механику записи результатов в контекст.
