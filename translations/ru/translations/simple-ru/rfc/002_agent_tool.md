# 002: Агент/Инструмент

> **Инструмент**: Это как чертёж, который описывает способность агента (нашего ИИ). Этот чертёж показывают большой языковой модели (LLM), чтобы она поняла, какое действие можно совершить. Модель активирует инструмент, создавая «Вызов» (Call) с конкретными деталями. Этот вызов выполняет либо сама модель в уме (скрыто), либо специальная программа, которая для этого предназначена («Действие»). — [Глоссарий](./000_glossary.md)

> Sidenote: - Требует: [001: Агент/Запрос](./001_agent_request.md)
> - Дополняется: [003: Агент/Действие](./003_agent_activity.md)

Этот документ объясняет, что такое Инструмент — это как инструкция или чертёж, который помогает агентам понимать и использовать разные способности.

## Что такое Инструменты?

Представь, что агент — это персонаж в компьютерной игре. **Инструменты — это его суперспособности или заклинания.** Они дают ему новую крутую возможность: **выбирать, что делать в конкретной ситуации**. С помощью инструментов агент может посмотреть на происходящее и решить, какую способность лучше применить.

Что дают Инструменты:

- **Понятные инструкции**: У каждой способности есть чёткое описание, чтобы агент знал, что она делает.
- **Никаких ошибок**: Указано, что нужно дать на вход и что получится на выходе. Всё как в аптеке.
- **Конструктор LEGO**: Из простых инструментов-кубиков можно собирать сложные действия, как из LEGO.
- **Понятность для ИИ**: Инструкции написаны так, что языковая модель (мозг агента) может их прочитать, понять и выбрать нужную.

Когда агент решает использовать Инструмент и заполняет все нужные детали (например, какое слово перевести или какую картинку найти), он создаёт **Вызов (Call)**. Это как команда «используй эту способность прямо сейчас!». Подробнее о том, как исполняются вызовы, читай в документе [004: Агент/Вызов](./004_agent_call.md).

> **Заметка**: Любой запрос к искусственному интеллекту можно представить как простую «Идею» (это хорошо работает для создания текстов или картинок). Но Инструменты нужны для более сложных задач, где нужно выбирать из разных действий. О том, как из «Идеи» сделать «Инструмент», можно почитать в [007: Агент/Ввод](./007_agent_input.md).

## Когда стоит использовать Инструменты

Используй систему Инструментов, когда твоему агенту нужно:

- **Думать на ходу** и выбирать действия в зависимости от ситуации.
- **Выбирать из нескольких способностей**, чтобы достичь цели (например, искать в Google или в Википедии).
- **Использовать разные программы** для одной и той же задачи (например, разные поисковики).
- **Совмещать размышления ИИ с чёткими командами** при принятии решений.

## Как устроена система Инструментов

### Главный принцип: Чертёж — это описание

Система Инструментов построена на одной простой идее: **Инструменты — это просто чертежи**. Они описывают, *что* можно сделать, но не *как* это делать. А вот само выполнение задачи берёт на себя либо мозг ИИ (языковая модель), либо специальная программа под названием **[Действие](./003_agent_activity.md)**.

В чертеже Инструмента указано:

- **Что он делает** (описание).
- **Что ему нужно для работы** (входные данные).

> Sidenote: Расширения:
> 
> - `_instance`: Смотри [011: Агент/Инстансинг](./011_agent_instancing.md)
> - `_module`: Смотри [009: Агент/Модуль](./009_agent_module.md)

- **Что он выдаёт в результате** (структура `_output`).
- **Как он называется** (имя `_tool`).
- **Как его выполнить** (поле `_activity`, подробнее в [003: Агент/Действие](./003_agent_activity.md)).

### Специальные поля в чертежах

В чертежах Инструментов есть специальные поля (они начинаются с подчёркивания `_`), которые несут служебную информацию:

- **_tool**: Уникальное имя инструмента (обязательно).
- **_activity**: Указывает, какая программа-«Действие» должна выполнить этот инструмент, если она нужна. Подробнее об этом в [003: Агент/Действие](./003_agent_activity.md).
- **_output**: Описание того, что мы ожидаем получить в результате.
- **_reasoningForCall**: Объяснение агента, почему он решил использовать именно этот инструмент (добавляется системой).

Любое поле без подчёркивания — это обычный параметр, который нужен инструменту для работы. Служебные поля всегда идут первыми, чтобы ИИ было проще и понятнее их читать.

### Границы ответственности

За что отвечает система Инструментов:

- **Регистрация Инструментов**: хранит все чертежи и описания.
- **Заполнение деталей**: помогает ИИ извлечь из разговора нужную информацию и передать её инструменту.
- **Направление на исполнение**: решает, должен ли ИИ выполнить задачу сам «в уме» или передать её внешней программе («Действию»).

Более сложные вещи, вроде управления цепочками задач или состоянием, строятся поверх этой простой системы (например, протокол [004: Агент/Вызов](./004_agent_call.md)).

## Определение Инструмента

Инструменты описываются в формате JSON Schema. Вот пример Инструмента, который определяет, какая эмоция (настроение) заложена в тексте. Он рассчитан на то, что ИИ выполнит его сам, «в уме», потому что для понимания текста ему не нужны внешние программы.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует настроение текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Комбинация чертежей и Вызов

Один инструмент — это хорошо, но настоящая магия начинается, когда их много. Система показывает ИИ сразу все доступные ему Инструменты, как меню в ресторане. Это позволяет ИИ выбрать самый подходящий для конкретной задачи. Когда ИИ выбрал Инструмент и вписал в него все нужные данные, он создаёт **Вызов (Call)**. Это и есть готовая к исполнению команда — основная единица действия, которая передаётся дальше на выполнение.

> Sidenote: - [004: Агент/Вызов](./004_agent_call.md).

## Скрытое и явное выполнение

Сам по себе чертёж Инструмента — это просто описание. А вот выполнение команды (Вызова) может происходить двумя способами. Первый, по умолчанию, — это **скрытое выполнение**: ИИ использует свой собственный «мозг», чтобы выдать результат. Это идеально для задач, связанных с языком или знаниями. Второй способ нужен, когда нужно взаимодействовать с реальным миром — например, зайти на сайт или посмотреть в базу данных. Для этого Инструмент нужно соединить с настоящей программой. Такое исполнение называется **явным**, а программа-исполнитель — **Действием (Activity)**.

Разделение чертежа (Инструмента) от исполнителя (Действия) — это очень важная идея. Она позволяет агенту сначала «подумать» о своих возможностях в общем, а уже потом решать, как именно их применить. А саму программу-исполнитель можно легко поменять или обновить, не трогая чертёж. Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, расскажет, как «Действия» оживляют «Инструменты».

> Sidenote: - [003: Агент/Действие](./003_agent_activity.md).
