# 002: Агент/Инструмент

> **Инструмент**: Это как описание суперспособности, которую может использовать искусственный интеллект (агент). Когда агенту дают задачу, ему показывают список всех его «инструментов». Он выбирает нужный и заполняет его, чтобы совершить действие. Это как выбрать приложение на телефоне и ввести в него данные. — [Глоссарий](./000_glossary.md)

> Sidenote:
> 
> *   Нужен для понимания: [001: Агент/Запрос](./001_agent_request.md)
> *   Следующий шаг: [003: Агент/Действие](./003_agent_activity.md)

Этот документ объясняет, что такое Инструменты. Это очень важная вещь, которая помогает агентам понимать, какие у них есть возможности, и использовать их.

## Что такое Инструменты?

Представь, что агент — это супергерой. **Инструменты — это его суперспособности.** Без них он может только разговаривать. С инструментами он может делать что-то конкретное: искать в интернете, рисовать картинки, проверять погоду.

Инструменты дают агенту:

- **Понятные инструкции**: Каждый инструмент — это как инструкция к суперспособности. Агент читает её и понимает, что она делает и какая информация ей нужна.
- **Надёжность**: Инструкция чётко говорит, что нужно дать на вход (например, город для прогноза погоды) и что получится на выходе (температура и облачность). Никакой путаницы!
- **Возможность комбинировать**: Агент может использовать несколько инструментов вместе, чтобы выполнять сложные задачи, как будто собирает что-то из кубиков LEGO.
- **Умение выбирать**: Когда агент получает задачу, он смотрит на все свои инструменты и решает, какой из них лучше всего подходит для её решения.

Когда агент выбрал инструмент и ввёл в него все нужные данные (например, выбрал «поиск картинок» и ввёл «милый котёнок»), это называется **Вызов**. Вызов — это команда «сделай это прямо сейчас!». (Подробнее об этом в документе [004: Агент/Вызов](./004_agent_call.md)).

> **Примечание**: Любую задачу для агента можно описать как простую «Идею». Но Инструменты нужны для более крутых штук, когда агенту нужно самому выбирать, что делать. Представь, что «Идея» — это просто сказать «нарисуй кота», а «Инструмент» — это дать ему палитру с красками и кисточками, чтобы он сам выбрал, как рисовать.

## Когда нужно использовать Инструменты

Инструменты нужны, когда агент должен:

- **Сам выбирать, что делать**, в зависимости от ситуации.
- **Выбирать из нескольких вариантов**, чтобы решить задачу (например, искать в Google или в Яндексе).
- **Использовать разные программы** для одной и той же задачи (например, два разных приложения для рисования).
- **Сочетать своё «мышление» с выполнением настоящих программ**, чтобы принимать решения.

## Как устроена система Инструментов

### Главный принцип: Инструкция отдельно от действия

Самое важное правило: **инструмент — это просто инструкция**. Она описывает, что можно сделать, но сама ничего не делает. Это как рецепт в поваренной книге. А готовит по этому рецепту либо сам агент, используя свой «ум» (скрытое выполнение), либо специальная программа, которая называется **[Действие](./003_agent_activity.md)**.

В инструкции к инструменту написано:

- **Что он делает** (например, «находит картинки в интернете»)
- **Что ему нужно для работы** (какие данные ввести)
  > Sidenote: о расширениях:
  > 
  > *   `_instance`: Смотри [011: Агент/Инстансинг](./011_agent_instancing.md)
  > *   `_module`: Смотри [009: Агент/Модуль](./009_agent_module.md)
- **Что он вернёт в результате** (какой будет результат)
- **Как он называется** (уникальное имя, например, `поиск_картинок`)
- **Кто его выполняет** (если нужна специальная программа, здесь будет её имя)

### Специальные поля в инструкции

В инструкциях есть специальные поля, которые начинаются с нижнего подчёркивания `_`. Это служебная информация, как пометки на полях для системы.

- **`_tool`**: Имя инструмента (обязательно).
- **`_activity`**: Указывает, какая программа-«Действие» должна выполнить эту работу.
- **`_output`**: Описывает, как будет выглядеть результат.
- **`_reasoningForCall`**: Агент сюда записывает, почему он решил использовать именно этот инструмент.

Обычные поля без `_` — это то, что нужно ввести для работы инструмента. Системные поля всегда идут первыми.

### За что отвечает система

Система Инструментов похожа на операционную систему в телефоне. Она:

- Хранит все «инструкции» к инструментам (как список приложений).
- Помогает агенту заполнить нужные поля.
- Решает, кто будет выполнять задачу: сам агент своим умом или специальная программа-«Действие».

Более сложные вещи, вроде управления цепочками действий, строятся уже поверх этой системы.

## Как описать Инструмент

Инструменты описываются на специальном языке JSON-схем. Вот пример инструмента, который определяет настроение текста. Ему не нужна внешняя программа, потому что агент сам умеет понимать текст. Он выполнит это «скрыто», то есть своим умом.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует тональность текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Выбор инструмента и Вызов

Сила инструментов в том, что агент может выбирать из них. Система показывает ему сразу все доступные инструкции. Агент читает их и решает, какая лучше всего подходит для текущей задачи. Когда он выбрал инструмент и заполнил все его поля нужными данными, он создаёт **Вызов**. Это готовая к исполнению команда.

> Sidenote: Конкретный запрос на выполнение действия называется **Вызов**. Прочитай о нём здесь: [004: Агент/Вызов](./004_agent_call.md).

## «Скрытое» и «Явное» выполнение

Сама по себе инструкция к инструменту — это просто текст. А вот выполнить её можно двумя способами.

1.  **Скрытое выполнение**: Агент использует свой собственный «мозг», чтобы найти ответ. Это хорошо подходит для задач, связанных с языком или знаниями, например, «Перескажи этот текст» или «Этот отзыв положительный или отрицательный?».

2.  **Явное выполнение**: Для задач, где нужно что-то сделать во внешнем мире (поискать в интернете, проверить погоду), инструмент связывают с настоящей программой. Эта программа называется **Действие**.

Разделение инструкции (**Инструмент**) и реального исполнителя (**Действие**) — это очень умный ход. Он позволяет агенту рассуждать о своих возможностях в общем, а программисты могут легко менять или обновлять сами программы, не трогая инструкции.

Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, как раз расскажет о том, как «Действия» выполняют работу для «Инструментов».