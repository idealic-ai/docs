# 004: Агент/Вызов

> **Вызов:** Представь, что **Инструмент** — это кнопка на пульте, например «Переключить канал». А **Вызов** — это когда ты нажимаешь на эту кнопку и вводишь конкретный номер, например, «5». Это реальная команда *сделать что-то прямо сейчас*.
>
> — [Глоссарий](./000_glossary.md)

> Sidenote:
> 
> - Требует:
>   - [103: Концепция/Идеатор](./103_concept_ideator.md)
> - Открывает возможности для:
>   - [008: Агент/Импорты](./008_agent_imports.md)
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)
>   - [202: Идея/Контейнер](./202_idea_vessel.md)
>   - [203: Идея/Процесс](./203_idea_process.md)

**[Идея](./101_concept_idea.md)** — это как чертёж, по которому что-то делается. **[Инструмент](./002_agent_tool.md)** превращает этот чертёж в рабочую кнопку, понятную для ИИ-агента. Этот документ объясняет, что такое **Вызов** — то есть, что происходит, когда агент нажимает на эту кнопку.

**Вызов** — это конкретная команда для Инструмента, со всеми уточнениями, готовая к исполнению. Если Инструмент описывает, *что можно сделать*, то Вызов — это о том, *как именно это сделать*.

## Путешествие от Идеи к Вызову

Представь, что ты печёшь торт. Вот как это работает:

1.  **Идея**: Это твой рецепт. В нём есть все инструкции и знания о том, как испечь торт.
2.  **Инструмент**: Рецепт используется для создания кнопки «Испечь торт» на умной печи. Теперь печь знает, какие ингредиенты ей нужны (например, мука, сахар, яйца) и что она может делать.
3.  **Вызов**: Это когда ты говоришь печи: «Испеки торт, используя шоколад *этой марки*, в течение *30 минут* при *180 градусах*». Ты заполнил все пробелы и дал конкретную, окончательную команду. Вызов — это и есть та самая, единственная команда для Инструмента.

Главное правило простое: **любая Идея может стать Инструментом, а любой Инструмент можно использовать в Вызове.**

Чтобы узнать больше о том, как «список покупок» Идеи (входные данные) превращается в настройки для Инструмента, загляни в документ **[007: Агент/Ввод](./007_agent_input.md)**.

## Ручки управления: Область и Метод

Когда ты делаешь Вызов, ты можешь менять способ его выполнения с помощью двух «ручек управления»: **Область** (где он выполняется) и **Метод** (как он выполняется). Система понимает, как ты повернул ручки, по специальным инструкциям в настройках Инструмента (`_module`, `_activity`, `_output`).

### Два главных элемента управления

1.  **Область (Где выполняется? Здесь или у специалиста?)**
    Область решает, будет ли агент делать работу сам или передаст её кому-то другому.
    - **Здесь (Локальная область)**: Это стандартный вариант. Агент выполняет задачу сам. Это как если бы повар нарезал овощи на своём рабочем месте.
    - **Специалист (Модульная область)**: Этот вариант включается инструкцией `_module`. Это как если бы повар отдал заказ пекарю в другой части кухни. Задача передаётся эксперту.

2.  **Метод (Как выполняется? По рецепту или творчески?)**
    Метод решает, будет ли задача выполняться по чётким инструкциям или с использованием творчества.
    - **По рецепту (Явный метод)**: Включается инструкцией `_activity`. Задача выполняется по чётким шагам, как робот, следующий программе. Никаких догадок.
    - **Творчески (Скрытый метод)**: Это стандартный вариант, если нет инструкции `_activity`. Агента (модель ИИ) просят самому придумать лучший способ что-то сделать. Для этого может понадобиться инструкция `_output`, которая похожа на просьбу к творческому повару: «Мне неважно, как ты это сделаешь, просто приготовь вкусный суп».

Эти элементы управления можно смешивать и сочетать, чтобы создавать самые разные способы выполнения работы. Чтобы узнать, как это работает, загляни в **[008: Агент/Импорты](./008_agent_imports.md)**.

## Строим большие вещи с помощью Вызовов

`Вызов` — это как один кубик Lego. Сам по себе он простая команда. Но ты можешь соединить много Вызовов вместе, чтобы построить что-то гораздо более крупное и сложное. Например, можно построить целый **[Контейнер](./202_idea_vessel.md)** или **[Процесс](./203_idea_process.md)**.

`Контейнер` — это как полный набор Lego в коробке. В нём есть всё необходимое для одной большой задачи: инструкция (`context`), список всех доступных кубиков (`schema` из `Инструментов`) и то, что агент в итоге решит построить (`solution` — список из одного или нескольких `Вызовов`, которые нужно запустить).

> Sidenote:
> 
> - [202: Идея/Контейнер](./202_idea_vessel.md)
> - [203: Идея/Процесс](./203_idea_process.md)

## Разные способы запускать Вызовы

Когда агент решает сделать несколько Вызовов сразу, ты можешь выбрать, как их запустить.

```typescript
// Выполнить только один Вызов
const result = await Tool(call);

// Выполнить все. Не продолжать, пока не закончится каждый из них.
const results = await Tool.all(calls);

// Попробовать все. Вернуть результат первого, который сработает.
const result = await Tool.any(calls);

// Это гонка! Запустить все и вернуть результат самого первого, который завершится, неважно, успешно или с ошибкой.
const result = await Tool.race(calls);
```

Эти подходы позволяют тебе:

- **Действовать шаг за шагом**: Обрабатывать каждый Вызов по одному, добавляя свою логику между ними.
- **Работать пачками**: Запускать кучу независимых Вызовов одновременно, чтобы было быстрее.
- **Найти быстрое решение**: Останавливаться, как только найдётся один работающий Вызов (`.any()`) или как только завершится любой Вызов (`.race()`).
- **Добиться успеха вместе**: Убедиться, что вся группа Вызовов завершилась успешно. Это помогает сохранять порядок, когда они зависят друг от друга (`.all()`).