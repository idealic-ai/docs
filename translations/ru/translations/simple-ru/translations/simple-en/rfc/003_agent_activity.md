# 003: Агент/Действие

> **Действие (Activity):** Представь, что `Действие` — это реальная работа, которая стоит за `Инструментом`. Если `Инструмент` — это кнопка «Проверить погоду», то `Действие` — это компьютерный код, который подключается к погодному сервису и получает информацию. Это нужно для задач, которые ИИ не может просто «вспомнить» из своей памяти, например, для общения с другими сайтами или проверки базы данных. — [Глоссарий](./000_glossary.md)

> Sidenote: Это продолжение того, что мы узнали в [002: Агент/Инструмент](./002_agent_tool.md).

Этот документ объясняет, как `Инструменты` получают свою силу от настоящего, исполняемого кода. `Инструмент` говорит, *что* делает специальная способность, а **`Действие`** — это код, который на самом деле показывает, *как* она это делает.

## Две книги рецептов

Чтобы все было в порядке, система использует два разных списка, или «реестра», чтобы отделить, *что* делает способность, от того, *как* она работает.

- **Реестр Инструментов**: Это как меню в ресторане. В нем перечислены все способности (`Инструменты`) по названию и описано, что они делают (например, «Проверить погоду»).
- **Реестр Действий**: Это как секретная книга рецептов на кухне. В ней содержатся реальные пошаговые инструкции (`Действия`) о том, как готовить каждое блюдо из меню.

Такое разделение очень полезно. Это значит, что ИИ может просто думать о том, что есть в меню, не зная рецепта. А еще это значит, что мы можем изменить рецепт (например, сделать его быстрее или использовать другой ингредиент), не перепечатывая все меню.

## Добавление рецепта в книгу

`Действие` регистрируется с именем, которое связывает его с `Инструментом`.

```typescript
// Вот так мы добавляем рецепт (Действие) в нашу книгу.
// Имя 'weatherCheck' должно совпадать с Инструментом в меню.
Activity.register('weatherCheck', async call => {
  const data = await weatherAPI.get(call.location);
  return { temperature: data.temp, conditions: data.desc };
});
```

## Два способа получить ответ: вообразить или сделать

Когда системе нужно использовать `Инструмент`, она может получить ответ двумя разными способами:

- **Вообразить результат (скрытое исполнение)**: Это когда ИИ просто использует свой супер-умный мозг, чтобы придумать ответ. Если ты задашь ему вопрос из викторины, ему не нужно искать ответ — он его просто «знает». Это способ по умолчанию, если нет специального кода для выполнения.
> Sidenote: Подробнее о том, что такое «Скрытое», можно прочитать здесь: [104: Концепция/Скрытое](./104_concept_latent.md)
- **Сделать что-то по-настоящему (явное исполнение)**: Это когда система запускает реальный код, чтобы получить ответ. Это необходимо для вещей, которые ИИ не может просто вообразить, например, чтобы проверить погоду прямо сейчас, найти что-то в базе данных или использовать сервис другого сайта.

## Как система решает, что делать

Система умная и ей не нужно каждый раз говорить, что делать. Она следует простому набору правил, чтобы решить, вообразить ответ или запустить реальный код.

1.  **Особые указания**: Если у `Инструмента` есть специальная пометка, которая гласит: «Используй этот конкретный рецепт», система всегда будет следовать этой инструкции.
2.  **Совпадение имен (простой способ)**: Если `Инструмент` называется «weatherCheck», система автоматически заглянет в книгу рецептов в поисках `Действия`, которое тоже называется «weatherCheck». Если найдет, то использует его. Это самый простой и распространенный способ связать `Инструмент` с его кодом.
3.  **Возврат к воображению по умолчанию**: Если система не может найти подходящий рецепт по вышеуказанным правилам, она по умолчанию пытается вообразить ответ. Это безопасный вариант, чтобы ничего не сломалось.

Это упрощает создание вещей:

- Чтобы заставить `Инструмент` работать с реальным кодом, просто дай коду **то же имя**, что и у `Инструмента`.
- Если ты создашь `Инструмент` без какого-либо кода, он безопасно переключится на режим, где ИИ справляется сам.
- Если ты хочешь, чтобы один и тот же код работал для нескольких разных `Инструментов`, можно использовать Правило №1, чтобы указать им всем на один и тот же рецепт.

## Почему это разделение так важно

Если бы мы не разделяли меню (`Инструмент`) и рецепты (`Действие`), они были бы навсегда склеены. Представь, что для изменения рецепта тебе пришлось бы рассказать об этом каждому клиенту, который когда-либо заказывал это блюдо. Это было бы невозможно!

Разделяя их, мы получаем потрясающую гибкость:

- **Рецепты могут меняться, никого не сбивая с толку**: Ты можешь обновить код, который проверяет погоду, переключив его с одного сервиса на другой, а агент ИИ, использующий `Инструмент` «weatherCheck», даже не заметит. Он просто продолжит работать.
- **Можно тестировать разные подходы**: Ты можешь заставить ИИ вообразить ответ, а также запустить реальный код, чтобы получить ответ, а затем сравнить их и посмотреть, что работает лучше.
- **Безопасно внедрять изменения**: Ты можешь дать новый, экспериментальный рецепт всего нескольким агентам для тестирования, в то время как все остальные будут продолжать использовать старый, надежный.

## От знания к действию

Итак, мы разобрались, *какие* способности есть у агента (`Инструмент`) и *как* эти способности выполняют задачи (`Действие`). Но это только начало. Следующий шаг — понять, как система управляет всеми этими задачами: как она принимает заказ, отправляет его на кухню и следит, чтобы все происходило в правильной последовательности.

Следующий документ, [004: Агент/Вызов](./004_agent_call.md), объясняет, как эти идеи воплощаются в жизнь.