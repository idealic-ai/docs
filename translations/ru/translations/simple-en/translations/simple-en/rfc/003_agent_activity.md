# 003: Агент/Действие

> **Действие:** Думайте о `Activity` как о реальной работе, которая происходит «за кулисами» `Tool`. Если `Tool` — это кнопка с надписью «Проверить погоду», то `Activity` — это программный код, который обращается к сайту погоды за прогнозом. Это нужно для задач, которые ИИ не может просто знать наизусть, например, для проверки базы данных в реальном времени или для связи с другим сайтом. — [Глоссарий](./000_glossary.md)

>Sidenote: Этот документ основан на материале из [002: Агент/Инструмент](./002_agent_tool.md).

Этот документ объясняет, откуда `Tools` берут свою силу. `Tool` говорит, *что* может делать ИИ, а **`Activity`** — это реальный код, который объясняет, *как* он это делает.

## Две книги рецептов

Чтобы всё было в порядке, система использует два отдельных списка, как меню и книга рецептов в ресторане.

- **Реестр Инструментов**: Это меню, которое вы даёте клиентам. В нём перечислены все способности (`Tools`) и описано, что они делают (например, «Получить погоду на сегодня»).
- **Реестр Действий**: Это секретная книга рецептов на кухне. В ней содержатся настоящие пошаговые инструкции (`Activities`), как приготовить каждое блюдо из меню.

Такое разделение очень помогает. Это означает, что ИИ может просто посмотреть на меню опций, не вдаваясь в детали каждого рецепта. Это также значит, что мы можем улучшить рецепт на кухне (например, использовать новый погодный сервис), не меняя меню, которое видят все.

## Добавление рецепта в книгу

`Activity` сохраняется с именем, которое связывает его с `Tool` в меню.

```typescript
// Так мы добавляем рецепт (Activity) в кухонную книгу.
// Имя 'weatherCheck' должно совпадать с Tool в меню.
Activity.register('weatherCheck', async call => {
  const data = await weatherAPI.get(call.location);
  return { temperature: data.temp, conditions: data.desc };
});
```

## Два способа получить ответ: Воображение и Реальное выполнение

Когда ИИ нужно использовать `Tool`, он может получить результат двумя разными способами:

- **Воображаемый ответ (Скрытое исполнение)**: Это происходит, когда ИИ настолько умён, что уже знает ответ. Если вы спросите его: «Кто был первым президентом?», ему не нужно будет искать информацию — он просто знает это благодаря своему обучению. Этот способ используется по умолчанию, если нет реального рецепта для выполнения задачи.
  >Sidenote: Хотите узнать больше о том, что на самом деле означает «воображение» для ИИ? Читайте здесь: [104: Концепция / Скрытое](./104_concept_latent.md)
- **Выполнение реальной работы (Явное исполнение)**: Это происходит, когда системе нужно запустить реальный код, чтобы найти ответ. Это как спросить счёт в баскетбольном матче, идущем в прямом эфире, — нужно проверить источник. Этот способ используется для вещей, которые ИИ не может просто угадать, например, для проверки сегодняшней погоды, поиска заказа клиента или использования сервиса другого сайта.

## Как система решает, что делать

Система достаточно умна, чтобы самостоятельно определять, какой метод использовать. Она следует этим простым правилам:

1.  **Проверка специальных инструкций**: Если у `Tool` есть специальная пометка, гласящая: «Всегда использовать этот конкретный рецепт», система выполняет это в первую очередь.
2.  **Поиск по совпадающему имени**: Если специальных пометок нет, система ищет рецепт с тем же именем, что и у `Tool`. Если `Tool` называется «weatherCheck», она ищет рецепт под названием «weatherCheck». Если находит — использует его. Это самый распространённый способ.
3.  **Просто вообразить**: Если после первых двух шагов система так и не нашла рецепт, она прибегает к воображаемому ответу. Это безопасный запасной план, чтобы ничего не сломалось.

Это очень упрощает разработку:

- Чтобы `Tool` выполнял реальную работу, просто дайте его коду **такое же имя**.
- Если вы создадите `Tool` без кода, ИИ безопасно обработает его с помощью воображения.
- Если вы хотите, чтобы несколько разных `Tools` использовали один и тот же рецепт, вы можете использовать Правило №1, чтобы указать им на него.

## Почему это разделение так важно

Если бы мы смешали меню (`Tool`) и рецепты (`Activity`), получился бы беспорядок. Представьте, что вы изменили рецепт на кухне, и вам пришлось бы разыскать каждого клиента, когда-либо заказывавшего это блюдо, чтобы сообщить ему об этом. Невозможно!

Разделяя их, мы получаем потрясающие суперспособности:

- **Рецепты можно менять в любое время**: Вы можете обновить код, который проверяет погоду, и ИИ, использующий `Tool` «weatherCheck», даже не заметит разницы. Он просто продолжит работать.
- **Можно тестировать новые идеи**: Вы можете заставить ИИ вообразить ответ и одновременно запустить реальный код, а затем сравнить два результата, чтобы увидеть, какой из них лучше.
- **Безопасное внедрение изменений**: Вы можете протестировать новый, экспериментальный рецепт, предоставив его лишь нескольким ИИ, в то время как все остальные будут продолжать использовать старый, проверенный рецепт.

## От знания к действию

Итак, мы выяснили, *какие* способности есть у ИИ (`Tool`) и *как* он выполняет задачи (`Activity`). Но это только подготовка сцены. Следующий шаг — понять, как система на самом деле управляет этими задачами, например, как принимает заказ и отправляет его на кухню в правильном порядке.

Следующий документ, [004: Агент/Вызов](./004_agent_call.md), объясняет, как эти идеи применяются на практике.