# 004: Агент/Вызов

> **Вызов:** Представьте, что **Инструмент** — это кнопка на пульте, например, «Переключить канал». **Вызов** — это когда вы нажимаете эту кнопку и вводите конкретный номер канала, например, «5». Это реальная команда, чтобы *сделать что-то прямо сейчас*.
>
> — [Глоссарий](./000_glossary.md)

> Sidenote:
>
> - Требует:
>   - [103: Концепция/Идеатор](./103_concept_ideator.md)
> - Позволяет:
>   - [008: Агент/Импорты](./008_agent_imports.md)
>   - [011: Агент/Инстансинг](./011_agent_instancing.md)
>   - [202: Идея/Контейнер](./202_idea_vessel.md)
>   - [203: Идея/Процесс](./203_idea_process.md)

**[Идея](./101_concept_idea.md)** — это как рецепт того, как что-то сделать. **[Инструмент](./002_agent_tool.md)** превращает этот рецепт в рабочую кнопку, которую может использовать ИИ. Это руководство посвящено **Вызову** — тому, что происходит, когда ИИ действительно нажимает на эту кнопку.

**Вызов** — это конкретная, окончательная команда для Инструмента, со всеми заполненными деталями. Если Инструмент говорит вам, *что вы можете сделать*, то Вызов — это о том, чтобы *сделать это на самом деле*.

## Путь от Идеи к Вызову

Представьте, что вы печете торт. Вот как это работает:

1.  **Идея**: это ваш рецепт. В нем есть все инструкции по выпечке торта.
2.  **Инструмент**: рецепт используется для создания кнопки «Испечь торт» на умной духовке. Теперь духовка знает, какие ингредиенты ей нужны (например, мука, сахар и яйца) и какие действия она может предпринять.
3.  **Вызов**: это вы говорите духовке: «Испеки торт, используя шоколад *этой марки*, в течение *30 минут* при *180 градусах*». Вы заполнили все пробелы и дали конкретную команду. Эта одна-единственная команда и есть Вызов.

Главное правило простое: **любую Идею можно превратить в Инструмент, а любой Инструмент можно использовать в Вызове.**

Чтобы узнать больше о том, как «список покупок» Идеи становится настройками для Инструмента, ознакомьтесь с **[007: Агент/Ввод](./007_agent_input.md)**.

## Ручки управления: Область и Метод

Когда вы делаете Вызов, вы можете изменить его работу с помощью двух «ручек управления»: **Область** (где он выполняется) и **Метод** (как он выполняется). Система понимает, как вы настроили эти параметры, по специальным инструкциям в настройках Инструмента (`_module`, `_activity`, `_output`).

### Два основных элемента управления

1.  **Область (Где выполняется? Здесь или у специалиста?)**
    Область определяет, выполняет ли ИИ задачу сам или передает ее кому-то другому.
    - **Здесь (Встроенная область)**: Это стандартный вариант. ИИ выполняет задачу самостоятельно. Это как если бы шеф-повар нарезал овощи на своем рабочем месте.
    - **Специалист (Модульная область)**: Используется, когда вы видите инструкцию `_module`. Это как если бы шеф-повар отдал приказ пекарю в другой части кухни. Задача передается эксперту.

2.  **Метод (Как выполняется? По рецепту или творчески?)**
    Метод определяет, следует ли задача точным шагам или использует свой «мозг» для поиска решения.
    - **Рецепт (Явный метод)**: Используется, когда вы видите инструкцию `_activity`. Задача выполняется по очень конкретным шагам, как робот, следующий своей программе. Никаких догадок.
    - **Творчество (Скрытый метод)**: Это стандартный вариант. ИИ просят найти лучший способ что-то сделать. Часто для этого требуется инструкция `_output`, что похоже на просьбу к шеф-повару: «Мне неважно, как вы это сделаете, просто приготовьте вкусный суп».

Вы можете смешивать и сочетать эти элементы управления, чтобы выполнять работу самыми разными способами. Чтобы увидеть, как это делается, ознакомьтесь с **[008: Агент/Импорты](./008_agent_imports.md)**.

## Создание более крупных систем с помощью Вызовов

`Call` — это как один кубик Lego. Сам по себе это простая команда. Но вы можете соединить много Вызовов вместе, чтобы строить гораздо более крупные и сложные вещи, например, целый **[Контейнер](./202_idea_vessel.md)** или **[Процесс](./203_idea_process.md)**.

`Vessel` — это как полный набор Lego в коробке. В нем есть все необходимое для одного большого проекта: инструкция по сборке (`context`), список всех кубиков, которые можно использовать (`schema` из `Tools`), и конечный результат, который ИИ решает построить с их помощью (`solution`, который является просто списком `Calls` для выполнения).

> Sidenote:
>
> - [202: Идея/Контейнер](./202_idea_vessel.md)
> - [203: Идея/Процесс](./203_idea_process.md)

## Различные способы выполнения Вызовов

Когда ИИ решает сделать несколько Вызовов одновременно, вы можете выбрать, как их выполнить.

```typescript
// Выполнить только один Вызов
const result = await Tool(call);

// Выполнить все. Не продолжать, пока каждый из них не будет завершен.
const results = await Tool.all(calls);

// Попробовать все. Вернуть результат первого, который сработает.
const result = await Tool.any(calls);

// Это гонка! Запустить все и вернуть результат самого первого, который завершится, независимо от успеха или неудачи.
const result = await Tool.race(calls);
```

Эти различные способы позволяют вам:

- **Двигаться шаг за шагом**: Обрабатывать каждый Вызов по одному, решая, что делать в промежутках.
- **Выполнять пачкой**: Запускать много отдельных Вызовов одновременно для ускорения работы.
- **Найти первый ответ**: Остановиться, как только найдется один работающий Вызов (`.any()`) или как только завершится самый первый (`.race()`).
- **Добиться успеха командой**: Убедиться, что вся группа Вызовов успешно завершена, что важно, когда они все зависят друг от друга (`.all()`).