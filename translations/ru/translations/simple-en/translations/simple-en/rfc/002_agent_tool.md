# 002: Агент/Инструмент

> **Инструмент**: Представьте Инструмент как рецепт или черновик для особой способности, которую может использовать ИИ. Он говорит ИИ: "Вот специальный навык, который ты можешь использовать, а вот необходимые для него ингредиенты". Затем ИИ может использовать эту способность, заполнив рецепт нужной информацией. Это называется `Call`. Затем `Call` выполняется либо собственным "мозгом" ИИ, либо реальной компьютерной программой.

> Sidenote: Сначала прочтите: [001: Агент/Запрос](./001_agent_request.md). Хорошо сочетается с: [003: Агент/Действие](./003_agent_activity.md).

Этот документ объясняет, что такое Инструмент — базовый строительный блок, который позволяет ИИ (называемому Агентом) понимать и использовать свои способности.

## Что такое Инструменты?

**Инструменты — это самая важная часть** того, как ИИ выполняет действия. Они дают ИИ очень важный навык: **выбирать правильное действие в нужный момент**. Это позволяет ИИ анализировать проблему и находить лучший способ её решения.

Инструменты дают ИИ:

- **Чёткие инструкции**: Они подобны черновикам, которые ИИ может легко прочитать, чтобы понять свои способности.
- **Никаких сюрпризов**: Они устанавливают чёткие правила для входящей и исходящей информации, поэтому вы всегда знаете, чего ожидать.
- **Кубики LEGO**: Вы можете соединять разные Инструменты вместе, чтобы помочь ИИ выполнять более крупные и сложные задачи.
- **Понятны для ИИ**: Черновики написаны особым образом, чтобы "мозг" ИИ (его языковая модель) мог их понимать и выбирать из них.

Когда ИИ выбирает черновик Инструмента и заполняет все детали, он создаёт **Call**. Call — это как заполненная форма заказа, готовая к отправке для выполнения работы. (Подробнее о том, как работает Call, можно узнать в [004: Агент/Вызов](./004_agent_call.md)).

> **Примечание**: Вы можете просить ИИ выполнять простые вещи, просто говоря ему, что вы хотите. Но если вам нужно, чтобы ИИ сам выбирал между различными действиями, вам понадобятся Инструменты. Чтобы увидеть, как простой запрос можно превратить в полноценный Инструмент, ознакомьтесь с [007: Агент/Ввод](./007_agent_input.md).

## Когда следует использовать Инструменты?

Используйте Инструменты, когда хотите, чтобы ИИ:

- **Принимал решения в моменте**, основываясь на происходящем.
- **Выбирал из множества различных способностей** для выполнения большой задачи.
- **Использовал разные версии одной и той же способности** (например, выбирал между Google и другим поисковиком).
- **Сочетал свой интеллект с чёткими инструкциями** для принятия наилучших решений.

## Как работает система Инструментов

### Главная идея: Черновик — это просто план

Вся система построена на одной простой идее: **Инструменты — это просто черновики**. Они описывают, *что* делает способность, но не *как* она это делает. Фактическая работа выполняется либо собственным воображением ИИ, либо отдельной программой, называемой **[Действием](./003_agent_activity.md)**.

Черновик Инструмента сообщает вам:

- **Что он делает** (краткое и простое описание).
- **Что ему нужно** (ингредиенты, или входные данные).
>Sidenote: О дополнительных настройках:
>
> - `_instance`: Об этой специальной настройке можно узнать в [011: Агент/Инстансинг](./011_agent_instancing.md).
> - `_module`: Чтобы узнать, что это делает, загляните в [009: Агент/Модуль](./009_agent_module.md).
- **Что вы получаете** (конечный результат, называемый `_output`).
- **Как он называется** (его имя, `_tool`).
- **Как это делается** (часть `_activity`, о которой можно прочитать в [003: Агент/Действие](./003_agent_activity.md)).

### Специальные метки в Черновике

В черновиках Инструментов используются специальные метки, которые начинаются с нижнего подчёркивания (`_`), чтобы давать инструкции системе:

- **\_tool**: Уникальное имя этого инструмента (обязательно).
- **\_activity**: Указывает на реальную программу (`Activity`), которая может выполнить работу. Как это работает, можно узнать в [003: Агент/Действие](./003_agent_activity.md).
- **\_output**: Описывает, как должен выглядеть результат.
- **\_reasoningForCall**: Заметка, в которой ИИ объясняет, *почему* он решил использовать именно этот инструмент.

Любое другое поле без нижнего подчёркивания — это обычный ингредиент, необходимый инструменту. Специальные метки с `_` всегда идут первыми, чтобы ИИ мог быстро увидеть важные инструкции.

### О чём заботится система

Система Инструментов берёт на себя всю фоновую работу:

- **Ведение списка всех черновиков** (регистрация инструментов).
- **Помощь ИИ в заполнении пробелов** в черновике, используя уже имеющуюся у него информацию.
- **Решение, кто выполняет работу** (собственный "мозг" ИИ или отдельная программа).

Другие части системы занимаются такими вещами, как управление большими проектами и установка правил, как и когда что-либо должно быть сделано.

## Определение Инструмента

Инструменты описываются с помощью формата под названием JSON Schema — это просто структурированный способ создания черновика. Вот пример Инструмента, который может определить, является ли предложение весёлым, грустным или нейтральным. Этому инструменту не нужна отдельная программа, потому что ИИ может просто использовать собственное понимание слов, чтобы найти ответ.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует тональность текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Набор Инструментов и Call

Один инструмент — это здорово, но настоящая магия начинается, когда вы даёте ИИ целый **Набор Инструментов**. Система одновременно показывает ИИ все доступные черновики Инструментов. Это позволяет ИИ просмотреть все варианты и выбрать идеальный для конкретной задачи.

Когда ИИ выбирает Инструмент и заполняет необходимую информацию, он создаёт **Call**. Call — это окончательная, готовая к выполнению команда, которая отправляется на исполнение.

> Sidenote: Когда ИИ использует Инструмент, он создаёт **Call** — фактическую команду для выполнения действия. Узнать больше об этом можно здесь: [004: Агент/Вызов](./004_agent_call.md).

## Два способа выполнения задач

Сам по себе черновик Инструмента — это просто план. Есть два способа заставить его что-то *сделать*. Первый способ мы называем **скрытым исполнением (latent execution)** — это заумное название для процесса, когда **ИИ просто сам придумывает ответ**. Это идеально подходит для задач, связанных с языком или идеями, например, для определения настроения предложения.

Но для действий, требующих связи с реальным миром — например, поиска в интернете или проверки календаря — Инструмент должен быть связан с реальной компьютерной программой. Мы называем такую программу **Действием**.

Разделение черновика Инструмента и Действия, которое выполняет работу, — это очень важная идея. Это означает, что ИИ может думать о своих способностях, не беспокоясь о сложных деталях их работы. Это также означает, что мы можем изменить программу, которую использует инструмент, не меняя сам черновик. Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, объясняет, как Действия воплощают Инструменты в жизнь.