# Акт 003: Агент/Действие

> **Действие:** Думайте об этом как о *реальном коде*, который заставляет `Tool` (Инструмент) работать. `Tool` — это как кнопка, а `Действие` — это набор инструкций, который выполняется при ее нажатии, особенно для задач, которые ИИ не может просто «придумать», например, проверить реальный веб-сайт или сохранить файл. — [Глоссарий](./000_glossary.md)



Этот документ объясняет **Протокол Действий** — свод правил о том, как `Tools` получают свою функциональность от реального, работающего кода. В то время как `Tool` описывает, *что* вы можете сделать, `Действие` — это код, который *фактически это делает*.

## Архитектура двух списков

Система ИИ использует два разных списка для организации работы. Это разделяет описание навыка и код, который этот навык выполняет.

- **Список Инструментов (Реестр)**: Это как меню в ресторане. В нем перечислены все действия, которые может выполнить ИИ (например, «Проверить погоду»).
- **Список Действий (Реестр)**: Это как книга рецептов на кухне. Она содержит реальный код (`Действия`), который пошагово объясняет, как приготовить каждый пункт из меню.

Разделение этих списков очень важно. Это означает, что в меню может быть `Tool`, для которого ИИ просто «придумывает» ответ. Также это позволяет заменить рецепт на кухне (например, начать использовать другой сайт погоды), не меняя при этом само меню.

## Регистрация Действия

Вы сообщаете системе о своем коде, «регистрируя» его под специальным именем. Это имя связывает код с соответствующим `Tool` в меню.

```typescript
// Так вы регистрируете код для Действия.
// Имя 'weatherCheck' должно совпадать с именем соответствующего Инструмента.
Activity.register('weatherCheck', async call => {
  const data = await weatherAPI.get(call.location);
  return { temperature: data.temp, conditions: data.desc };
});
```

## Два способа работы: Воображение и Выполнение

Когда системе нужно использовать `Tool`, у нее есть два способа выполнить задачу:

- **Воображение (Скрытое исполнение)**: ИИ использует свой огромный мозг, чтобы обдумать проблему и самостоятельно найти ответ. Этот способ используется по умолчанию, если к `Tool` не подключен реальный код. Это похоже на то, как если бы вы попросили умного друга угадать погоду, основываясь на времени года.

- **Выполнение (Явное исполнение)**: ИИ запускает реальный, пошаговый код. Этот код `Действия` выполняет работу и возвращает результат. Это необходимо для задач, которые требуют взаимодействия с внешним миром (например, проверка погоды на реальном сайте) или должны быть абсолютно точными каждый раз.

## Как система выбирает способ

У системы есть простое автоматическое правило, по которому она решает, придумать ответ или запустить реальный код. Она ищет специальную пометку `_activity` в описании `Tool`.

1.  **Прямые указания**: Если в описании `Tool` указано конкретное имя `_activity`, система использует это имя для поиска нужного кода в Списке Действий.
2.  **Совпадение имен (Простой способ)**: Если прямых указаний нет, система ищет `Действие` с **точно таким же именем**, как у `Tool`. Если находит, то связывает их автоматически. Это как если бы у вас был ключ с надписью