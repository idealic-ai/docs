# 002: Агент/Инструмент

> **Инструмент**: Инструмент — это как черновик для особой способности, которую может использовать ИИ-агент. ИИ показывают этот черновик, чтобы он понял, что может делать. Чтобы использовать способность, ИИ создает `Call`, заполнив все детали. Этот вызов затем выполняется либо собственным «мозгом» ИИ, либо специальным фрагментом кода под названием `Activity` (Действие). — [Глоссарий](./000_glossary.md)

> Sidenote: Сначала прочтите: [001: Агент/Запрос](./001_agent_request.md). Связанный документ: [003: Агент/Действие](./003_agent_activity.md).

Этот документ объясняет Инструменты. Думайте о них как об официальных карточках с инструкциями, которые позволяют ИИ понимать и использовать различные способности.

## Что такое Инструменты?

**Инструменты — это основные строительные блоки** для обучения ИИ тому, как действовать. Они позволяют ИИ делать нечто новое: **выбирать правильное действие для правильной ситуации**. Это как дать супергерою пояс с гаджетами — он может посмотреть на проблему и выбрать лучший инструмент для ее решения.

Инструменты дают нам:

- **Четкие Инструкции**: Черновики (называемые схемами), которые легко читать и понимать ИИ.
- **Правила для Соблюдения**: Они гарантируют, что входящая и исходящая информация всегда имеет правильный формат, словно ключ, который подходит к нужному замку.
- **Кубики LEGO**: Вы можете комбинировать простые инструменты для создания более сложных поведений ИИ.
- **Удобный для ИИ Дизайн**: Черновики созданы так, чтобы большая языковая модель (LLM) могла размышлять над ними и выбирать лучший для конкретной задачи.

Когда ИИ решает использовать Инструмент и заполняет всю необходимую информацию (как при заполнении формы), он создает **Вызов** (`Call`). Вызов — это как заполненный бланк заказа, готовый к отправке для выполнения задачи (подробнее об этом можно узнать в [004: Агент/Вызов](./004_agent_call.md)).

> **Примечание**: Вы можете попросить ИИ сделать простые вещи, дав ему Идею, но Инструменты нужны, когда ИИ должен делать выбор и выполнять действия. Чтобы увидеть, как простые Идеи можно превратить в мощные Инструменты, ознакомьтесь с [007: Агент/Ввод](./007_agent_input.md).

## Когда следует использовать Инструменты?

Используйте систему Инструментов, когда вы хотите, чтобы ваш ИИ:

- **Выбирал действия на лету** в зависимости от происходящего.
- **Выбирал из множества различных способностей** для достижения цели.
- **Использовал разные версии одной и той же способности** (например, выбирал между Поиском Google и Поиском Bing).
- **Совмещал собственное мышление с конкретными, заранее написанными инструкциями** для принятия решений.

## Как устроена система Инструментов

### Основная идея: Черновик — это всего лишь руководство

Самое важное, что нужно помнить, это то, что **Инструменты — это всего лишь черновики**. Они описывают, *что* делает способность, но не говорят, *как* это делается. Фактическая работа выполняется либо собственным интеллектом ИИ, либо отдельным фрагментом кода, который называется **[003: Агент/Действие](./003_agent_activity.md)**.

Черновик Инструмента объясняет:

- **Что делает инструмент** (описание).
- **Что ему нужно для работы** (входные данные, как ингредиенты для рецепта).
> Sidenote: Дополнительные возможности: `_instance` (см. [011: Агент/Инстансинг](./011_agent_instancing.md)) и `_module` (см. [009: Агент/Модуль](./009_agent_module.md)).
- **Что он создает** (`_output`, или готовое блюдо).
- **Как он называется** (его имя `_tool`).
- **Как его запустить** (поле `_activity`, которое указывает на конкретный фрагмент кода, что объясняется в [003: Агент/Действие](./003_agent_activity.md)).

### Специальные поля Черновика

Черновики Инструментов имеют специальные поля, которые начинаются с нижнего подчеркивания `_`. Это как заметки для самой системы:

- **`_tool`**: Уникальное имя инструмента (обязательно).
- **`_activity`**: Сообщает системе, следует ли использовать конкретное `Activity` (фрагмент кода) для запуска инструмента. Вы можете прочитать, как это работает, в [003: Агент/Действие](./003_agent_activity.md).
- **`_output`**: Описывает, как должен выглядеть результат.
- **`_reasoningForCall`**: Место, где ИИ может объяснить, *почему* он решил использовать этот инструмент.

Любое поле без нижнего подчеркивания — это обычные входные данные, необходимые инструменту. Специальные поля с `_` всегда идут первыми, что помогает ИИ легче понимать черновик.

### Чем управляет система

Система Инструментов заботится о:

- Ведении каталога всех доступных Инструментов (черновиков).
- Помощи ИИ в заполнении пробелов в черновике, используя предоставленную ему информацию.
- Принятии решения, должен ли ИИ сам найти ответ или использовать конкретное `Activity` для выполнения работы.

Системы более высокого уровня, такие как система [004: Агент/Вызов](./004_agent_call.md), используют эти основы для управления сложными проектами, запоминания информации и принятия решений о том, как выполняются действия.

## Определение Инструмента

Инструменты определяются с использованием формата под названием JSON Schema. Вот пример Инструмента, который может определить, является ли текст радостным, грустным или нейтральным (это называется анализом тональности). Этому Инструменту не нужен отдельный фрагмент кода, потому что ИИ достаточно умен, чтобы самостоятельно справляться с такими языковыми задачами.

```typescript
Tool.register('sentimentAnalysis', {
  type: 'object',
  description: 'Анализирует тональность текста',
  properties: {
    _tool: { type: 'string', const: 'sentimentAnalysis' },
    text: { type: 'string', description: 'Текст для анализа' },
    _output: {
      type: 'object',
      properties: {
        sentiment: { type: 'string' },
        confidence: { type: 'number' },
      },
    },
  },
});
```

## Набор инструментов и Вызов

Хотя один Инструмент полезен, настоящая магия происходит, когда вы даете ИИ целый набор инструментов. Система показывает ИИ все доступные черновики Инструментов одновременно. Это позволяет ИИ просмотреть все варианты и выбрать лучший для текущей задачи.

Когда ИИ выбирает Инструмент и заполняет необходимую информацию, он создает **Вызов** (`Call`). Вызов — это полностью подготовленное, готовое к выполнению действие, которое передается на исполнение.

> Sidenote: [004: Агент/Вызов](./004_agent_call.md).

## Два способа выполнения: Скрытое и Явное

Черновик Инструмента — это просто интерфейс, описание. Сама работа может быть выполнена двумя способами.

1.  **Скрытое исполнение (Используя свой «мозг»)**: Это способ по умолчанию. ИИ использует свои встроенные знания и логику, чтобы найти ответ. Это идеально подходит для задач, связанных с языком, творчеством или общими знаниями.

2.  **Явное исполнение (Используя вспомогательную функцию)**: Для действий, требующих взаимодействия с внешним миром — например, узнать погоду, отправить электронное письмо или проверить базу данных — Инструмент должен быть связан с реальным фрагментом кода. Этот фрагмент кода называется **Действие** (`Activity`).

Разделение между Инструментом (что делать) и Действием (как делать) чрезвычайно важно. Это означает, что вы можете описывать способности ИИ простым способом, а позже заменять код, который выполняет работу, не меняя самого описания.

Следующий документ, **[003: Агент/Действие](./003_agent_activity.md)**, объясняет, как `Activities` (Действия) обеспечивают реальную мощь, стоящую за `Tools` (Инструментами).

> Sidenote: [003: Агент/Действие](./003_agent_activity.md).