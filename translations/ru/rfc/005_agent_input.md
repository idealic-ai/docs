# 005: Агент/Ввод

> Sidenote:
>
> - Требует: [Протокол Идей](./101_concept_idea.md)
> - Включает: [Протокол: Идеаторы](./103_concept_ideator.md)

> **Сообщение Ввода (Input Message):** Контекстное сообщение, содержащее `schema` и данные `input`. Его наличие превращает `Idea` в `Ideator`, определяя ожидаемые входные данные.
>
> — [Глоссарий](./000_glossary.md)

Этот документ описывает **Протокол Ввода (Input Protocol)** — систему для определения структурированных входных данных для `Ideas`. Этот протокол вводит особый тип сообщения, который, будучи включенным в контекст `Idea`, превращает ее из статического фрагмента знаний в исполняемую, похожую на функцию сущность, известную как **Ideator**.

## Тип сообщения `Input`

Сообщение `Input` — это особый тип контекстного сообщения, предназначенный для формального объявления данных, которые принимает `Idea`. Это механизм, который фиксирует структурированные входные данные, использованные для получения определенного `solution`, завершая «Триаду Идеи» и предоставляя полную, воспроизводимую запись творческого или вычислительного процесса.

Сообщение `Input` содержит два ключевых свойства:

1.  **`schema`**: Объект JSON Schema, который определяет структуру, типы и ограничения данных, ожидаемых `Idea`.
2.  **`input`**: Конкретный объект данных, который соответствует `schema` и представляет фактические значения, использованные для конкретного выполнения.

Определяя свои входные данные таким структурированным образом, любая `Idea` может стать самоописываемой не только в части своего вывода (`solution` и `schema`), но и в том, что ей требуется для генерации.

### Путь к простоте использования

Значительное преимущество этого протокола — возможность автоматической генерации пользовательского интерфейса. Поскольку `schema` для `input` явно определяет требуемые данные, система может динамически создавать форму с правильными полями, метками и проверкой. Это позволяет мгновенно предоставить любую `Idea` пользователю-человеку через функциональный интерфейс, что значительно снижает барьер для взаимодействия.

## От Idea к Ideator

Как описано в [Протоколе Идей](./101_concept_idea.md), наличие сообщения `Input` в контексте `Idea` является окончательным сигналом того, что это **Ideator** — `Idea`, которая выполняет работу. Она становится воспроизводимой функцией.

## Взаимодействие с Протоколом Создания Экземпляров

Сообщение `Input` полностью совместимо с [Протоколом Создания Экземпляров (Instancing Protocol)](./008_agent_instancing.md), что позволяет использовать сложные стратегии получения данных при одновременной обработке нескольких экземпляров. Оно может работать в двух различных режимах:

1.  **Глобальный Ввод (Global Input)**: Если сообщение `Input` предоставлено в контексте агента без свойства `_instance`, его данные `input` рассматриваются как глобальное значение. Оно неявно доступно каждому экземпляру, обрабатываемому в запросе. Это полезно для предоставления общей конфигурации, подсказок или параметров, которые одинаково применяются ко всем экземплярам.

2.  **Ввод для Конкретного Экземпляра (Instance-Specific Input)**: Если сообщение `Input` включает идентификатор `_instance`, его данные `input` берутся непосредственно из состояния этого конкретного экземпляра. Это дает мощный механизм для переопределения данных для каждого экземпляра или для передачи уникальных данных каждого экземпляра в общий `Ideator`.

Эта возможность работы в двух режимах позволяет создавать гибкие и эффективные рабочие процессы с несколькими экземплярами, где один `Ideator` может быть настроен с базовым набором глобальных входных данных, а затем дополнен конкретными данными из каждого обрабатываемого экземпляра.

## Инверсия: от Ideator к Tool

Хотя `Ideator` — это самодостаточная, исполняемая концепция, для ее интеграции в императивный рабочий процесс агента мы должны преобразовать ее в **Инструмент (Tool)**. Механический процесс превращения `Ideator`, ориентированного на вывод, в `Tool`, ориентированный на интерфейс, называется **инверсией**. Мы изменяем структуру его компонентов, чтобы отдать приоритет его входным данным.

`Idea` — это триада, определяемая ее выводом `schema` и `solution`:
`{ context, schema, solution }`

Чтобы преобразовать ее в `Tool`, мы ищем сообщение `Input` внутри ее `context`. Основной шаг инверсии — это **«поднять»** свойства схемы `input` на верхний уровень, чтобы они стали свойствами-параметрами для `Tool` (подробнее о структуре схемы `Tool` см. в [Системе Инструментов (Tool System)](./002_agent_tool.md)).

Это создает определение `Tool`, которое, по сути, является сигнатурой функции, готовой к регистрации в системе агента и использованию в `Call`.