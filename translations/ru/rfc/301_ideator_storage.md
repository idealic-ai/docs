# 301: Ideator/Хранилище

## 1. Введение

Этот документ описывает **System: Storage**, основной служебный сервис в экосистеме Idea. Сервис Storage функционирует как специализированный **Idea Transformer**, главная цель которого — предоставлять постоянное, адресуемое по содержимому хранилище для `Ideas`. Это фундаментальный уровень для памяти и извлечения данных, позволяющий сохранять и версионировать `Ideas` для последующего использования другими сервисами, такими как [System: Resolver](./202_ideator_resolver.md).

## 2. Основная концепция: Хранилище как Idea Transformer

Сервис Storage следует паттерну `Idea Transformer`, принимая `Idea` на входе и возвращая `Idea` на выходе.

- **Вход**: Корректный триплет `Idea` (`schema`, `solution`, `context`).
- **Процесс**: Сервис получает `Idea`, присваивает ему уникальный, адресуемый идентификатор (который включает версионирование) и сохраняет его в надежном бэкенде (например, в базе данных PostgreSQL).
- **Выход**: Сервис возвращает исходный `Idea` в качестве подтверждения успешного сохранения. Этот вывод может быть дополнен метаданными, такими как присвоенный идентификатор и версия, подтверждающими его сохранение.

## 3. Ключевые характеристики

### 3.1. Постоянное хранение по принципу «черного ящика»

Сервис Storage спроектирован как управляемый «черный ящик». Пользователи отправляют `Ideas` для сохранения, не имея контроля над базовым механизмом хранения (например, типом базы данных, шардингом) или политиками хранения данных. Сервис гарантирует, что `Idea`, однажды принятая, будет сохранена и доступна для разрешения. Конкретные детали реализации остаются на усмотрение поставщика услуги.

### 3.2. Версионирование и неизменяемость

Система построена на принципе неизменяемости. Когда существующая `Idea` «обновляется», сервис хранения не изменяет исходную запись. Вместо этого он создает и сохраняет новую версию `Idea`, поддерживая полную и неразрывную цепочку ее истории. Это гарантирует, что любая ссылка на определенную версию `Idea` всегда будет указывать на абсолютно то же самое содержимое. Ссылки могут указывать на конкретную версию или на динамическую ветку (например, `latest`).

### 3.3. Адресация по содержимому

Хотя точная схема адресации является деталью реализации, принцип заключается в том, что каждая сохраненная `Idea` уникально идентифицируема и извлекаема по своему идентификатору и версии. Это позволяет создать надежную и децентрализованную систему, где на `Ideas` можно ссылаться с высокой точностью.

## 4. Публичный интерфейс

Публичный интерфейс системы Storage прост и ориентирован на запись, что соответствует ее узкоспециализированной роли.

- **Основное взаимодействие**: Единственное публичное взаимодействие — это отправка `Idea`.

- **Отделение от извлечения**: Для поддержания четкого разделения ответственности сервис Storage не предоставляет публичного API для общего извлечения данных или запросов. Ответственность за получение и разрешение `Ideas` явно делегирована сервису **Resolver**. Это позволяет каждому сервису сосредоточиться на одной задаче: Storage отвечает за сохранение, а Resolver — за извлечение и композицию.