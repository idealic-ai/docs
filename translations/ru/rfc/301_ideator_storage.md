# 301: Ideator/Хранилище

## 1. Введение

Этот документ описывает **Систему: Storage** — ключевой служебный сервис в экосистеме Идей. Сервис Storage работает как специализированный **Трансформатор Идей**, основная цель которого — предоставлять постоянное, контентно-адресуемое хранилище для `Идей`. Это базовый уровень для памяти и воспроизведения, который позволяет сохранять `Идеи` и управлять их версиями для последующего использования другими сервисами, например, [Системой: Resolver](./202_ideator_resolver.md).

## 2. Основная концепция: Хранилище как Трансформатор Идей

Сервис Storage следует паттерну `Трансформатор Идей`: он принимает `Идею` на входе и возвращает `Идею` на выходе.

- **Вход**: Валидный набор (триплет) `Idea`, состоящий из (`schema`, `solution`, `context`).
- **Процесс**: Сервис получает `Идею`, присваивает ей уникальный адресуемый идентификатор (который включает версионирование) и сохраняет ее в надежном бэкенде (например, в базе данных PostgreSQL).
- **Выход**: Сервис возвращает исходную `Идею` в качестве подтверждения успешного сохранения. Этот результат может быть дополнен метаданными, такими как присвоенный идентификатор и версия, подтверждающими сохранение.

## 3. Ключевые характеристики

### 3.1. Сохранение по принципу «черного ящика»

Сервис Storage спроектирован как управляемый «черный ящик». Пользователи отправляют `Идеи` на сохранение, не контролируя внутренний механизм хранения (например, тип базы данных, шардинг) или политики хранения данных. Сервис гарантирует, что принятая `Идея` будет сохранена и доступна для последующего использования. Конкретные детали реализации остаются на усмотрение поставщика сервиса.

### 3.2. Версионирование и неизменяемость

Система построена на принципе неизменяемости (иммутабельности). Когда существующая `Идея` «обновляется», сервис Storage не изменяет исходную запись. Вместо этого он создает и сохраняет новую версию `Идеи`, поддерживая полную и непрерывную цепочку ее истории. Это гарантирует, что любая ссылка на конкретную версию `Идеи` всегда будет указывать на одно и то же содержимое. Ссылки могут указывать на конкретную версию или на динамическую ветку (например, `latest`).

### 3.3. Контентная адресация

Хотя точная схема адресации является деталью реализации, основной принцип заключается в том, что каждая сохраненная `Идея` может быть однозначно идентифицирована и получена по своему идентификатору и версии. Это позволяет создать надежную и децентрализованную систему, в которой на `Идеи` можно ссылаться с высокой точностью.

## 4. Публичный интерфейс

Публичный интерфейс системы Storage прост и ориентирован на запись, что соответствует ее основной задаче.

- **Основное взаимодействие**: Единственное публичное действие — это отправка `Идеи`.

- **Отделение от получения данных**: Для четкого разделения ответственности сервис Storage не предоставляет публичного API для получения данных или выполнения запросов. Ответственность за получение и обработку `Идей` полностью возложена на сервис **Resolver**. Это позволяет каждому сервису сосредоточиться на одной задаче: Storage отвечает за сохранение, а Resolver — за получение и компоновку данных.