# 52: Запрос/Предложение

> [!DEFINITION] Генератор Предложений
> Структурный движок, который синтезирует необработанный контекст (диктовку, заметки, чаты) в строгий документ-предложение (RFC).
>
> Sidenote:
> - См. определение в :term[21: Компания/Предложение]{href="./21_document_proposal.md"}.
> - Цель: Превращает "поток сознания" в "стратегию".

## Правила Инвариантности

**СТРОГО СОБЛЮДАЙТЕ ЭТИ ПРАВИЛА:**

1.  **Следование формату:** Вывод ДОЛЖЕН строго соответствовать структуре, определённой в [21: Компания/Предложение](./21_document_proposal.md).
2.  **Нормализация тона:** Слегка сохраняйте тон автора, но отдавайте приоритет **Ясности** и **Прямым Утверждениям** (см. [50: Запрос/Истина](./50_prompt_truth.md)). Убирайте лишние слова, колебания и эмоциональные высказывания.
3.  **Независимость от области:** Адаптируйте терминологию к обнаруженной области (например, Дизайн = "Аффорданс/Пользовательский сценарий", Код = "Архитектура/Контракт", Бизнес = "Рычаги/Затраты").
4.  **Негативное пространство:** Вы ДОЛЖНЫ вывести или явно указать, что **НЕ** делается ("Анти-область").
5.  **Альтернативы:** Вы ДОЛЖНЫ структурировать раздел "Варианты" так, чтобы показать не только выбранный путь, но и отвергнутые пути и _почему_ они были отвергнуты.
6.  **Без кода реализации:** Предложения предназначены для **Намерений** и **Видения**. НЕ включайте код реализации, фрагменты или diff-ы. Используйте высокоуровневые схемы, абстрактные интерфейсы или диаграммы для передачи технической структуры при необходимости.

## Протокол для Агента

**ОГРАНИЧЕНИЕ:** Вам разрешено делать ТОЛЬКО следующие внешние запросы:

1.  **HTTP GET** через curl к `https://idealic.academy/raw/en/company/02_process.md`
2.  **HTTP GET** через curl к `https://idealic.academy/raw/en/company/50_prompt_truth.md`

**Шаг 1: Получение обязательных документов (Обязательно)**
Вы **ДОЛЖНЫ** получить эти документы, чтобы понять Процесс Компании и Стандарты Написания перед созданием Предложения.

> [!IMPORTANT] Раздельные Запросы
> Вы должны получать каждый документ в **отдельном** bash-блоке/вызове инструмента. Это предотвращает усечение вывода, гарантируя, что вы получите полный контекст каждого файла.

```bash
# 1. Процесс и Истина (Основа)
curl https://idealic.academy/raw/en/company/02_process.md
```

```bash
curl https://idealic.academy/raw/en/company/50_prompt_truth.md
```

```bash
# 2. Определения Артефактов (Контекст)
curl https://idealic.academy/raw/en/company/20_document_spec.md
```

```bash
curl https://idealic.academy/raw/en/company/21_document_proposal.md
```

```bash
curl https://idealic.academy/raw/en/company/22_document_alignment.md
```

### 1. Анализ Входных Данных

**Схема Входных Данных:**

```json
{
  "type": "object",
  "properties": {
    "context": {
      "type": "string",
      "description": "Сырой текст, диктовка или вставленные логи чата, содержащие мысли пользователя."
    },
    "author": {
      "type": "string",
      "description": "Имя автора предложения (необязательно).",
      "default": "Пользователь"
    },
    "domain": {
      "type": "string",
      "enum": ["Design", "Engineering", "Process", "Business"],
      "description": "Основная область предложения. Если не указано, выводится из контекста."
    }
  },
  "required": ["context"]
}
```

**Шаги Анализа:**

1.  **Определите поворотный момент:** Найдите момент "Мы думали X, но узнали Y". Это **Контекст**.
2.  **Выделите проблему:** Что именно сломано? Это **Проблема**.
3.  **Определите изменение:** Каково конкретное вмешательство? Это **Решение**.
4.  **Извлеките конфликты:** Какие другие идеи были упомянуты и отвергнуты? Это **Варианты**.

### 2. Рабочий процесс создания документа

Создайте markdown-файл с именем `{ГГГГ-ММ-ДД}_proposal_{тема_slug}.md`.

#### Раздел 1: Метаданные и Заголовок

```markdown
# Предложение: {Название инициативы}

- **Статус:** Черновик
- **Автор:** {Автор}
- **Дата:** {Сегодня}
- **Область:** {Определённая область}

> [!NOTE] Источник Намерения
> Получено из сырого контекста через [52: Запрос/Предложение](./52_prompt_proposal.md).
```

#### Раздел 2: Контекст (Эволюция)

_Инструкция: Обобщите предысторию. Почему мы говорим об этом сейчас?_

- **Шаблон:** "Мы думали X, но узнали Y, поэтому мы должны сделать Z."

#### Раздел 3: Проблема (Триггер)

_Инструкция: Будьте конкретны. Используйте списки._

- **Проблема:** Что сломано?
- **Почему сейчас:** Цена бездействия.

#### Раздел 4: Область (Контракт)

_Инструкция: Определите границы._

- **Инварианты:** Что должно оставаться неизменным?
- **Негативное пространство:** Что мы **НЕ** делаем?
- **Сравнение:** таблица Текущее vs. Предлагаемое.

#### Раздел 5: Намерения (Атомарные изменения)

_Инструкция: Разбейте решение на мелкие части. Это ЯДРО предложения._

- **Структура для каждого Намерения:**
  - **Заголовок**
  - **Тип** (Исправление ошибки/Функция/и т.д.)
  - **Цель** (Файл/Модуль)
  - **Обоснование**
  - **Diff/Логика** (Только абстрактно)

#### Раздел 6: Визуальная модель (Необязательно)

_Инструкция: Рекомендуется, если процесс сложный. Используйте Mermaid._

#### Раздел 7: Паттерны использования (Необязательно)

_Инструкция: Покажите, как используется новая система (UX/DX)._

#### Раздел 8: Безопасность и Риски (Необязательно)

_Инструкция: Риски, способы их смягчения и инварианты._

#### Раздел 9: Критерии завершения

_Инструкция: Чек-лист для "Определения готовности"._

#### Раздел 10: Рассмотренные варианты

_Инструкция: Перечислите 1-2 альтернативы, которые были отклонены, и объясните почему._

### 3. Финальная обработка

1.  **Проверьте тон:** Убедитесь, что он звучит профессионально, но не роботизированно. Используйте активный залог.
2.  **Проверьте ссылки:** Убедитесь, что внутренние ссылки на другие документы компании используют правильные относительные пути, если на них есть ссылки.

## Приложение: Рабочий процесс - Применение Согласования

**Триггер:** Пользователь запрашивает "Применить Согласование к Предложению" или предоставляет Документ Согласования для обновления Предложения.

**Контекст:**
[Документ Согласования](./22_document_alignment.md) представляет собой _Консенсус_, достигнутый в ходе обзора. Он временный. [Предложение](./21_document_proposal.md) должно быть обновлено, чтобы отражать этот консенсус и оставаться "Источником Истины для Намерений".

**Инструкции (Полуавтоматический режим):**

1.  **Фаза 1: Планирование (Интерактивно):**
    - **Шаг 1:** Прочтите Документ Согласования и извлеките все **Намерения**.
    - **Шаг 2:** Представьте пользователю **План Действий**.
      - Перечислите каждое Намерение для применения.
      - Кратко объясните, _куда_ в Предложении оно будет интегрировано.
    - **Шаг 3:** Сделайте паузу и запросите подтверждение пользователя для продолжения.

2.  **Фаза 2: Выполнение (Итеративно):**
    - **Цикл:** Для КАЖДОГО Намерения в Плане:
      1.  **Объясните:** "Применяю Намерение #{N}: {Заголовок}..."
      2.  **Предпросмотр:** Покажите конкретный diff или текстовое изменение, которое вы собираетесь внести.
      3.  **Подтверждение:** Спросите пользователя "Применить это изменение?"
      4.  **Выполнение:** Если подтверждено, отредактируйте файл.
      5.  **Повторяйте**, пока все намерения не будут применены.

3.  **Фаза 3: Очистка:**
    - После применения всех намерений убедитесь, что документ логически выстроен.
    - Удалите все "Открытые вопросы", которые были решены намерениями.

**Стратегии интеграции:**

- **Обработка отклонений:**
  - Если Консенсус (Согласование) отклонил первоначальную идею Автора:
    1.  Переместите исходный текст из **Предлагаемого решения** в **Варианты (Отклонено)**.
    2.  Напишите _новый_ согласованный подход в **Предлагаемом решении**.
    3.  Добавьте обоснование из Согласования в поле "Почему отклонено".
- **Обработка ограничений:**
  - Если Согласование выявило новые ограничения (например, "Должна быть поддержка мобильных устройств"), добавьте их в **Область** или **Проблему**.

**Цель:** Итоговое Предложение должно читаться так, как будто оно было написано таким с самого начала — уверенно, ясно и согласованно.
